import{Z as h}from"./@inertiajs-D0DMCEQB.js";import{u as _}from"./vue-router-BPQn2kAw.js";import{a as v}from"./axios-CCb-kr4I.js";import{_ as u}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as i,o as k,aU as s,a2 as a,a3 as e,bf as g,b2 as C,aa as w}from"./@vue-BRgAy5zV.js";import"./deepmerge-CtOfIP5S.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";const P={props:{orderCode:String,invoice_id:String,status:String},setup(n){const t=_(),d=i(!0),r=i(!1),l=i(null),c=i(null),o=i(null),y=async()=>{try{const m=n.orderCode,f=n.invoice_id;if(n.status==="CANCELLED")throw new Error("Giao dịch đã bị hủy");const p=await v.post("/api/payos/verify",{orderCode:m,invoice_id:f});if(p.data.success)r.value=!0,c.value=m,o.value=p.data.data.order_id;else throw new Error(p.data.message)}catch(m){l.value=m.message||"Có lỗi xảy ra khi xác thực thanh toán",r.value=!1}finally{d.value=!1}},b=()=>{o.value?t.push(`/orders/${o.value}`):t.push("/orders")},x=()=>{t.back()};return k(()=>{y()}),{loading:d,success:r,error:l,transactionId:c,goToOrder:b,retryPayment:x}}},S={class:"payment-callback"},T={key:0,class:"loading"},$={key:1,class:"max-w-lg mx-auto p-6"},E={key:0,class:"success bg-green-50 dark:bg-green-900/20 p-6 rounded-lg"},I={class:"text-center"},B={class:"text-gray-600 dark:text-gray-400 mb-4"},N={key:1,class:"failed bg-red-50 dark:bg-red-900/20 p-6 rounded-lg"},O={class:"text-center"},j={class:"text-gray-600 dark:text-gray-400 mb-4"};function D(n,t,d,r,l,c){return s(),a("div",S,[r.loading?(s(),a("div",T,t[2]||(t[2]=[e("div",{class:"flex items-center justify-center"},[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"}),e("span",{class:"ml-3"},"Đang xác thực thanh toán...")],-1)]))):(s(),a("div",$,[r.success?(s(),a("div",E,[e("div",I,[t[3]||(t[3]=e("i",{class:"mdi mdi-check-circle text-5xl text-green-500 mb-4"},null,-1)),t[4]||(t[4]=e("h3",{class:"text-xl font-semibold text-green-700 dark:text-green-400 mb-2"}," Thanh toán thành công! ",-1)),e("p",B," Mã giao dịch: "+g(r.transactionId),1),e("button",{onClick:t[0]||(t[0]=(...o)=>r.goToOrder&&r.goToOrder(...o)),class:"btn bg-primary-600 hover:bg-primary-700 text-white px-6 py-2 rounded-lg"}," Xem chi tiết đơn hàng ")])])):(s(),a("div",N,[e("div",O,[t[5]||(t[5]=e("i",{class:"mdi mdi-close-circle text-5xl text-red-500 mb-4"},null,-1)),t[6]||(t[6]=e("h3",{class:"text-xl font-semibold text-red-700 dark:text-red-400 mb-2"}," Thanh toán thất bại ",-1)),e("p",j,g(r.error),1),e("button",{onClick:t[1]||(t[1]=(...o)=>r.retryPayment&&r.retryPayment(...o)),class:"btn bg-primary-600 hover:bg-primary-700 text-white px-6 py-2 rounded-lg"}," Thử lại ")])]))]))])}const L=u(P,[["render",D]]),M={components:{Head:h,PaymentCallback:L},props:{orderCode:String,invoice_id:String}},V={class:"min-h-screen flex items-center justify-center bg-gray-100 dark:bg-dark-bg"},A={class:"max-w-md w-full"};function G(n,t,d,r,l,c){const o=C("PaymentCallback",!0);return s(),a("div",V,[e("div",A,[w(o)])])}const mt=u(M,[["render",G]]);export{mt as default};
