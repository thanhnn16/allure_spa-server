import{L as G}from"./LayoutAuthenticated-BULZ_zZk.js";import{_ as I}from"./SectionMain-BbIPmLtw.js";import{_}from"./CardBox-jfYP3QDG.js";import{C as P}from"./CardBoxModal-BxzLM7Dp.js";import{_ as L}from"./BaseButton-eMTGofBM.js";import{_ as X}from"./NotificationBar-B5jY2qz9.js";import{Z as q,F as b}from"./@inertiajs-D0DMCEQB.js";import{d as E,e as O,i as Z}from"./@mdi-CtI4h_1C.js";import{a as V}from"./axios-CCb-kr4I.js";import{_ as J}from"./FormField-Da_P6kO8.js";import{_ as Q}from"./FormControl-BSsARiYM.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as f,c as W,aU as u,a0 as S,bH as m,aa as r,bl as v,a3 as t,bf as s,a9 as Y,a1 as w,j as A,a2 as C,b0 as tt,F as et}from"./@vue-BRgAy5zV.js";import"./app-CzgD3Buo.js";import"./jspdf-Ciebq7We.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./@babel-BsCcpEdk.js";import"./fflate-EnPhvkmS.js";import"./laravel-echo-C9ppFO4I.js";import"./pusher-js-Cl-1XqxI.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./pinia-BhnhDyRZ.js";import"./vue-toastification-ejyjJRED.js";import"./firebase-DL3QX-oU.js";import"./@firebase--zA4YiqN.js";import"./idb-Bn1DMRyg.js";import"./deepmerge-CtOfIP5S.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./BaseIcon-B4kwkOCn.js";import"./colors-S7_1wET5.js";import"./OverlayLayer-BSs7OF78.js";import"./BaseButtons-B17KSMwc.js";import"./BaseLevel-vqqndN8O.js";import"./main-BNmBi4-k.js";const nt={class:"mb-6 bg-white rounded-lg shadow-sm p-4"},st={class:"flex justify-between items-center"},it={class:"flex items-center space-x-4"},at={class:"text-2xl font-bold text-gray-900"},ot={class:"text-gray-500"},lt={class:"flex gap-2"},rt={class:"mb-6"},dt={class:"flex items-center justify-between"},mt={class:"flex items-center space-x-4"},ct={class:"text-gray-500"},pt={key:1,class:"mb-6 p-4 bg-red-50 rounded-lg border border-red-100"},ut={class:"space-y-2"},ht={class:"grid grid-cols-2 gap-4"},gt={class:"mt-1 p-2 bg-white/50 rounded"},ft={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},vt={class:"space-y-4"},yt={class:"grid grid-cols-2 gap-4"},xt={class:"font-medium"},bt={class:"mt-1"},wt={class:"col-span-2"},Ct={class:"mt-1 space-y-1"},kt={class:"font-medium"},_t={class:"font-medium"},Lt={class:"font-medium"},Vt={class:"font-medium"},Nt={key:0,class:"mt-4"},Tt={class:"mt-1 p-3 bg-gray-50 rounded-lg text-gray-700"},$t={class:"space-y-4"},Dt={class:"grid grid-cols-2 gap-4"},jt={class:"col-span-2"},Bt={class:"font-medium"},St={class:"font-medium"},At={class:"font-medium"},Kt={class:"col-span-2"},Mt={class:"flex items-center mt-1"},Ft={class:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center mr-2"},Ht={class:"text-sm font-medium"},Ut={class:"font-medium"},zt={class:"text-sm text-gray-500"},Gt={key:0,class:"col-span-2"},It={class:"mt-1 text-gray-700"},Pt={class:"space-y-4"},Xt={class:"grid grid-cols-2 gap-3"},qt={__name:"AppointmentDetails",props:{appointment:{type:Object,required:!0}},setup(n){const h=n,d=f(null),c={pending:"warning",confirmed:"success",cancelled:"danger",completed:"info"},k={pending:"Chờ xác nhận",confirmed:"Đã xác nhận",cancelled:"Đã hủy",completed:"Hoàn thành"},K={service:"Thực hiện dịch vụ",service_package:"Thực hiện combo",consultation:"Tư vấn",others:"Khác"},M=async()=>{var i,e;if(confirm("Bạn có chắc chắn muốn xóa lịch hẹn này?"))try{(await V.delete(`/api/appointments/${h.appointment.id}`)).data.success&&b.visit("/appointments")}catch(a){d.value={type:"danger",message:((e=(i=a.response)==null?void 0:i.data)==null?void 0:e.message)||"Có lỗi xảy ra khi xóa lịch hẹn"}}},g=i=>i?new Date(i).toLocaleDateString("vi-VN",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"N/A",y=f(!1),x=f(""),N=f(!1),F=async()=>{var i,e;if(!x.value.trim()){d.value={type:"danger",message:"Vui lòng nhập lý do hủy lịch"};return}try{N.value=!0,(await V.put(`/api/appointments/${h.appointment.id}/cancel`,{note:x.value})).data.success&&(d.value={type:"success",message:"Hủy lịch hẹn thành công"},y.value=!1,setTimeout(()=>{b.reload()},1e3))}catch(a){d.value={type:"danger",message:((e=(i=a.response)==null?void 0:i.data)==null?void 0:e.message)||"Có lỗi xảy ra khi hủy lịch hẹn"}}finally{N.value=!1}},H=i=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(i||0),U=i=>i?i.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"",T=f(!1),z=async i=>{var e,a;T.value=!0;try{(await V.put(`/api/appointments/${h.appointment.id}`,{status:i})).data.success&&(d.value={type:"success",message:"Cập nhật trạng thái thành công"},setTimeout(()=>{b.reload()},1e3))}catch(l){d.value={type:"danger",message:((a=(e=l.response)==null?void 0:e.data)==null?void 0:a.message)||"Có lỗi xảy ra khi cập nhật trạng thái"}}finally{T.value=!1}};return W(()=>{const i=new Date(h.appointment.start),e=new Date(h.appointment.end);return{date:g(i),time:`${i.toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"})} - 
               ${e.toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"})}`}}),(i,e)=>(u(),S(G,null,{default:m(()=>[r(v(q),{title:"Chi tiết lịch hẹn"}),r(I,{breadcrumbs:[{label:"Lịch hẹn",href:i.route("appointments.index")},{label:"Chi tiết lịch hẹn"}]},{default:m(()=>{var a;return[t("div",nt,[t("div",st,[t("div",it,[e[3]||(e[3]=t("div",{class:"p-2 bg-blue-100 rounded-full"},[t("svg",{class:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})])],-1)),t("div",null,[t("h1",at,"Chi tiết lịch hẹn #"+s(n.appointment.id),1),t("p",ot,"Được tạo ngày "+s(g(n.appointment.created_at)),1)])]),t("div",lt,[r(L,{icon:v(E),label:"Chỉnh sửa",color:"info",onClick:e[0]||(e[0]=l=>v(b).visit(`/appointments/${n.appointment.id}/edit`))},null,8,["icon"]),r(L,{icon:v(O),label:"Xóa",color:"danger",onClick:M},null,8,["icon"])])])]),d.value?(u(),S(X,{key:0,color:d.value.type,icon:v(Z),class:"mb-6"},{default:m(()=>[Y(s(d.value.message),1)]),_:1},8,["color","icon"])):w("",!0),t("div",rt,[t("div",dt,[t("div",mt,[t("div",{class:A(`px-4 py-2 rounded-full text-sm font-semibold ${c[n.appointment.status.toLowerCase()]==="success"?"bg-green-100 text-green-800":c[n.appointment.status.toLowerCase()]==="warning"?"bg-yellow-100 text-yellow-800":c[n.appointment.status.toLowerCase()]==="danger"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`)},s(k[n.appointment.status.toLowerCase()]||"Không xác định"),3),t("span",ct," Cập nhật lần cuối: "+s(g(n.appointment.updated_at)),1)])])]),n.appointment.status.toLowerCase()==="cancelled"?(u(),C("div",pt,[e[7]||(e[7]=t("h3",{class:"font-semibold text-red-700 mb-3"},"Thông tin hủy lịch",-1)),t("div",ut,[t("div",ht,[t("div",null,[e[4]||(e[4]=t("span",{class:"text-gray-600 font-medium"},"Người hủy:",-1)),t("p",null,s(((a=n.appointment.cancelled_by)==null?void 0:a.full_name)||"Không xác định"),1)]),t("div",null,[e[5]||(e[5]=t("span",{class:"text-gray-600 font-medium"},"Thời gian hủy:",-1)),t("p",null,s(g(n.appointment.cancelled_at)),1)])]),t("div",null,[e[6]||(e[6]=t("span",{class:"text-gray-600 font-medium"},"Lý do hủy:",-1)),t("p",gt,s(n.appointment.cancellation_note||"Không có lý do"),1)])])])):w("",!0),t("div",ft,[r(_,{class:"relative overflow-hidden"},{default:m(()=>{var l,o,p;return[t("div",vt,[e[14]||(e[14]=t("h2",{class:"text-xl font-semibold mb-4 flex items-center"},[t("span",{class:"mr-2"},"Thông tin chung")],-1)),t("div",yt,[t("div",null,[e[8]||(e[8]=t("span",{class:"text-gray-500"},"Loại lịch hẹn",-1)),t("p",xt,s(K[n.appointment.appointment_type]||"Không xác định"),1)]),t("div",null,[e[9]||(e[9]=t("span",{class:"text-gray-500"},"Trạng thái",-1)),t("div",bt,[t("span",{class:A(`inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium
                                        ${c[n.appointment.status.toLowerCase()]==="success"?"bg-green-100 text-green-800":c[n.appointment.status.toLowerCase()]==="warning"?"bg-yellow-100 text-yellow-800":c[n.appointment.status.toLowerCase()]==="danger"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`)},s(k[n.appointment.status.toLowerCase()]||"Không xác định"),3)])]),t("div",wt,[e[10]||(e[10]=t("span",{class:"text-gray-500"},"Thời gian lịch hẹn",-1)),t("div",Ct,[t("p",kt," Ngày: "+s(g(n.appointment.appointment_date)),1),t("p",_t," Giờ: "+s((l=n.appointment.time_slot)==null?void 0:l.start_time)+" - "+s((o=n.appointment.time_slot)==null?void 0:o.end_time),1)])]),t("div",null,[e[11]||(e[11]=t("span",{class:"text-gray-500"},"Số lượng slot",-1)),t("p",Lt,s(n.appointment.slots),1)]),t("div",null,[e[12]||(e[12]=t("span",{class:"text-gray-500"},"Số lượng tối đa",-1)),t("p",Vt,s(((p=n.appointment.time_slot)==null?void 0:p.max_bookings)||0)+" lượt/khung giờ ",1)])]),n.appointment.note?(u(),C("div",Nt,[e[13]||(e[13]=t("span",{class:"text-gray-500"},"Ghi chú",-1)),t("p",Tt,s(n.appointment.note),1)])):w("",!0)])]}),_:1}),r(_,null,{default:m(()=>{var l,o,p,$,D,j,B;return[t("div",$t,[e[20]||(e[20]=t("h2",{class:"text-xl font-semibold mb-4 flex items-center"},[t("span",{class:"mr-2"},"Thông tin dịch vụ"),t("span",{class:"p-1 bg-purple-100 rounded-full"},[t("svg",{class:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})])])],-1)),t("div",Dt,[t("div",jt,[e[15]||(e[15]=t("span",{class:"text-gray-500"},"Dịch vụ",-1)),t("p",Bt,s((l=n.appointment.service)==null?void 0:l.service_name),1)]),t("div",null,[e[16]||(e[16]=t("span",{class:"text-gray-500"},"Thời gian thực hiện",-1)),t("p",St,s(((o=n.appointment.service)==null?void 0:o.duration)||0)+" phút",1)]),t("div",null,[e[17]||(e[17]=t("span",{class:"text-gray-500"},"Giá dịch vụ",-1)),t("p",At,s(H((p=n.appointment.service)==null?void 0:p.single_price)),1)]),t("div",Kt,[e[18]||(e[18]=t("span",{class:"text-gray-500"},"Nhân viên phụ trách",-1)),t("div",Mt,[t("div",Ft,[t("span",Ht,s(U(($=n.appointment.staff)==null?void 0:$.full_name)),1)]),t("div",null,[t("p",Ut,s((D=n.appointment.staff)==null?void 0:D.full_name),1),t("p",zt,s((j=n.appointment.staff)==null?void 0:j.email),1)])])]),(B=n.appointment.service)!=null&&B.description?(u(),C("div",Gt,[e[19]||(e[19]=t("span",{class:"text-gray-500"},"Mô tả dịch vụ",-1)),t("p",It,s(n.appointment.service.description),1)])):w("",!0)])])]}),_:1}),r(_,null,{default:m(()=>[t("div",Pt,[e[21]||(e[21]=t("h2",{class:"text-xl font-semibold mb-4"},"Cập nhật trạng thái",-1)),t("div",Xt,[(u(),C(et,null,tt(k,(l,o)=>r(L,{key:o,label:l,color:c[o],disabled:n.appointment.status===o||n.appointment.status==="cancelled"&&o!=="cancelled"||n.appointment.status==="completed"&&o!=="completed",outline:n.appointment.status!==o,class:"w-full justify-center",onClick:p=>o==="cancelled"?y.value=!0:z(o)},null,8,["label","color","disabled","outline","onClick"])),64))])])]),_:1})])]}),_:1},8,["breadcrumbs"]),r(P,{modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=a=>y.value=a),title:"Hủy lịch hẹn",button:"danger",buttonLabel:"Xác nhận hủy",hasCancel:!0,onConfirm:F},{default:m(()=>[r(J,{label:"Lý do hủy",help:"Vui lòng nhập lý do hủy lịch"},{default:m(()=>[r(Q,{modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=a=>x.value=a),type:"textarea",placeholder:"Nhập lý do hủy lịch...",rows:4},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},Ie=R(qt,[["__scopeId","data-v-293a3b36"]]);export{Ie as default};
