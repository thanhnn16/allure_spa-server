import{r as n,f as K,c as k,e as C,aU as u,a0 as v,bH as d,aa as l,bl as r,a3 as t,P as Q,a2 as L,b0 as W,j as X,bf as p,a1 as T,F as Z,aG as q,a9 as ee,bJ as te,bA as se}from"./@vue-BRgAy5zV.js";import{_ as w}from"./BaseButton-eMTGofBM.js";import{_ as A}from"./BaseIcon-B4kwkOCn.js";import{_ as oe}from"./CardBox-jfYP3QDG.js";import{_ as ae}from"./SectionMain-Vot1TOkK.js";import{L as le}from"./LayoutAuthenticated-C16ARFQf.js";import{Z as ie,F as H}from"./@inertiajs-D0DMCEQB.js";import{m as ne,a as re,b as de,c as pe,d as ce,e as ue,f as me,g as ge,h as fe}from"./@mdi-D7koDRFv.js";import{a as j}from"./axios-CCb-kr4I.js";import{u as ye}from"./vue-toastification-ejyjJRED.js";import ve from"./DeleteModal-DTPuiSfA.js";import he from"./EditModal-F7VXrS-H.js";import be from"./PreviewModal-Ckgbq0J2.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as xe,Y as ke,G as Ce,V as Te}from"./@headlessui-BdO8fvzs.js";import"./colors-S7_1wET5.js";import"./app-D7IfN5Sd.js";import"./jspdf-Ciebq7We.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./@babel-BsCcpEdk.js";import"./fflate-EnPhvkmS.js";import"./laravel-echo-C9ppFO4I.js";import"./pusher-js-Cl-1XqxI.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./pinia-BhnhDyRZ.js";import"./firebase-DL3QX-oU.js";import"./@firebase--zA4YiqN.js";import"./idb-Bn1DMRyg.js";import"./deepmerge-CtOfIP5S.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./OverlayLayer-BSs7OF78.js";import"./codemirror-CVTlwwoA.js";import"./@codemirror-CGiQA2_Y.js";import"./@lezer-Cz8LLRrF.js";import"./style-mod-Bc2inJdb.js";import"./w3c-keyname-Vcq4gwWv.js";const we={class:"bg-white dark:bg-slate-900 rounded-lg shadow-md p-6 mb-6"},Ae={class:"flex flex-col md:flex-row justify-between items-center gap-4"},je={class:"flex items-center space-x-4"},Se={class:"flex flex-wrap gap-3"},Ie={class:"grid gap-6"},Me={class:"flex justify-between items-start mb-4"},Pe={class:"flex-1"},Ve={class:"flex items-center gap-2"},$e={class:"text-lg font-semibold"},Fe={key:0,class:"px-2 py-1 text-xs rounded-full bg-green-100 text-green-800"},Ne={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},Oe={class:"flex gap-2"},Ke=["onClick"],Le=["onClick"],qe=["onClick"],He={class:"space-y-4"},De={class:"grid grid-cols-2 gap-4 text-sm"},Ee={class:"mt-4"},Be={class:"text-sm line-clamp-3"},Ge={class:"grid grid-cols-3 gap-2 pt-4 border-t dark:border-gray-700"},Je={class:"text-center"},ze={class:"font-semibold"},Re={class:"text-center"},Ue={class:"font-semibold"},Ye={class:"text-center"},Qe={class:"font-semibold"},We={class:"fixed inset-0 overflow-y-auto"},Xe={class:"flex min-h-full items-center justify-center p-4"},Ze={class:"mt-4"},et={class:"mt-4 flex justify-end space-x-2"},tt={__name:"AiConfigView",props:{configs:{type:Array,required:!0},configTypes:{type:Object,required:!0},modelTypes:{type:Object,required:!0},languages:{type:Object,required:!0},responseFormats:{type:Object,required:!0},defaultSafetySettings:{type:Array,required:!0},defaultFunctionDeclarations:{type:Array,required:!0},defaultToolConfig:{type:Object,required:!0},configTemplates:{type:Object,required:!0}},setup(V){const c=ye(),a=V,g=n(a.configs),m=n(null),h=n(!1),b=n(!1),S=n(!1),I=n(!1);n(!1),n(null);const f=n(null),D=n("system"),_=K({...a.configTemplates.system_prompt}),M=k(()=>[{key:"ai_name",label:"Tên Trợ Lý",type:"text",group:"basic",required:!0,description:"Tên định danh cho trợ lý AI"},{key:"type",label:"Loại Cấu Hình",type:"select",group:"basic",options:[{value:"general_assistant",label:"Trợ Lý Tổng Hợp"}],description:"Loại cấu hình AI"},{key:"language",label:"Ngôn Ngữ Mặc Định",type:"select",group:"basic",options:Object.entries(a.languages).map(([s,e])=>({value:s,label:e})),description:"Ngôn ngữ chính của AI"},{key:"model_type",label:"Model AI",type:"select",group:"basic",options:Object.entries(a.modelTypes).map(([s,e])=>({value:s,label:e})),description:"Model AI được sử dụng"},{key:"temperature",label:"Temperature",type:"slider",group:"behavior",min:0,max:1,step:.1,description:"Độ sáng tạo của câu trả lời (0-1)"},{key:"max_tokens",label:"Max Tokens",type:"number",group:"behavior",min:1,max:8192,description:"Số tokens tối đa cho mỗi câu trả lời"},{key:"top_p",label:"Top P",type:"slider",group:"behavior",min:0,max:1,step:.1,description:"Nucleus sampling probability"},{key:"top_k",label:"Top K",type:"number",group:"behavior",min:1,max:100,description:"Top K sampling"},{key:"context",label:"Context & Instructions",type:"markdown-editor",group:"advanced",description:"Hướng dẫn và ngữ cảnh cho AI",fullWidth:!0},{key:"function_declarations",label:"Function Declarations",type:"json-editor",group:"advanced",description:"Cấu hình các hàm có thể gọi",defaultValue:JSON.stringify(a.defaultFunctionDeclarations,null,2)},{key:"safety_settings",label:"Safety Settings",type:"json-editor",group:"advanced",description:"Cấu hình an toàn",defaultValue:JSON.stringify(a.defaultSafetySettings,null,2)},{key:"tool_config",label:"Tool Configuration",type:"json-editor",group:"advanced",description:"Cấu hình công cụ",defaultValue:JSON.stringify(a.defaultToolConfig,null,2)}]),E=k(()=>({basic:{label:"Thông Tin Cơ Bản",icon:me,fields:M.value.filter(s=>s.group==="basic")},behavior:{label:"Hành Vi AI",icon:ge,fields:M.value.filter(s=>s.group==="behavior")},advanced:{label:"Cài Đặt Nâng Cao",icon:fe,fields:M.value.filter(s=>s.group==="advanced")}}));C(()=>_.type,s=>{a.configTemplates[s]&&Object.assign(_,a.configTemplates[s])});const P=K({});C(()=>_.type,s=>{f.value||(P.value={},Object.assign(P,defaultValues[s]))});const $=k(()=>({configTypes:a.configTypes,modelTypes:a.modelTypes,languages:a.languages,responseFormats:a.responseFormats,defaultSafetySettings:a.defaultSafetySettings,defaultFunctionDeclarations:a.defaultFunctionDeclarations,defaultToolConfig:a.defaultToolConfig})),F=(s=null)=>{f.value=s,I.value=!0},B=s=>{m.value=s,S.value=!0},N=()=>{f.value=null,I.value=!1},G=async s=>{var e,o;try{h.value=!0;const i=s.id?`/api/ai-configs/${s.id}`:"/api/ai-configs",Y=s.id?"put":"post",O=await j[Y](i,s);O.data.configs&&(g.value=O.data.configs,c.success(s.id?"Cập nhật thành công!":"Tạo mới thành công!"),N(),H.reload())}catch(i){console.error("Submit error:",i),c.error(((o=(e=i.response)==null?void 0:e.data)==null?void 0:o.message)||"Có lỗi xảy ra")}finally{h.value=!1}},J=async()=>{var s,e,o;if((s=m.value)!=null&&s.id)try{h.value=!0;const i=await j.delete(`/api/ai-configs/${m.value.id}`);i.data.configs&&(g.value=i.data.configs,c.success("Xóa cấu hình thành công!"),b.value=!1,H.reload())}catch(i){console.error("Delete error:",i),c.error(((o=(e=i.response)==null?void 0:e.data)==null?void 0:o.message)||"Có lỗi xảy ra khi xóa")}finally{h.value=!1}};C(()=>_.type,s=>{if(!f.value){const e=defaultValues[s];Object.assign(P,e)}}),k(()=>{var e;const s={system:"system_prompt",vision:"vision_config",general:"general"};return((e=g.value)==null?void 0:e.filter(o=>o.type===s[D.value]))||[]});const z=s=>{m.value=s,b.value=!0};C(()=>a.configs,s=>{g.value=s},{immediate:!0});const y=n(!1),x=n(""),R=async()=>{try{const s=await j.get("/api/ai-configs/global-api-key");x.value=s.data.api_key||"",y.value=!0}catch{c.error("Không thể lấy API key")}},U=async()=>{try{await j.post("/api/ai-configs/global-api-key",{api_key:x.value}),c.success("Cập nhật API key thành công!"),y.value=!1}catch{c.error("Không thể cập nhật API key")}};return(s,e)=>(u(),v(le,null,{default:d(()=>[l(r(ie),{title:"Cấu Hình AI"}),l(ae,null,{default:d(()=>[t("div",we,[t("div",Ae,[t("div",je,[l(A,{path:r(ne),class:"w-12 h-12 text-blue-500 animate-pulse"},null,8,["path"]),e[6]||(e[6]=t("div",null,[t("h1",{class:"text-2xl font-bold dark:text-white"}," Cấu Hình Trợ Lý AI "),t("p",{class:"text-gray-600 dark:text-gray-400"}," Quản lý và tùy chỉnh trợ lý AI thông minh ")],-1))]),t("div",Se,[l(w,{label:"API Key",color:"warning",onClick:R,icon:r(re),class:"hover:scale-105 transition-transform"},null,8,["icon"]),l(w,{label:"Thêm Mới",color:"info",onClick:e[0]||(e[0]=o=>F()),icon:r(de),class:"hover:scale-105 transition-transform"},null,8,["icon"])])])]),t("div",Ie,[l(Q,{name:"list",tag:"div",class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6"},{default:d(()=>[(u(!0),L(Z,null,W(g.value,o=>(u(),v(oe,{key:o.id,class:X(["transform hover:scale-102 transition-all duration-300",{"ring-2 ring-blue-500":o.is_active}])},{default:d(()=>[t("div",Me,[t("div",Pe,[t("div",Ve,[t("h3",$e,p(o.ai_name),1),o.is_active?(u(),L("span",Fe," Active ")):T("",!0)]),t("p",Ne,p(o.model_type),1)]),t("div",Oe,[t("button",{onClick:i=>B(o),class:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"},[l(A,{path:r(pe),class:"w-5 h-5"},null,8,["path"])],8,Ke),t("button",{onClick:i=>F(o),class:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"},[l(A,{path:r(ce),class:"w-5 h-5"},null,8,["path"])],8,Le),t("button",{onClick:i=>z(o),class:"p-2 rounded-full hover:bg-red-100 dark:hover:bg-red-900 transition-colors"},[l(A,{path:r(ue),class:"w-5 h-5 text-red-500"},null,8,["path"])],8,qe)])]),t("div",He,[t("div",De,[t("div",null,[e[7]||(e[7]=t("span",{class:"text-gray-500"},"Language",-1)),t("p",null,p(a.languages[o.language]),1)]),t("div",null,[e[8]||(e[8]=t("span",{class:"text-gray-500"},"Temperature",-1)),t("p",null,p(o.temperature),1)])]),t("div",Ee,[e[9]||(e[9]=t("span",{class:"text-gray-500 text-sm"},"Context",-1)),t("p",Be,p(o.context),1)]),t("div",Ge,[t("div",Je,[e[10]||(e[10]=t("span",{class:"text-sm text-gray-500"},"Max Tokens",-1)),t("p",ze,p(o.max_tokens),1)]),t("div",Re,[e[11]||(e[11]=t("span",{class:"text-sm text-gray-500"},"Top P",-1)),t("p",Ue,p(o.top_p),1)]),t("div",Ye,[e[12]||(e[12]=t("span",{class:"text-sm text-gray-500"},"Top K",-1)),t("p",Qe,p(o.top_k),1)])])])]),_:2},1032,["class"]))),128))]),_:1})]),I.value?(u(),v(he,q({key:0,config:f.value,"field-groups":E.value},$.value,{onClose:N,onSubmit:G}),null,16,["config","field-groups"])):T("",!0),b.value?(u(),v(ve,{key:1,config:m.value,"config-types":V.configTypes,onClose:e[1]||(e[1]=o=>b.value=!1),onConfirm:J},null,8,["config","config-types"])):T("",!0),S.value?(u(),v(be,q({key:2,config:m.value},$.value,{onClose:e[2]||(e[2]=o=>S.value=!1)}),null,16,["config"])):T("",!0),l(r(xe),{appear:"",show:y.value,as:"template"},{default:d(()=>[l(r(ke),{as:"div",onClose:e[5]||(e[5]=o=>y.value=!1),class:"relative z-50"},{default:d(()=>[e[14]||(e[14]=t("div",{class:"fixed inset-0 bg-black/30"},null,-1)),t("div",We,[t("div",Xe,[l(r(Ce),{class:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all dark:bg-slate-900"},{default:d(()=>[l(r(Te),{as:"h3",class:"text-lg font-medium leading-6"},{default:d(()=>e[13]||(e[13]=[ee(" Cập Nhật API Key Chung ")])),_:1}),t("div",Ze,[te(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>x.value=o),type:"password",class:"w-full rounded-lg border px-4 py-2 dark:bg-slate-800 dark:border-slate-700",placeholder:"Nhập API key..."},null,512),[[se,x.value]])]),t("div",et,[l(w,{label:"Hủy",color:"white",onClick:e[4]||(e[4]=o=>y.value=!1)}),l(w,{label:"Lưu",color:"success",onClick:U})])]),_:1})])])]),_:1})]),_:1},8,["show"])]),_:1})]),_:1}))}},es=_e(tt,[["__scopeId","data-v-986bde55"]]);export{es as default};
