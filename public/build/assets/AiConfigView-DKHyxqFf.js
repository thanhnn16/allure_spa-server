import{r as i,f as H,c as $,e as j,aU as u,a0 as x,bH as m,aa as n,bl as r,a3 as a,bf as p,a2 as N,b0 as E,j as P,F as J,P as ie,a1 as _,a9 as C,aG as re,bJ as ce,bA as de}from"./@vue-BRgAy5zV.js";import{_ as f}from"./BaseButton-eMTGofBM.js";import{_ as G}from"./BaseIcon-B4kwkOCn.js";import{_ as ue}from"./CardBox-jfYP3QDG.js";import{_ as pe}from"./SectionMain-BbIPmLtw.js";import{L as me}from"./LayoutAuthenticated-CndSPsIa.js";import{Z as fe,F as I}from"./@inertiajs-D0DMCEQB.js";import{m as ge,a as ye,b as he,c as ve,d as xe,e as be,f as ke,g as _e,h as Ce,i as we}from"./@mdi-CTfBXXzV.js";import{a as w}from"./axios-CCb-kr4I.js";import{u as Te}from"./vue-toastification-ejyjJRED.js";import Ae from"./DeleteModal-tQnHdu8W.js";import Se from"./EditModal-1VMz2yPQ.js";import je from"./PreviewModal-Ch80-a-0.js";import Me from"./UploadModal-Dh5UF47p.js";import{_ as Fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as Ve,Y as Oe,G as $e,V as Ne}from"./@headlessui-BdO8fvzs.js";import"./colors-S7_1wET5.js";import"./app-RXIAU7LH.js";import"./jspdf-Ciebq7We.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./@babel-BsCcpEdk.js";import"./fflate-EnPhvkmS.js";import"./laravel-echo-C9ppFO4I.js";import"./pusher-js-Cl-1XqxI.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./pinia-BhnhDyRZ.js";import"./firebase-DL3QX-oU.js";import"./@firebase--zA4YiqN.js";import"./idb-Bn1DMRyg.js";import"./deepmerge-CtOfIP5S.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./OverlayLayer-BSs7OF78.js";import"./codemirror-CVTlwwoA.js";import"./@codemirror-CGiQA2_Y.js";import"./@lezer-Cz8LLRrF.js";import"./style-mod-Bc2inJdb.js";import"./w3c-keyname-Vcq4gwWv.js";const Pe={class:"bg-white dark:bg-slate-900 rounded-lg shadow-md p-6 mb-6"},Ie={class:"flex flex-col md:flex-row justify-between items-center gap-4"},Ke={class:"flex items-center space-x-4"},qe={class:"text-gray-600 dark:text-gray-400"},De={class:"flex flex-wrap gap-3"},Le={class:"bg-white dark:bg-slate-900 rounded-lg shadow-md p-4 mb-6"},Ue={class:"flex space-x-2 overflow-x-auto"},He=["onClick"],Ee={class:"flex items-center space-x-2"},Je={class:"flex flex-col h-full"},Ge={class:"flex justify-between items-start mb-4"},Be={class:"flex-1 min-w-0"},ze={class:"flex items-center space-x-2"},Re={class:"text-lg font-semibold dark:text-white truncate"},Ye={key:0,class:"px-2 py-1 text-xs rounded-full bg-green-100 text-green-800 whitespace-nowrap"},Xe={class:"text-sm text-gray-600 dark:text-gray-400 mt-1 line-clamp-2"},Ze={class:"flex flex-shrink-0 space-x-2 ml-4"},Qe={class:"grid grid-cols-2 gap-4 text-sm mt-auto"},We={class:"space-y-1"},et={class:"text-gray-600 dark:text-gray-400"},tt={class:"text-gray-600 dark:text-gray-400"},ot={class:"space-y-1"},at={class:"text-gray-600 dark:text-gray-400"},st={class:"text-gray-600 dark:text-gray-400"},lt={class:"fixed inset-0 overflow-y-auto"},nt={class:"flex min-h-full items-center justify-center p-4"},it={class:"mt-4"},rt={class:"mt-4 flex justify-end space-x-2"},ct={__name:"AiConfigView",props:{configs:{type:Array,required:!0},configTypes:{type:Object,required:!0},modelTypes:{type:Object,required:!0},languages:{type:Object,required:!0},responseFormats:{type:Object,required:!0},defaultSafetySettings:{type:Array,required:!0},defaultFunctionDeclarations:{type:Array,required:!0},defaultToolConfig:{type:Object,required:!0},configTemplates:{type:Object,required:!0}},setup(c){const d=Te(),B=[{id:"system",label:"Mô Tả Hệ Thống",icon:_e},{id:"vision",label:"Phân Tích Hình Ảnh",icon:Ce},{id:"general",label:"Cài Đặt Chung",icon:we}],s=c,y=i(s.configs),h=i(null),g=i(!1),T=i(!1),M=i(!1),F=i(!1),V=i(!1);i(null);const b=i(null),v=i("system"),A=H({...s.configTemplates.system_prompt}),z=$(()=>[{key:"ai_name",label:"Tên Cấu Hình",type:"text",column:"left",required:!0,description:"Tên định danh cho cấu hình AI"},{key:"type",label:"Loại Cấu Hình",type:"select",column:"left",options:Object.entries(s.configTypes).map(([t,e])=>({value:t,label:e.name})),description:"Loại cấu hình AI"},{key:"language",label:"Ngôn Ngữ",type:"select",column:"left",options:Object.entries(s.languages).map(([t,e])=>({value:t,label:e})),description:"Ngôn ngữ chính của AI"},{key:"model_type",label:"Model AI",type:"select",column:"left",options:Object.entries(s.modelTypes).map(([t,e])=>({value:t,label:e})),description:"Model AI được sử dụng"},{key:"temperature",label:"Temperature",type:"number",column:"right",min:0,max:1,step:.1,description:"Độ sáng tạo của câu trả lời (0-1)"},{key:"max_tokens",label:"Max Tokens",type:"number",column:"right",min:1,max:8192,description:"Số tokens tối đa cho mỗi câu trả lời"},{key:"top_p",label:"Top P",type:"number",column:"right",min:0,max:1,step:.1,description:"Nucleus sampling probability"},{key:"top_k",label:"Top K",type:"number",column:"right",min:1,max:100,description:"Top K sampling"},{key:"safety_settings",label:"Safety Settings",type:"json-editor",description:"Cấu hình an toàn",defaultValue:JSON.stringify(s.defaultSafetySettings,null,2),group:"advanced"},{key:"function_declarations",label:"Function Declarations",type:"json-editor",description:"Cấu hình các hàm có thể gọi",defaultValue:JSON.stringify(s.defaultFunctionDeclarations,null,2),group:"advanced"},{key:"tool_config",label:"Tool Configuration",type:"json-editor",description:"Cấu hình cho function calling",defaultValue:JSON.stringify(s.defaultToolConfig,null,2),group:"advanced"},{key:"context",label:"Context",type:"json-editor",column:"right",description:"Ngữ cảnh và hướng dẫn cho AI",defaultValue:"",schema:null},{key:"function_declarations",label:"Function Declarations",type:"json-editor",column:"right",description:"Cấu hình các hàm có thể gọi",defaultValue:JSON.stringify(s.defaultFunctionDeclarations,null,2),schema:null},{key:"tool_config",label:"Tool Configuration",type:"json-editor",column:"right",description:"Cấu hình cho function calling",defaultValue:JSON.stringify(s.defaultToolConfig,null,2),schema:null}]);j(()=>A.type,t=>{s.configTemplates[t]&&Object.assign(A,s.configTemplates[t])});const O=H({});j(()=>A.type,t=>{b.value||(O.value={},Object.assign(O,defaultValues[t]))});const R=$(()=>({configTypes:s.configTypes,modelTypes:s.modelTypes,languages:s.languages,responseFormats:s.responseFormats,defaultSafetySettings:s.defaultSafetySettings,defaultFunctionDeclarations:s.defaultFunctionDeclarations,defaultToolConfig:s.defaultToolConfig})),K=(t=null)=>{b.value=t,F.value=!0},Y=t=>{h.value=t,M.value=!0},X=()=>{V.value=!0},q=()=>{b.value=null,F.value=!1},D=()=>{V.value=!1},Z=async t=>{var e,o;try{g.value=!0;const l=t.id?`/api/ai-configs/${t.id}`:"/api/ai-configs",ne=t.id?"put":"post",U=await w[ne](l,t);U.data.configs&&(y.value=U.data.configs,d.success(t.id?"Cập nhật thành công!":"Tạo mới thành công!"),q(),I.reload())}catch(l){console.error("Submit error:",l),d.error(((o=(e=l.response)==null?void 0:e.data)==null?void 0:o.message)||"Có lỗi xảy ra")}finally{g.value=!1}},Q=async t=>{var e,o;try{g.value=!0;const l=await w.post("/api/ai-configs/upload",t,{headers:{"Content-Type":"multipart/form-data"}});l.data.configs&&(y.value=l.data.configs,d.success("Tải lên thành công!"),I.reload()),D()}catch(l){console.error("Upload error:",l),d.error(((o=(e=l.response)==null?void 0:e.data)==null?void 0:o.message)||"Có lỗi xảy ra khi tải lên")}finally{g.value=!1}},W=async()=>{var t,e,o;if((t=h.value)!=null&&t.id)try{g.value=!0;const l=await w.delete(`/api/ai-configs/${h.value.id}`);l.data.configs&&(y.value=l.data.configs,d.success("Xóa cấu hình thành công!"),T.value=!1,I.reload())}catch(l){console.error("Delete error:",l),d.error(((o=(e=l.response)==null?void 0:e.data)==null?void 0:o.message)||"Có lỗi xảy ra khi xóa")}finally{g.value=!1}};j(()=>A.type,t=>{if(!b.value){const e=defaultValues[t];Object.assign(O,e)}});const L=$(()=>{var e;const t={system:"system_prompt",vision:"vision_config",general:"general"};return((e=y.value)==null?void 0:e.filter(o=>o.type===t[v.value]))||[]}),ee=t=>({"bg-blue-500 text-white":v.value===t,"text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800":v.value!==t}),te=t=>({"bg-blue-200 text-blue-800":v.value===t,"bg-gray-200 text-gray-600 dark:bg-gray-700 dark:text-gray-300":v.value!==t}),oe=t=>{const e={system:"system_prompt",vision:"vision_config",general:"general"};return y.value.filter(o=>o.type===e[t]).length},ae=t=>{h.value=t,T.value=!0};j(()=>s.configs,t=>{y.value=t},{immediate:!0});const k=i(!1),S=i(""),se=async()=>{try{const t=await w.get("/api/ai-configs/global-api-key");S.value=t.data.api_key||"",k.value=!0}catch{d.error("Không thể lấy API key")}},le=async()=>{try{await w.post("/api/ai-configs/global-api-key",{api_key:S.value}),d.success("Cập nhật API key thành công!"),k.value=!1}catch{d.error("Không thể cập nhật API key")}};return(t,e)=>(u(),x(me,null,{default:m(()=>[n(r(fe),{title:"Cấu Hình AI"}),n(pe,null,{default:m(()=>[a("div",Pe,[a("div",Ie,[a("div",Ke,[n(G,{path:r(ge),class:"w-8 h-8 text-blue-500"},null,8,["path"]),a("div",null,[e[6]||(e[6]=a("h1",{class:"text-2xl font-bold dark:text-white"},"Cấu Hình AI",-1)),a("p",qe,p(L.value.length)+" cấu hình ",1)])]),a("div",De,[n(f,{label:"Tải Lên",color:"success",onClick:X,icon:r(ye),loading:g.value},null,8,["icon","loading"]),n(f,{label:"Thêm Mới",color:"info",onClick:e[0]||(e[0]=o=>K()),icon:r(he)},null,8,["icon"]),n(f,{label:"API Key",color:"warning",onClick:se,icon:r(ve)},null,8,["icon"])])])]),a("div",Le,[a("div",Ue,[(u(),N(J,null,E(B,o=>a("button",{key:o.id,onClick:l=>v.value=o.id,class:P(["px-4 py-2 rounded-md transition-all duration-200 whitespace-nowrap",ee(o.id)])},[a("div",Ee,[n(G,{path:o.icon,class:"w-5 h-5"},null,8,["path"]),a("span",null,p(o.label),1),a("span",{class:P(["ml-2 px-2 py-0.5 text-xs rounded-full",te(o.id)])},p(oe(o.id)),3)])],10,He)),64))])]),n(ie,{name:"config-list",tag:"div",class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},{default:m(()=>[(u(!0),N(J,null,E(L.value,o=>(u(),x(ue,{key:o.id,class:P(["!p-6 hover:shadow-lg transition-shadow duration-200",{"border-2 border-blue-500":o.is_active}])},{default:m(()=>[a("div",Je,[a("div",Ge,[a("div",Be,[a("div",ze,[a("h3",Re,p(o.ai_name),1),o.is_active?(u(),N("span",Ye," Active ")):_("",!0)]),a("p",Xe,p(o.context),1)]),a("div",Ze,[n(f,{color:"info",icon:r(xe),small:"",onClick:l=>Y(o)},null,8,["icon","onClick"]),n(f,{color:"info",icon:r(be),small:"",onClick:l=>K(o)},null,8,["icon","onClick"]),n(f,{color:"danger",icon:r(ke),small:"",onClick:l=>ae(o)},null,8,["icon","onClick"])])]),a("div",Qe,[a("div",We,[a("p",et,[e[7]||(e[7]=a("span",{class:"font-medium"},"Model:",-1)),C(" "+p(o.model_type),1)]),a("p",tt,[e[8]||(e[8]=a("span",{class:"font-medium"},"Language:",-1)),C(" "+p(o.language),1)])]),a("div",ot,[a("p",at,[e[9]||(e[9]=a("span",{class:"font-medium"},"Temp:",-1)),C(" "+p(o.temperature),1)]),a("p",st,[e[10]||(e[10]=a("span",{class:"font-medium"},"Tokens:",-1)),C(" "+p(o.max_tokens),1)])])])])]),_:2},1032,["class"]))),128))]),_:1}),F.value?(u(),x(Se,{key:0,config:b.value,fields:z.value,"config-types":c.configTypes,"model-types":c.modelTypes,languages:c.languages,"response-formats":c.responseFormats,"default-safety-settings":c.defaultSafetySettings,"default-function-declarations":c.defaultFunctionDeclarations,"default-tool-config":c.defaultToolConfig,onClose:q,onSubmit:Z},null,8,["config","fields","config-types","model-types","languages","response-formats","default-safety-settings","default-function-declarations","default-tool-config"])):_("",!0),V.value?(u(),x(Me,{key:1,"config-types":c.configTypes,onClose:D,onUpload:Q},null,8,["config-types"])):_("",!0),T.value?(u(),x(Ae,{key:2,config:h.value,"config-types":c.configTypes,onClose:e[1]||(e[1]=o=>T.value=!1),onConfirm:W},null,8,["config","config-types"])):_("",!0),M.value?(u(),x(je,re({key:3,config:h.value},R.value,{onClose:e[2]||(e[2]=o=>M.value=!1)}),null,16,["config"])):_("",!0),n(r(Ve),{appear:"",show:k.value,as:"template"},{default:m(()=>[n(r(Oe),{as:"div",onClose:e[5]||(e[5]=o=>k.value=!1),class:"relative z-50"},{default:m(()=>[e[12]||(e[12]=a("div",{class:"fixed inset-0 bg-black/30"},null,-1)),a("div",lt,[a("div",nt,[n(r($e),{class:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all dark:bg-slate-900"},{default:m(()=>[n(r(Ne),{as:"h3",class:"text-lg font-medium leading-6 text-gray-900 dark:text-white"},{default:m(()=>e[11]||(e[11]=[C(" Cập Nhật API Key Chung ")])),_:1}),a("div",it,[ce(a("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>S.value=o),type:"password",class:"w-full rounded-lg border px-4 py-2 dark:bg-slate-800 dark:border-slate-700 dark:text-white",placeholder:"Nhập API key..."},null,512),[[de,S.value]])]),a("div",rt,[n(f,{label:"Hủy",color:"white",onClick:e[4]||(e[4]=o=>k.value=!1)}),n(f,{label:"Lưu",color:"success",onClick:le})])]),_:1})])])]),_:1})]),_:1},8,["show"])]),_:1})]),_:1}))}},co=Fe(ct,[["__scopeId","data-v-9996fa45"]]);export{co as default};
