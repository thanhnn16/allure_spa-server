import{e as k}from"./@mdi-C-p5d_Pb.js";import{_ as f}from"./BaseButton-eMTGofBM.js";import{a as v}from"./axios-CCb-kr4I.js";import{r as c,o as N,aU as n,a2 as s,a3 as o,F as w,b0 as D,bf as d,aa as y,bl as L,a1 as u}from"./@vue-BRgAy5zV.js";import"./@inertiajs-D0DMCEQB.js";import"./deepmerge-CtOfIP5S.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./colors-S7_1wET5.js";import"./BaseIcon-B4kwkOCn.js";const C={class:"space-y-4"},B={class:"flex justify-between items-start"},M={class:"font-semibold"},V={class:"text-sm text-gray-600 dark:text-gray-400"},$={class:"mt-2 text-xs text-gray-500"},E={key:0,class:"text-center py-4"},j={key:1,class:"text-center"},F={key:2,class:"text-center text-gray-500"},S={key:3,class:"text-center text-gray-500"},ct={__name:"NotificationList",setup(T){const r=c([]),i=c(!1),p=c(1),l=c(!0),g=async(e=1)=>{try{i.value=!0;const t=await v.get(`/api/notifications/all?page=${e}`);console.log("Dữ liệu notification nhận được:",t.data);const a=t.data.data.data||[];console.log("notificationsData:",a);const m=a.map(h=>({...h,created_at:h.created_at_timestamp||h.created_at}));e===1?r.value=m:r.value.push(...m),l.value=t.data.data.hasMore,p.value=e}catch(t){console.error("Lỗi khi tải thông báo:",t)}finally{i.value=!1}},_=()=>{!i.value&&l.value&&g(p.value+1)},x=async e=>{if(confirm("Bạn có chắc muốn xóa thông báo này?"))try{await v.delete(`/api/notifications/${e}`),r.value=r.value.filter(t=>t.id!==e)}catch(t){console.error("Lỗi khi xóa thông báo:",t)}},b=e=>{try{if(!e)return"Chưa có ngày";let t;if(typeof e=="string")t=new Date(e);else if(typeof e=="number")t=new Date(e*1e3);else throw new Error("Định dạng timestamp không hợp lệ");if(isNaN(t.getTime()))throw new Error("Ngày không hợp lệ");return t.toLocaleDateString("vi-VN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return console.error("Lỗi định dạng ngày:",t,"timestamp:",e),"Ngày không xác định"}};return N(()=>{g()}),(e,t)=>(n(),s("div",null,[t[1]||(t[1]=o("h2",{class:"text-2xl font-bold mb-6"},"Lịch sử thông báo",-1)),o("div",C,[(n(!0),s(w,null,D(r.value,a=>(n(),s("div",{key:a.id,class:"border rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-800"},[o("div",B,[o("div",null,[o("h3",M,d(a.title),1),o("p",V,d(a.content),1),o("div",$,[o("span",null,d(b(a.created_at)),1),t[0]||(t[0]=o("span",{class:"mx-2"},"•",-1)),o("span",null,d(a.type),1)])]),y(f,{color:"danger",icon:L(k),small:"",onClick:m=>x(a.id)},null,8,["icon","onClick"])])]))),128)),i.value?(n(),s("div",E," Đang tải... ")):u("",!0),l.value&&!i.value?(n(),s("div",j,[y(f,{color:"info",label:"Tải thêm",onClick:_})])):u("",!0),!l.value&&r.value.length>0?(n(),s("div",F," Đã hiển thị tất cả thông báo ")):u("",!0),r.value.length===0&&!i.value?(n(),s("div",S," Chưa có thông báo nào ")):u("",!0)])]))}};export{ct as default};
