import{r as h,e as x,o as G,aU as m,a0 as j,bH as D,a3 as e,bJ as l,bA as u,bl as a,j as y,a2 as p,bf as c,a1 as f,bz as I,b0 as U,F as S,aa as B,bM as H}from"./@vue-BRgAy5zV.js";import{T as L,F as O}from"./@inertiajs-D0DMCEQB.js";import{u as z}from"./vue-toastification-ejyjJRED.js";import{C as A}from"./CardBoxModal-CFEDefl-.js";import{_ as M}from"./BaseButton-eMTGofBM.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./axios-CCb-kr4I.js";import"./deepmerge-CtOfIP5S.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./@mdi-xfgXKVp3.js";import"./BaseButtons-B17KSMwc.js";import"./CardBox-jfYP3QDG.js";import"./OverlayLayer-BSs7OF78.js";import"./colors-S7_1wET5.js";import"./BaseIcon-B4kwkOCn.js";const K={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Q={key:0,class:"text-red-500 dark:text-red-400 text-sm"},R=["value"],W={key:0,class:"text-red-500 dark:text-red-400 text-sm"},X={key:0,class:"text-red-500 dark:text-red-400 text-sm"},Y={key:0,class:"text-red-500 dark:text-red-400 text-sm"},Z={class:"space-y-4"},_={key:0,class:"bg-red-50 dark:bg-red-900/20 p-4 rounded-md"},rr={class:"mt-2 text-sm text-red-600 dark:text-red-400"},er={class:"flex justify-end space-x-2"},tr={__name:"EditProductModal",props:{modelValue:{type:Boolean,required:!0},product:{type:Object,required:!0},categories:{type:Array,required:!0}},emits:["update:modelValue","close","product-updated"],setup(v,{emit:T}){var C;const s=v,q=T,w=z(),n=h({}),k=h(!1),V=o=>new Intl.NumberFormat("vi-VN").format(o),F=o=>Number(o.replace(/[^\d]/g,"")),b=h(""),t=L({name:s.product.name,category_id:s.product.category_id,price:((C=s.product)==null?void 0:C.price)||0,quantity:s.product.quantity,brand_description:s.product.brand_description||"",usage:s.product.usage||"",benefits:s.product.benefits||"",key_ingredients:s.product.key_ingredients||"",ingredients:s.product.ingredients||"",directions:s.product.directions||"",storage_instructions:s.product.storage_instructions||"",product_notes:s.product.product_notes||""}),$=o=>{const r=o.target.value.replace(/[^\d]/g,"");r?(b.value=V(r),t.price=F(b.value)):(b.value="",t.price=0)},E=()=>{t.price&&(b.value=V(t.price))},P=()=>{var r;n.value={};let o=!0;return(r=t.name)!=null&&r.trim()||(n.value.name="Tên sản phẩm là bắt buộc",o=!1),t.category_id||(n.value.category_id="Vui lòng chọn danh mục",o=!1),(!t.price||isNaN(Number(t.price))||Number(t.price)<=0)&&(n.value.price="Giá sản phẩm phải lớn hơn 0",o=!1),(!t.quantity||isNaN(Number(t.quantity))||Number(t.quantity)<0)&&(n.value.quantity="Số lượng không được âm",o=!1),o},g=(o,r)=>{const d={name:i=>i?i.length<3?"Tên sản phẩm phải có ít nhất 3 ký tự":null:"Tên sản phẩm là bắt buộc",category_id:i=>i?null:"Danh mục là bắt buộc",price:i=>i?isNaN(i)?"Giá phải là số":parseFloat(i)<=0?"Giá phải lớn hơn 0":null:"Giá là bắt buộc",quantity:i=>i?isNaN(i)?"Số lượng phải là số":parseInt(i)<0?"Số lượng không được âm":null:"Số lượng là bắt buộc"};if(d[o]){const i=d[o](r);return i?(n.value[o]=i,!1):(delete n.value[o],!0)}return!0},N=async()=>{if(!k.value&&P()){k.value=!0;try{t.put(route("api.products.update",s.product.id),{preserveScroll:!0,onSuccess:()=>{w.success("Cập nhật sản phẩm thành công"),q("product-updated"),O.reload(),q("close")},onError:o=>{n.value=o,w.error("Có lỗi xảy ra khi cập nhật sản phẩm")}})}catch(o){console.error("Error updating product:",o),w.error("Có lỗi xảy ra khi cập nhật sản phẩm")}finally{k.value=!1}}};return x(()=>t.name,o=>g("name",o)),x(()=>t.category_id,o=>g("category_id",o)),x(()=>t.price,o=>g("price",o)),x(()=>t.quantity,o=>g("quantity",o)),G(()=>{var o;Object.keys(t).forEach(r=>{s.product[r]!==void 0&&(t[r]=s.product[r])}),(o=s.product)!=null&&o.price&&(b.value=V(s.product.price))}),(o,r)=>(m(),j(A,{modelValue:v.modelValue,"onUpdate:modelValue":r[14]||(r[14]=d=>o.$emit("update:modelValue")),title:"Chỉnh sửa sản phẩm",onSubmit:N,onCancel:r[15]||(r[15]=d=>o.$emit("close")),isLoading:k.value,hasButton:!1},{default:D(()=>[e("form",{onSubmit:H(N,["prevent"]),class:"space-y-6"},[e("div",K,[e("div",null,[r[16]||(r[16]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Tên sản phẩm *",-1)),l(e("input",{"onUpdate:modelValue":r[0]||(r[0]=d=>a(t).name=d),class:y(["mt-1 block w-full rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 dark:bg-dark-surface dark:text-dark-text dark:border-dark-border",n.value.name?"border-red-500":"border-gray-300 dark:border-dark-border"]),onBlur:r[1]||(r[1]=d=>g("name",a(t).name)),type:"text",required:""},null,34),[[u,a(t).name]]),n.value.name?(m(),p("span",Q,c(n.value.name),1)):f("",!0)]),e("div",null,[r[18]||(r[18]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Danh mục *",-1)),l(e("select",{"onUpdate:modelValue":r[2]||(r[2]=d=>a(t).category_id=d),class:y(["mt-1 block w-full rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 dark:bg-dark-surface dark:text-dark-text dark:border-dark-border",n.value.category_id?"border-red-500":"border-gray-300 dark:border-dark-border"]),required:""},[r[17]||(r[17]=e("option",{value:""},"Chọn danh mục",-1)),(m(!0),p(S,null,U(v.categories,d=>(m(),p("option",{key:d.id,value:d.id},c(d.category_name),9,R))),128))],2),[[I,a(t).category_id]]),n.value.category_id?(m(),p("span",W,c(n.value.category_id),1)):f("",!0)]),e("div",null,[r[19]||(r[19]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Giá *",-1)),l(e("input",{"onUpdate:modelValue":r[3]||(r[3]=d=>b.value=d),onInput:$,onBlur:E,type:"text",class:y(["mt-1 block w-full rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 dark:bg-dark-surface dark:text-dark-text dark:border-dark-border",n.value.price?"border-red-500":"border-gray-300 dark:border-dark-border"]),required:""},null,34),[[u,b.value]]),n.value.price?(m(),p("span",X,c(n.value.price),1)):f("",!0)]),e("div",null,[r[20]||(r[20]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Số lượng *",-1)),l(e("input",{"onUpdate:modelValue":r[4]||(r[4]=d=>a(t).quantity=d),type:"number",min:"0",class:y(["mt-1 block w-full rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 dark:bg-dark-surface dark:text-dark-text dark:border-dark-border",n.value.quantity?"border-red-500":"border-gray-300 dark:border-dark-border"]),required:""},null,2),[[u,a(t).quantity]]),n.value.quantity?(m(),p("span",Y,c(n.value.quantity),1)):f("",!0)])]),e("div",Z,[e("div",null,[r[21]||(r[21]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Mô tả thương hiệu",-1)),l(e("textarea",{"onUpdate:modelValue":r[5]||(r[5]=d=>a(t).brand_description=d),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-dark-border shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-dark-surface dark:text-dark-text"},null,512),[[u,a(t).brand_description]])]),e("div",null,[r[22]||(r[22]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Cách sử dụng",-1)),l(e("textarea",{"onUpdate:modelValue":r[6]||(r[6]=d=>a(t).usage=d),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-dark-border shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-dark-surface dark:text-dark-text"},null,512),[[u,a(t).usage]])]),e("div",null,[r[23]||(r[23]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Lợi ích",-1)),l(e("textarea",{"onUpdate:modelValue":r[7]||(r[7]=d=>a(t).benefits=d),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-dark-border shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-dark-surface dark:text-dark-text"},null,512),[[u,a(t).benefits]])]),e("div",null,[r[24]||(r[24]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Thành phần chính",-1)),l(e("textarea",{"onUpdate:modelValue":r[8]||(r[8]=d=>a(t).key_ingredients=d),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-dark-border shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-dark-surface dark:text-dark-text"},null,512),[[u,a(t).key_ingredients]])]),e("div",null,[r[25]||(r[25]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Thành phần đầy đủ",-1)),l(e("textarea",{"onUpdate:modelValue":r[9]||(r[9]=d=>a(t).ingredients=d),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-dark-border shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-dark-surface dark:text-dark-text"},null,512),[[u,a(t).ingredients]])]),e("div",null,[r[26]||(r[26]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Hướng dẫn sử dụng",-1)),l(e("textarea",{"onUpdate:modelValue":r[10]||(r[10]=d=>a(t).directions=d),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-dark-border shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-dark-surface dark:text-dark-text"},null,512),[[u,a(t).directions]])]),e("div",null,[r[27]||(r[27]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Hướng dẫn bảo quản",-1)),l(e("textarea",{"onUpdate:modelValue":r[11]||(r[11]=d=>a(t).storage_instructions=d),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-dark-border shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-dark-surface dark:text-dark-text"},null,512),[[u,a(t).storage_instructions]])]),e("div",null,[r[28]||(r[28]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Ghi chú sản phẩm",-1)),l(e("textarea",{"onUpdate:modelValue":r[12]||(r[12]=d=>a(t).product_notes=d),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-dark-border shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-dark-surface dark:text-dark-text"},null,512),[[u,a(t).product_notes]])])]),Object.keys(n.value).length>0?(m(),p("div",_,[r[29]||(r[29]=e("p",{class:"text-red-700 dark:text-red-400 font-medium"},"Vui lòng sửa các lỗi sau:",-1)),e("ul",rr,[(m(!0),p(S,null,U(n.value,(d,i)=>(m(),p("li",{key:i},c(d),1))),128))])])):f("",!0),e("div",er,[B(M,{type:"button",label:"Hủy",onClick:r[13]||(r[13]=d=>o.$emit("close"))}),B(M,{type:"submit",color:"info",label:"Cập nhật",loading:k.value,disabled:k.value},null,8,["loading","disabled"])])],32)]),_:1},8,["modelValue","isLoading"]))}},Pr=J(tr,[["__scopeId","data-v-0718aede"]]);export{Pr as default};
