import{r as h,e as f,o as G,aU as m,a0 as j,bH as D,a3 as t,bJ as l,bA as u,bl as a,j as y,a2 as p,bf as k,a1 as x,bz as I,b0 as U,F as S,aa as M,bM as H}from"./@vue-BRgAy5zV.js";import{T as L,F as O}from"./@inertiajs-D0DMCEQB.js";import{u as z}from"./vue-toastification-ejyjJRED.js";import{C as A}from"./CardBoxModal-1seWqIEz.js";import{_ as B}from"./BaseButton-eMTGofBM.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./axios-CCb-kr4I.js";import"./deepmerge-CtOfIP5S.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./@mdi-B9R4HCDS.js";import"./BaseButtons-B17KSMwc.js";import"./CardBox-jfYP3QDG.js";import"./OverlayLayer-BSs7OF78.js";import"./colors-S7_1wET5.js";import"./BaseIcon-B4kwkOCn.js";const K={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Q={key:0,class:"text-red-500 dark:text-red-400 text-sm"},R=["value"],W={key:0,class:"text-red-500 dark:text-red-400 text-sm"},X={key:0,class:"text-red-500 dark:text-red-400 text-sm"},Y={key:0,class:"text-red-500 dark:text-red-400 text-sm"},Z={class:"space-y-4"},_={key:0,class:"bg-red-50 dark:bg-red-900/20 p-4 rounded-md"},rr={class:"mt-2 text-sm text-red-600 dark:text-red-400"},er={class:"flex justify-end space-x-2"},tr={__name:"EditProductModal",props:{modelValue:{type:Boolean,required:!0},product:{type:Object,required:!0},categories:{type:Array,required:!0,default:()=>[]}},emits:["update:modelValue","close","product-updated"],setup(v,{emit:T}){var N;const n=v,q=T,w=z(),i=h({}),c=h(!1),V=d=>new Intl.NumberFormat("vi-VN").format(d),F=d=>Number(d.replace(/[^\d]/g,"")),b=h(""),e=L({name:n.product.name,category_id:n.product.category_id,price:((N=n.product)==null?void 0:N.price)||0,quantity:n.product.quantity,brand_description:n.product.brand_description||"",usage:n.product.usage||"",benefits:n.product.benefits||"",key_ingredients:n.product.key_ingredients||"",ingredients:n.product.ingredients||"",directions:n.product.directions||"",storage_instructions:n.product.storage_instructions||"",product_notes:n.product.product_notes||""}),$=d=>{const r=d.target.value.replace(/[^\d]/g,"");r?(b.value=V(r),e.price=F(b.value)):(b.value="",e.price=0)},E=()=>{e.price&&(b.value=V(e.price))},P=()=>{var r;i.value={};let d=!0;return(r=e.name)!=null&&r.trim()||(i.value.name="Tên sản phẩm là bắt buộc",d=!1),e.category_id||(i.value.category_id="Vui lòng chọn danh mục",d=!1),(!e.price||isNaN(Number(e.price))||Number(e.price)<=0)&&(i.value.price="Giá sản phẩm phải lớn hơn 0",d=!1),(!e.quantity||isNaN(Number(e.quantity))||Number(e.quantity)<0)&&(i.value.quantity="Số lượng không được âm",d=!1),d},g=(d,r)=>{const o={name:s=>s?s.length<3?"Tên sản phẩm phải có ít nhất 3 ký tự":null:"Tên sản phẩm là bắt buộc",category_id:s=>s?null:"Danh mục là bắt buộc",price:s=>s?isNaN(s)?"Giá phải là số":parseFloat(s)<=0?"Giá phải lớn hơn 0":null:"Giá là bắt buộc",quantity:s=>s?isNaN(s)?"Số lượng phải là số":parseInt(s)<0?"Số lượng không được âm":null:"Số lượng là bắt buộc"};if(o[d]){const s=o[d](r);return s?(i.value[d]=s,!1):(delete i.value[d],!0)}return!0},C=async()=>{if(!c.value&&P()){c.value=!0;try{e.put(route("api.products.update",n.product.id),{preserveScroll:!0,onSuccess:()=>{w.success("Cập nhật sản phẩm thành công"),q("product-updated"),O.reload(),q("close")},onError:d=>{i.value=d,w.error("Có lỗi xảy ra khi cập nhật sản phẩm")}})}catch(d){console.error("Error updating product:",d),w.error("Có lỗi xảy ra khi cập nhật sản phẩm")}finally{c.value=!1}}};return f(()=>e.name,d=>g("name",d)),f(()=>e.category_id,d=>g("category_id",d)),f(()=>e.price,d=>g("price",d)),f(()=>e.quantity,d=>g("quantity",d)),f(()=>n.categories,d=>{console.log("Categories changed:",d)},{immediate:!0}),G(()=>{var d;console.log("Modal mounted, categories:",n.categories),Object.keys(e).forEach(r=>{n.product[r]!==void 0&&(e[r]=n.product[r])}),n.product.category_id&&(e.category_id=n.product.category_id),(d=n.product)!=null&&d.price&&(b.value=V(n.product.price))}),(d,r)=>(m(),j(A,{modelValue:v.modelValue,"onUpdate:modelValue":r[14]||(r[14]=o=>d.$emit("update:modelValue")),title:"Chỉnh sửa sản phẩm",onSubmit:C,onCancel:r[15]||(r[15]=o=>d.$emit("close")),isLoading:c.value,hasButton:!1},{default:D(()=>[t("form",{onSubmit:H(C,["prevent"]),class:"space-y-6"},[t("div",K,[t("div",null,[r[16]||(r[16]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Tên sản phẩm *",-1)),l(t("input",{"onUpdate:modelValue":r[0]||(r[0]=o=>a(e).name=o),class:y(["mt-1 block w-full rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 dark:bg-dark-surface dark:text-dark-text dark:border-dark-border",i.value.name?"border-red-500":"border-gray-300 dark:border-dark-border"]),onBlur:r[1]||(r[1]=o=>g("name",a(e).name)),type:"text",required:""},null,34),[[u,a(e).name]]),i.value.name?(m(),p("span",Q,k(i.value.name),1)):x("",!0)]),t("div",null,[r[18]||(r[18]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Danh mục *",-1)),l(t("select",{"onUpdate:modelValue":r[2]||(r[2]=o=>a(e).category_id=o),class:y(["mt-1 block w-full rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 dark:bg-dark-surface dark:text-dark-text dark:border-dark-border",i.value.category_id?"border-red-500":"border-gray-300 dark:border-dark-border"]),required:""},[r[17]||(r[17]=t("option",{value:""},"Chọn danh mục",-1)),(m(!0),p(S,null,U(v.categories,o=>(m(),p("option",{key:o.id,value:o.id},k(o.category_name),9,R))),128))],2),[[I,a(e).category_id]]),i.value.category_id?(m(),p("span",W,k(i.value.category_id),1)):x("",!0)]),t("div",null,[r[19]||(r[19]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Giá *",-1)),l(t("input",{"onUpdate:modelValue":r[3]||(r[3]=o=>b.value=o),onInput:$,onBlur:E,type:"text",class:y(["mt-1 block w-full rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 dark:bg-dark-surface dark:text-dark-text dark:border-dark-border",i.value.price?"border-red-500":"border-gray-300 dark:border-dark-border"]),required:""},null,34),[[u,b.value]]),i.value.price?(m(),p("span",X,k(i.value.price),1)):x("",!0)]),t("div",null,[r[20]||(r[20]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Số lượng *",-1)),l(t("input",{"onUpdate:modelValue":r[4]||(r[4]=o=>a(e).quantity=o),type:"number",min:"0",class:y(["mt-1 block w-full rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 dark:bg-dark-surface dark:text-dark-text dark:border-dark-border",i.value.quantity?"border-red-500":"border-gray-300 dark:border-dark-border"]),required:""},null,2),[[u,a(e).quantity]]),i.value.quantity?(m(),p("span",Y,k(i.value.quantity),1)):x("",!0)])]),t("div",Z,[t("div",null,[r[21]||(r[21]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Mô tả thương hiệu",-1)),l(t("textarea",{"onUpdate:modelValue":r[5]||(r[5]=o=>a(e).brand_description=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-dark-border shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-dark-surface dark:text-dark-text"},null,512),[[u,a(e).brand_description]])]),t("div",null,[r[22]||(r[22]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Cách sử dụng",-1)),l(t("textarea",{"onUpdate:modelValue":r[6]||(r[6]=o=>a(e).usage=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-dark-border shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-dark-surface dark:text-dark-text"},null,512),[[u,a(e).usage]])]),t("div",null,[r[23]||(r[23]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Lợi ích",-1)),l(t("textarea",{"onUpdate:modelValue":r[7]||(r[7]=o=>a(e).benefits=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-dark-border shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-dark-surface dark:text-dark-text"},null,512),[[u,a(e).benefits]])]),t("div",null,[r[24]||(r[24]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Thành phần chính",-1)),l(t("textarea",{"onUpdate:modelValue":r[8]||(r[8]=o=>a(e).key_ingredients=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-dark-border shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-dark-surface dark:text-dark-text"},null,512),[[u,a(e).key_ingredients]])]),t("div",null,[r[25]||(r[25]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Thành phần đầy đủ",-1)),l(t("textarea",{"onUpdate:modelValue":r[9]||(r[9]=o=>a(e).ingredients=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-dark-border shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-dark-surface dark:text-dark-text"},null,512),[[u,a(e).ingredients]])]),t("div",null,[r[26]||(r[26]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Hướng dẫn sử dụng",-1)),l(t("textarea",{"onUpdate:modelValue":r[10]||(r[10]=o=>a(e).directions=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-dark-border shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-dark-surface dark:text-dark-text"},null,512),[[u,a(e).directions]])]),t("div",null,[r[27]||(r[27]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Hướng dẫn bảo quản",-1)),l(t("textarea",{"onUpdate:modelValue":r[11]||(r[11]=o=>a(e).storage_instructions=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-dark-border shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-dark-surface dark:text-dark-text"},null,512),[[u,a(e).storage_instructions]])]),t("div",null,[r[28]||(r[28]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-dark-text"},"Ghi chú sản phẩm",-1)),l(t("textarea",{"onUpdate:modelValue":r[12]||(r[12]=o=>a(e).product_notes=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-dark-border shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-dark-surface dark:text-dark-text"},null,512),[[u,a(e).product_notes]])])]),Object.keys(i.value).length>0?(m(),p("div",_,[r[29]||(r[29]=t("p",{class:"text-red-700 dark:text-red-400 font-medium"},"Vui lòng sửa các lỗi sau:",-1)),t("ul",rr,[(m(!0),p(S,null,U(i.value,(o,s)=>(m(),p("li",{key:s},k(o),1))),128))])])):x("",!0),t("div",er,[M(B,{type:"button",label:"Hủy",onClick:r[13]||(r[13]=o=>d.$emit("close"))}),M(B,{type:"submit",color:"info",label:"Cập nhật",loading:c.value,disabled:c.value},null,8,["loading","disabled"])])],32)]),_:1},8,["modelValue","isLoading"]))}},Pr=J(tr,[["__scopeId","data-v-8cd34f77"]]);export{Pr as default};
