import{Q as T,Z as A,F as S}from"./@inertiajs-D0DMCEQB.js";import{L as $}from"./LayoutAuthenticated-BAGAN5rv.js";import{_ as E}from"./SectionMain-Vot1TOkK.js";import{_ as F}from"./CardBox-jfYP3QDG.js";import{_ as x}from"./BaseButton-eMTGofBM.js";import{u as L}from"./app-B32MnJN1.js";import{ab as y,ac as M,ad as V,ae as D,B as H,af as j}from"./@mdi-D7koDRFv.js";import{_ as u}from"./BaseIcon-B4kwkOCn.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{p as P,a as K,v as Q}from"./date-fns-9vLFlIJ3.js";import{r as c,aU as s,a0 as k,bH as f,aa as i,bl as d,a3 as e,a1 as m,a2 as l,F as R,b0 as U,a9 as Z,bf as h}from"./@vue-BRgAy5zV.js";import"./axios-CCb-kr4I.js";import"./deepmerge-CtOfIP5S.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./colors-S7_1wET5.js";import"./OverlayLayer-BSs7OF78.js";import"./jspdf-Ciebq7We.js";import"./@babel-BsCcpEdk.js";import"./fflate-EnPhvkmS.js";import"./laravel-echo-C9ppFO4I.js";import"./pusher-js-Cl-1XqxI.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./pinia-BhnhDyRZ.js";import"./vue-toastification-ejyjJRED.js";import"./firebase-DL3QX-oU.js";import"./@firebase--zA4YiqN.js";import"./idb-Bn1DMRyg.js";const q={class:"flex justify-between items-center mb-6"},z={class:"flex items-center gap-2"},G={key:0,class:"text-center py-12"},J={key:1},W=["onClick"],X={class:"flex items-start gap-4"},Y={class:"flex-shrink-0"},tt={class:"flex-1 min-w-0"},at={class:"text-sm font-medium text-gray-900 dark:text-white mb-0.5"},et={key:0,class:"inline-block ml-2 w-2 h-2 bg-blue-500 rounded-full"},rt={class:"text-sm text-gray-500 dark:text-gray-400 line-clamp-2"},ot={class:"text-xs text-gray-400 dark:text-gray-500 mt-1"},st={key:0,class:"flex justify-center py-4"},it={key:1,class:"text-center py-4"},lt={__name:"Index",setup(nt){L();const _=T(),r=c(_.props.initialNotifications||[]),p=c(_.props.hasMore||!1),g=c(1),n=c(!1),b=c(!0),w=t=>{switch(t){case"new_order":return j;case"new_appointment":return H;case"new_review":return D;default:return y}},v=async()=>{if(!(!p.value||n.value))try{n.value=!0,g.value++;const t=await axios.get("/api/notifications",{params:{page:g.value}});t.data.data&&(r.value=[...r.value,...t.data.data],p.value=t.data.hasMore)}catch(t){console.error("Error loading more notifications:",t)}finally{n.value=!1}},N=t=>{const a=t.target;a.scrollHeight-a.scrollTop===a.clientHeight&&v()},C=async t=>{try{await axios.post(`/api/notifications/${t.id}/mark-as-read`),t.is_read=!0,t.url&&S.push(t.url)}catch(a){console.error("Error marking notification as read:",a)}},B=async()=>{try{await axios.post("/api/notifications/mark-all-as-read"),r.value=r.value.map(t=>({...t,is_read:!0}))}catch(t){console.error("Error marking all as read:",t)}},I=t=>{try{if(!t)return"Invalid date";const a=P(t);return isNaN(a.getTime())?"Invalid date":K(a,{addSuffix:!0,locale:Q})}catch(a){return console.error("Error formatting date:",a),"Invalid date"}};return(t,a)=>(s(),k($,null,{default:f(()=>[i(d(A),{title:"Thông báo"}),i(E,{"is-aside-lg-active":b.value},{default:f(()=>[i(F,{class:"mb-6"},{default:f(()=>[e("div",q,[e("div",z,[i(u,{path:d(y),class:"w-6 h-6 text-gray-500"},null,8,["path"]),a[0]||(a[0]=e("h1",{class:"text-2xl font-semibold"},"Thông báo",-1))]),r.value.length>0&&r.value.some(o=>!o.is_read)?(s(),k(x,{key:0,color:"info",onClick:B,icon:d(M),label:"Đánh dấu tất cả là đã đọc",class:"hover:shadow-lg transition-shadow"},null,8,["icon"])):m("",!0)]),e("div",{class:"space-y-3 overflow-y-auto max-h-[600px]",onScroll:N},[!r.value||r.value.length===0?(s(),l("div",G,[i(u,{path:d(V),class:"w-16 h-16 mx-auto text-gray-400 dark:text-gray-600 mb-4"},null,8,["path"]),a[1]||(a[1]=e("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"}," Không có thông báo nào ",-1)),a[2]||(a[2]=e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Bạn sẽ nhận được thông báo khi có cập nhật mới. ",-1))])):(s(),l("div",J,[(s(!0),l(R,null,U(r.value,o=>(s(),l("div",{key:o.id,onClick:ct=>C(o),class:"p-4 rounded-lg transition-all duration-200 hover:shadow-md cursor-pointer bg-white dark:bg-slate-800 border border-gray-100 dark:border-slate-700"},[e("div",X,[e("div",Y,[i(u,{path:w(o.type),class:"w-6 h-6 text-gray-400 dark:text-gray-500"},null,8,["path"])]),e("div",tt,[e("p",at,[Z(h(o.title)+" ",1),o.is_read?m("",!0):(s(),l("span",et))]),e("p",rt,h(o.content),1),e("p",ot,h(I(o.created_at)),1)])])],8,W))),128)),n.value?(s(),l("div",st,a[3]||(a[3]=[e("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"},null,-1)]))):m("",!0),p.value&&!n.value?(s(),l("div",it,[i(x,{color:"info",onClick:v,label:"Tải thêm",class:"hover:shadow-lg transition-shadow"})])):m("",!0)]))],32)]),_:1})]),_:1},8,["is-aside-lg-active"])]),_:1}))}},ta=O(lt,[["__scopeId","data-v-df746878"]]);export{ta as default};
