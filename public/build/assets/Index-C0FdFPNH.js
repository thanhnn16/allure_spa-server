import{r as u,aU as r,a2 as o,a3 as t,aa as n,bl as h,a1 as f,bf as d,F as I,b0 as T,j as V,bM as W,o as X,bH as b,bJ as Y,bz as tt,a0 as K,a9 as j}from"./@vue-BRgAy5zV.js";import{Z as et}from"./@inertiajs-D0DMCEQB.js";import{L as st}from"./LayoutAuthenticated-CjOz-Cuu.js";import{_ as at}from"./SectionMain-Vot1TOkK.js";import{_ as rt}from"./CardBox-jfYP3QDG.js";import{_ as ot}from"./BaseButtons-B17KSMwc.js";import{_ as U}from"./BaseButton-eMTGofBM.js";import{_ as lt}from"./FormControl-BSsARiYM.js";import{j as E,aF as nt,aG as it,v as H,a9 as dt,aH as ct}from"./@mdi-xfgXKVp3.js";import{_}from"./BaseIcon-B4kwkOCn.js";import{a as P}from"./axios-CCb-kr4I.js";import{u as ut}from"./vue-toastification-ejyjJRED.js";import{_ as mt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./deepmerge-CtOfIP5S.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./app-DbfKVLcM.js";import"./jspdf-Ciebq7We.js";import"./@babel-BsCcpEdk.js";import"./fflate-EnPhvkmS.js";import"./laravel-echo-C9ppFO4I.js";import"./pusher-js-Cl-1XqxI.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./pinia-BhnhDyRZ.js";import"./firebase-DL3QX-oU.js";import"./@firebase--zA4YiqN.js";import"./idb-Bn1DMRyg.js";import"./colors-S7_1wET5.js";import"./OverlayLayer-BSs7OF78.js";import"./main-BNmBi4-k.js";const pt={class:"relative max-w-4xl w-full mx-4"},gt={class:"relative bg-black rounded-lg overflow-hidden"},xt=["src","alt"],ht={class:"absolute bottom-4 left-1/2 -translate-x-1/2 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm"},ft={key:0,class:"flex justify-center mt-4 gap-2 overflow-x-auto pb-2"},vt=["onClick"],yt=["src","alt"],bt={__name:"ImageGalleryModal",props:{images:{type:Array,required:!0},initialIndex:{type:Number,default:0}},emits:["close"],setup(m,{emit:S}){const g=m,c=S,l=u(g.initialIndex),k=()=>{l.value=(l.value+1)%g.images.length},x=()=>{l.value=(l.value-1+g.images.length)%g.images.length},w=p=>{p.key==="ArrowRight"&&k(),p.key==="ArrowLeft"&&x(),p.key==="Escape"&&c("close")};return onMounted(()=>{document.addEventListener("keydown",w)}),onBeforeUnmount(()=>{document.removeEventListener("keydown",w)}),(p,v)=>(r(),o("div",{class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75",onClick:v[1]||(v[1]=W($=>p.$emit("close"),["self"]))},[t("div",pt,[t("button",{class:"absolute -top-12 right-0 text-white hover:text-gray-300 transition-colors",onClick:v[0]||(v[0]=$=>p.$emit("close"))},[n(_,{path:h(E),class:"w-8 h-8"},null,8,["path"])]),t("div",gt,[t("img",{src:m.images[l.value].url,class:"max-h-[80vh] w-full object-contain",alt:`Image ${l.value+1} of ${m.images.length}`},null,8,xt),m.images.length>1?(r(),o("button",{key:0,class:"absolute left-0 top-1/2 -translate-y-1/2 p-2 text-white hover:text-gray-300 bg-black bg-opacity-50 rounded-r transition-colors",onClick:x},[n(_,{path:h(nt),class:"w-8 h-8"},null,8,["path"])])):f("",!0),m.images.length>1?(r(),o("button",{key:1,class:"absolute right-0 top-1/2 -translate-y-1/2 p-2 text-white hover:text-gray-300 bg-black bg-opacity-50 rounded-l transition-colors",onClick:k},[n(_,{path:h(it),class:"w-8 h-8"},null,8,["path"])])):f("",!0),t("div",ht,d(l.value+1)+" / "+d(m.images.length),1)]),m.images.length>1?(r(),o("div",ft,[(r(!0),o(I,null,T(m.images,($,i)=>(r(),o("button",{key:i,class:V(["w-16 h-16 flex-shrink-0 rounded-lg overflow-hidden transition-transform hover:scale-105 focus:outline-none",{"ring-2 ring-blue-500":i===l.value}]),onClick:L=>l.value=i},[t("img",{src:$.url,class:"w-full h-full object-cover",alt:`Thumbnail ${i+1}`},null,8,yt)],10,vt))),128))])):f("",!0)])]))}},_t={class:"flex flex-col md:flex-row justify-between items-center mb-6"},kt={class:"flex items-center space-x-2"},wt={key:0,class:"animate-spin"},$t={class:"flex flex-col md:flex-row gap-4 mt-4 md:mt-0 w-full md:w-auto"},Ct={class:"relative"},jt={class:"overflow-x-auto rounded-lg border dark:border-slate-700"},It={class:"w-full"},St={class:"bg-white dark:bg-slate-900 divide-y dark:divide-slate-700"},Tt={class:"px-6 py-4"},Vt={class:"flex items-center"},Lt={class:"flex-shrink-0 h-10 w-10"},Dt=["src","alt"],Et={class:"ml-4"},Nt={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},Mt={class:"text-xs text-gray-500 dark:text-gray-400"},Bt={class:"px-6 py-4 text-center"},Rt={class:"px-6 py-4"},At={class:"text-sm text-gray-900 dark:text-gray-100 font-medium"},zt={class:"px-6 py-4"},Ft={class:"flex justify-center space-x-1"},Gt={class:"px-6 py-4"},Kt={class:"space-y-2"},Ut={class:"text-sm text-gray-700 dark:text-gray-300"},Ht={key:0,class:"flex items-center gap-2"},Pt={class:"flex -space-x-2"},Qt=["onClick"],qt=["src","alt"],Jt=["onClick"],Ot={class:"px-6 py-4 text-center"},Zt={class:"text-sm text-gray-500 dark:text-gray-400"},Wt={class:"px-6 py-4"},Xt={class:"flex justify-center"},Yt={key:0,class:"flex items-center space-x-2"},te=["onClick"],ee=["onClick"],se={key:1,class:"flex items-center"},ae={class:"flex justify-between items-center mt-6"},re={class:"text-sm text-gray-700 dark:text-gray-300"},oe={__name:"Index",setup(m){const S=u([]),g=u(!1),c=u(1),l=u(1),k=u(""),x=u(""),w=u(!1),p=u([]),v=u(0),$=ut(),i=async()=>{var a;g.value=!0;try{const e=await P.get("/api/ratings",{params:{page:c.value,status:k.value,search:x.value}});console.log("Rating response:",e.data),console.log("First rating media:",(a=e.data.data.data[0])==null?void 0:a.media_urls),S.value=e.data.data.data,l.value=e.data.data.last_page}catch(e){console.error("Error fetching ratings:",e),D("Không thể tải danh sách đánh giá","danger")}g.value=!1},L=async(a,e)=>{try{await P.patch(`/api/ratings/${a}/status`,{status:e}),D("Cập nhật trạng thái thành công","success"),await i()}catch(s){console.error("Error updating rating status:",s),D("Không thể cập nhật trạng thái","danger")}},D=(a,e="success")=>{$[e](a)},Q=a=>Array(5).fill().map((e,s)=>s<a?dt:ct),q=a=>new Date(a).toLocaleDateString("vi-VN"),J=a=>a==="product"?"SP":"DV",O=a=>({pending:"Chờ duyệt",approved:"Đã duyệt",rejected:"Đã từ chối"})[a]||a,N=(a,e=0)=>{p.value=a,v.value=e,w.value=!0},Z=a=>{a.target.src="/path/to/fallback/image.jpg"};return X(()=>{i()}),(a,e)=>(r(),o(I,null,[n(st,null,{default:b(()=>[n(h(et),{title:"Quản lý đánh giá"}),n(at,null,{default:b(()=>[n(rt,{class:"mb-6"},{default:b(()=>[t("div",_t,[t("div",kt,[e[6]||(e[6]=t("h1",{class:"text-2xl font-bold dark:text-gray-100"},"Quản lý đánh giá",-1)),g.value?(r(),o("span",wt,"⌛")):f("",!0)]),t("div",$t,[t("div",Ct,[n(lt,{modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=s=>x.value=s),placeholder:"Tìm kiếm theo tên khách hàng...",class:"min-w-[250px] dark:bg-slate-800 dark:border-slate-700 dark:text-gray-100",onInput:i},{rightIcon:b(()=>[x.value?(r(),o("span",{key:0,class:"cursor-pointer text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",onClick:e[0]||(e[0]=s=>{x.value="",i()})}," ✕ ")):f("",!0)]),_:1},8,["modelValue"])]),Y(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>k.value=s),class:"rounded-lg border-gray-300 dark:bg-slate-800 dark:border-slate-700 dark:text-gray-100 focus:border-blue-500 focus:ring-blue-500 transition-colors duration-150",onChange:i},e[7]||(e[7]=[t("option",{value:""},"Tất cả",-1),t("option",{value:"pending"},"Chờ duyệt",-1),t("option",{value:"approved"},"Đã duyệt",-1),t("option",{value:"rejected"},"Đã từ chối",-1)]),544),[[tt,k.value]])])]),t("div",jt,[t("table",It,[e[10]||(e[10]=t("thead",null,[t("tr",{class:"bg-gray-50 dark:bg-slate-800 border-b dark:border-slate-700"},[t("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Khách hàng "),t("th",{class:"px-6 py-4 text-center text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider w-20"}," Loại "),t("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Sản phẩm/Dịch vụ "),t("th",{class:"px-6 py-4 text-center text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider w-32"}," Đánh giá "),t("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Bình luận & Hình ảnh "),t("th",{class:"px-6 py-4 text-center text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider w-32"}," Ngày tạo "),t("th",{class:"px-6 py-4 text-center text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider w-32"}," Trạng thái ")])],-1)),t("tbody",St,[(r(!0),o(I,null,T(S.value,s=>{var M,B,R,A,z,F,G;return r(),o("tr",{key:s.id,class:"hover:bg-gray-50 dark:hover:bg-slate-800 transition-colors duration-150"},[t("td",Tt,[t("div",Vt,[t("div",Lt,[t("img",{class:"h-10 w-10 rounded-full object-cover border-2 border-gray-200 dark:border-gray-700",src:((M=s.user)==null?void 0:M.avatar_url)||"/path/to/default/avatar.png",alt:(B=s.user)==null?void 0:B.name},null,8,Dt)]),t("div",Et,[t("div",Nt,d((R=s.user)==null?void 0:R.name),1),t("div",Mt,d((A=s.user)==null?void 0:A.email),1)])])]),t("td",Bt,[t("span",{class:V(["px-3 py-1 text-xs font-medium rounded-full",s.rating_type==="product"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200"])},d(J(s.rating_type)),3)]),t("td",Rt,[t("div",At,d(((z=s.item)==null?void 0:z.name)||((F=s.item)==null?void 0:F.service_name)),1)]),t("td",zt,[t("div",Ft,[(r(!0),o(I,null,T(Q(s.stars),(y,C)=>(r(),K(_,{key:C,path:y,class:V(["w-5 h-5",C<s.stars?"text-yellow-400":"text-gray-300 dark:text-gray-600"])},null,8,["path","class"]))),128))])]),t("td",Gt,[t("div",Kt,[t("div",Ut,d(s.comment),1),(G=s.media_urls)!=null&&G.length?(r(),o("div",Ht,[t("div",Pt,[(r(!0),o(I,null,T(s.media_urls.slice(0,3),(y,C)=>(r(),o("div",{key:y.id,class:"relative cursor-pointer",onClick:le=>N(s.media_urls,C)},[t("img",{src:y.url,class:"w-12 h-12 object-cover rounded-lg border-2 border-white dark:border-slate-800 hover:scale-110 hover:z-10 transition-transform duration-200",alt:`Ảnh đánh giá ${C+1}`,onError:Z},null,40,qt)],8,Qt))),128))]),s.media_urls.length>3?(r(),o("span",{key:0,class:"text-xs text-blue-500 hover:text-blue-600 dark:text-blue-400 cursor-pointer",onClick:y=>N(s.media_urls,3)}," +"+d(s.media_urls.length-3),9,Jt)):f("",!0)])):f("",!0)])]),t("td",Ot,[t("span",Zt,d(q(s.created_at)),1)]),t("td",Wt,[t("div",Xt,[s.status==="pending"?(r(),o("div",Yt,[t("button",{onClick:y=>L(s.id,"approved"),class:"inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded-full shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-all duration-200 ease-in-out transform hover:scale-105"},[n(_,{path:h(H),class:"w-4 h-4 mr-1"},null,8,["path"]),e[8]||(e[8]=j(" Duyệt "))],8,te),t("button",{onClick:y=>L(s.id,"rejected"),class:"inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded-full shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-all duration-200 ease-in-out transform hover:scale-105"},[n(_,{path:h(E),class:"w-4 h-4 mr-1"},null,8,["path"]),e[9]||(e[9]=j(" Từ chối "))],8,ee)])):(r(),o("div",se,[t("span",{class:V(["inline-flex items-center px-3 py-1.5 rounded-full text-xs font-medium",{"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":s.status==="approved","bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":s.status==="rejected"}])},[n(_,{path:s.status==="approved"?h(H):h(E),class:"w-4 h-4 mr-1.5"},null,8,["path"]),j(" "+d(O(s.status)),1)],2)]))])])])}),128))])])]),t("div",ae,[t("div",re," Trang "+d(c.value)+" / "+d(l.value),1),n(ot,null,{default:b(()=>[n(U,{disabled:c.value===1,onClick:e[3]||(e[3]=s=>{c.value--,i()}),color:c.value===1?"light":"info",class:"transition-all duration-200"},{default:b(()=>e[11]||(e[11]=[j(" Trước ")])),_:1},8,["disabled","color"]),n(U,{disabled:c.value===l.value,onClick:e[4]||(e[4]=s=>{c.value++,i()}),color:c.value===l.value?"light":"info",class:"transition-all duration-200"},{default:b(()=>e[12]||(e[12]=[j(" Sau ")])),_:1},8,["disabled","color"])]),_:1})])]),_:1})]),_:1})]),_:1}),w.value?(r(),K(bt,{key:0,images:p.value,"initial-index":v.value,onClose:e[5]||(e[5]=s=>w.value=!1)},null,8,["images","initial-index"])):f("",!0)],64))}},Ye=mt(oe,[["__scopeId","data-v-bc3dddc8"]]);export{Ye as default};
