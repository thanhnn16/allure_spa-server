import{r as u,e as oe,c as $,o as se,aU as o,a0 as p,bH as m,aa as n,bl as a,a9 as Q,bf as g,a1 as i,a3 as t,a2 as b,bJ as f,bw as ne,bz as y,bA as z,b0 as ie,F as de}from"./@vue-BRgAy5zV.js";import{D as ue,E as pe,F as me,G as ce,H as ge,s as fe,I as ve}from"./@mdi-B8rJ_oIP.js";import{_ as be}from"./SectionMain-BbIPmLtw.js";import{_ as B}from"./NotificationBar-DBjprjlK.js";import{_ as J}from"./CardBox-jfYP3QDG.js";import{L as ke}from"./LayoutAuthenticated-Cd8PTZEA.js";import{_ as he}from"./SectionTitleLineWithButton-BVtQ-EX-.js";import{_ as c}from"./BaseButton-eMTGofBM.js";import{T as ye,Q as _e,Z as xe,F as N}from"./@inertiajs-D0DMCEQB.js";import we from"./AddCustomerModal-DJTPo74p.js";import{u as Ce}from"./main-BNmBi4-k.js";import{s as Ve}from"./pinia-BhnhDyRZ.js";import{_ as Te}from"./TablePagination-BLryTwgf.js";import Ue from"./ImportCustomersModal-42RQQEYw.js";import Se from"./CustomerTable-BSsvDlI5.js";import"./colors-S7_1wET5.js";import"./BaseLevel-vqqndN8O.js";import"./BaseIcon-B4kwkOCn.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./app-DKJdTd9O.js";import"./jspdf-Ciebq7We.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./@babel-BsCcpEdk.js";import"./fflate-EnPhvkmS.js";import"./axios-CCb-kr4I.js";import"./laravel-echo-C9ppFO4I.js";import"./pusher-js-Cl-1XqxI.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./vue-toastification-ejyjJRED.js";import"./firebase-DL3QX-oU.js";import"./@firebase--zA4YiqN.js";import"./idb-Bn1DMRyg.js";import"./deepmerge-CtOfIP5S.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./OverlayLayer-BSs7OF78.js";import"./CardBoxModal-WWcFA8_N.js";import"./BaseButtons-B17KSMwc.js";import"./UserAvatar-B0ECbD5d.js";const $e={class:"flex items-center justify-between mb-3"},Be={class:"flex items-center space-x-4"},Ne={key:0},Fe={class:"mb-4"},Ae={class:"inline-flex items-center cursor-pointer"},Ee={class:"grid grid-cols-2 gap-4 mb-4"},De={class:"mb-4"},Me={class:"mt-4"},Ie={key:1,class:"text-center py-5 dark:text-slate-300"},Xe={key:1,class:"mt-6"},He={class:"dark:text-slate-300"},Le={key:0},je={key:0,class:"mb-4 dark:text-slate-300"},Pe={class:"list-disc list-inside dark:text-slate-300"},Gt={__name:"CustomersView",props:{users:Object,filters:Object,upcomingBirthdays:Number},setup(R){var M,I,X,H,L,j,P,G,K;const C=Ce();Ve(C);const s=R,_=u(((M=s.filters)==null?void 0:M.upcoming_birthdays)||!1),x=u(((I=s.filters)==null?void 0:I.show_deleted)||!1),w=u(!1),l=ye({search:((X=s.filters)==null?void 0:X.search)||"",per_page:((H=s.filters)==null?void 0:H.per_page)||10,upcoming_birthdays:_.value,show_deleted:x.value,gender:((L=s.filters)==null?void 0:L.gender)||"",age_range:((j=s.filters)==null?void 0:j.age_range)||"",loyalty_points_range:((P=s.filters)==null?void 0:P.loyalty_points_range)||"",purchase_count_range:((G=s.filters)==null?void 0:G.purchase_count_range)||"",created_at_range:((K=s.filters)==null?void 0:K.created_at_range)||""}),F=u(null);oe(()=>l.search,v=>{clearTimeout(F.value),F.value=setTimeout(()=>{N.get(route("users.index"),{search:l.search,per_page:l.per_page},{preserveState:!0})},300)});const Z=()=>{N.get(route("users.index"),{search:l.search,per_page:l.per_page},{preserveState:!0})},A=$(()=>{var v,e;return((e=(v=s.users)==null?void 0:v.data)==null?void 0:e.length)>0}),q=$(()=>{var v;return((v=s.users)==null?void 0:v.data)||[]}),V=u(!1),W=()=>{C.fetchUsers()},E=()=>{l.upcoming_birthdays=!l.upcoming_birthdays,_.value=l.upcoming_birthdays,T()},Y=()=>{l.show_deleted=!l.show_deleted,x.value=l.show_deleted,T()},ee=()=>{w.value=!w.value},T=()=>{N.get(route("users.index"),l,{preserveState:!0})},te=()=>{l.gender="",l.age_range="",l.loyalty_points_range="",l.purchase_count_range="",l.created_at_range="",T()},le=$(()=>_.value?"Bạn đang xem các khách hàng có sinh nhật trong 15 ngày tới":`Có ${s.upcomingBirthdays} khách hàng có sinh nhật trong 15 ngày tới`),U=u(!1),re=()=>{C.fetchUsers()},k=_e(),h=u(!1),S=u(!1),D=u([]),d=u(null);return se(()=>{k.props.flash.importErrors&&(h.value=!0,D.value=k.props.flash.importErrors,d.value=k.props.flash.importStats),k.props.flash.importSuccess&&(S.value=!0,d.value=k.props.flash.importStats)}),(v,e)=>(o(),p(ke,null,{default:m(()=>[n(a(xe),{title:"Quản lý khách hàng"}),n(be,null,{default:m(()=>{var O;return[n(he,{icon:a(ue),title:"Danh sách khách hàng",main:""},{default:m(()=>[n(c,{icon:a(pe),label:"Thêm khách hàng mới","rounded-full":"",small:"",onClick:e[0]||(e[0]=r=>V.value=!0)},null,8,["icon"]),n(c,{icon:a(me),label:"Nhập từ Excel","rounded-full":"",small:"",onClick:e[1]||(e[1]=r=>U.value=!0)},null,8,["icon"])]),_:1},8,["icon"]),s.upcomingBirthdays>0?(o(),p(B,{key:0,color:"info",icon:a(ce)},{default:m(()=>[Q(g(le.value)+" ",1),_.value?(o(),p(c,{key:1,label:"Hiển thị tất cả",small:"",onClick:E})):(o(),p(c,{key:0,label:"Xem ngay",small:"",onClick:E}))]),_:1},8,["icon"])):i("",!0),n(J,{class:"mb-6 px-4 py-4 dark:bg-slate-900","has-table":""},{default:m(()=>[t("div",$e,[t("div",Be,[n(c,{icon:a(ge),label:"Bộ lọc",onClick:ee},null,8,["icon"]),w.value?(o(),p(c,{key:0,label:"Đặt lại bộ lọc",onClick:te})):i("",!0)])]),w.value?(o(),b("div",Ne,[t("div",Fe,[t("label",Ae,[f(t("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=r=>x.value=r),onChange:Y,class:"sr-only peer"},null,544),[[ne,x.value]]),e[15]||(e[15]=t("div",{class:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-slate-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-slate-600 peer-checked:bg-blue-600"},null,-1)),e[16]||(e[16]=t("span",{class:"ml-3 text-sm font-medium text-gray-900 dark:text-slate-300"}," Hiển thị người dùng đã xóa ",-1))])]),t("div",Ee,[t("div",null,[e[18]||(e[18]=t("label",{class:"block mb-2 dark:text-slate-300"},"Giới tính",-1)),f(t("select",{"onUpdate:modelValue":e[3]||(e[3]=r=>a(l).gender=r),class:"w-full px-4 py-2 border rounded-md dark:bg-slate-800 dark:border-slate-700 dark:text-slate-300"},e[17]||(e[17]=[t("option",{value:""},"Tất cả",-1),t("option",{value:"male"},"Nam",-1),t("option",{value:"female"},"Nữ",-1),t("option",{value:"other"},"Khác",-1)]),512),[[y,a(l).gender]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block mb-2 dark:text-slate-300"},"Độ tuổi",-1)),f(t("select",{"onUpdate:modelValue":e[4]||(e[4]=r=>a(l).age_range=r),class:"w-full px-4 py-2 border rounded-md dark:bg-slate-800 dark:border-slate-700 dark:text-slate-300"},e[19]||(e[19]=[t("option",{value:""},"Tất cả",-1),t("option",{value:"0-18"},"0-18",-1),t("option",{value:"19-30"},"19-30",-1),t("option",{value:"31-50"},"31-50",-1),t("option",{value:"51-100"},"51+",-1)]),512),[[y,a(l).age_range]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block mb-2 dark:text-slate-300"},"Điểm tích lũy",-1)),f(t("select",{"onUpdate:modelValue":e[5]||(e[5]=r=>a(l).loyalty_points_range=r),class:"w-full px-4 py-2 border rounded-md dark:bg-slate-800 dark:border-slate-700 dark:text-slate-300"},e[21]||(e[21]=[t("option",{value:""},"Tất cả",-1),t("option",{value:"0-100"},"0-100",-1),t("option",{value:"101-500"},"101-500",-1),t("option",{value:"501-1000"},"501-1000",-1),t("option",{value:"1001-10000"},"1001+",-1)]),512),[[y,a(l).loyalty_points_range]])]),t("div",null,[e[24]||(e[24]=t("label",{class:"block mb-2 dark:text-slate-300"},"Số lần mua hàng",-1)),f(t("select",{"onUpdate:modelValue":e[6]||(e[6]=r=>a(l).purchase_count_range=r),class:"w-full px-4 py-2 border rounded-md dark:bg-slate-800 dark:border-slate-700 dark:text-slate-300"},e[23]||(e[23]=[t("option",{value:""},"Tất cả",-1),t("option",{value:"0-1"},"0-1",-1),t("option",{value:"2-5"},"2-5",-1),t("option",{value:"6-10"},"6-10",-1),t("option",{value:"11-100"},"11+",-1)]),512),[[y,a(l).purchase_count_range]])])]),t("div",De,[e[25]||(e[25]=t("label",{class:"block mb-2 dark:text-slate-300"},"Ngày tạo tài khoản",-1)),f(t("input",{type:"date","onUpdate:modelValue":e[7]||(e[7]=r=>a(l).created_at_range=r),class:"w-full px-4 py-2 border rounded-md dark:bg-slate-800 dark:border-slate-700 dark:text-slate-300"},null,512),[[z,a(l).created_at_range]])])])):i("",!0),t("div",Me,[f(t("input",{"onUpdate:modelValue":e[8]||(e[8]=r=>a(l).search=r),type:"text",placeholder:"Tìm kiếm theo tên hoặc số điện thoại",class:"w-full px-4 py-2 mb-4 border rounded-md dark:bg-slate-800 dark:border-slate-700 dark:text-slate-300 placeholder:dark:text-slate-500"},null,512),[[z,a(l).search]]),f(t("select",{"onUpdate:modelValue":e[9]||(e[9]=r=>a(l).per_page=r),onChange:Z,class:"px-10 py-2 border rounded-md dark:bg-slate-800 dark:border-slate-700 dark:text-slate-300"},e[26]||(e[26]=[t("option",{value:10},"Xem 10 mỗi trang",-1),t("option",{value:25},"Xem 25 mỗi trang",-1),t("option",{value:50},"Xem 50 mỗi trang",-1)]),544),[[y,a(l).per_page]])]),A.value?i("",!0):(o(),b("div",Ie,e[27]||(e[27]=[t("p",null,"Không có khách hàng",-1)]))),A.value?(o(),p(Se,{key:2,items:q.value,checkable:!0},null,8,["items"])):i("",!0)]),_:1}),(O=s.users)!=null&&O.links?(o(),b("div",Xe,[n(Te,{links:s.users.links},null,8,["links"])])):i("",!0),n(we,{modelValue:V.value,"onUpdate:modelValue":e[10]||(e[10]=r=>V.value=r),onCustomerAdded:W},null,8,["modelValue"]),n(Ue,{modelValue:U.value,"onUpdate:modelValue":e[11]||(e[11]=r=>U.value=r),onImported:re},null,8,["modelValue"]),S.value?(o(),p(B,{key:2,color:"success",icon:a(fe)},{default:m(()=>[t("div",He,[e[28]||(e[28]=Q(" Nhập từ Excel thành công ")),d.value?(o(),b("div",Le," Tổng số: "+g(d.value.total)+", Thành công: "+g(d.value.successful)+", Thất bại: "+g(d.value.failed),1)):i("",!0)]),n(c,{label:"Đóng",small:"",onClick:e[12]||(e[12]=r=>S.value=!1)})]),_:1},8,["icon"])):i("",!0),h.value?(o(),p(B,{key:3,color:"danger",icon:a(ve)},{default:m(()=>[e[29]||(e[29]=t("div",{class:"dark:text-slate-300"}," Có lỗi xảy ra khi nhập dữ liệu ",-1)),n(c,{label:"Xem chi tiết",small:"",onClick:e[13]||(e[13]=r=>h.value=!0)})]),_:1},8,["icon"])):i("",!0),h.value?(o(),p(J,{key:4,title:"Lỗi nhập dữ liệu","is-modal":"",class:"dark:bg-slate-900"},{footer:m(()=>[n(c,{label:"Đóng",color:"info",onClick:e[14]||(e[14]=r=>h.value=!1)})]),default:m(()=>[d.value?(o(),b("div",je,[t("p",null,"Tổng số dòng: "+g(d.value.total),1),t("p",null,"Số dòng thành công: "+g(d.value.successful),1),t("p",null,"Số dòng thất bại: "+g(d.value.failed),1)])):i("",!0),t("ul",Pe,[(o(!0),b(de,null,ie(D.value,(r,ae)=>(o(),b("li",{key:ae,class:"mb-2"},g(r),1))),128))])]),_:1})):i("",!0)]}),_:1})]),_:1}))}};export{Gt as default};
