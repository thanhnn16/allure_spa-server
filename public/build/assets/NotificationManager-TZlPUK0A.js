import{T,Z as G}from"./@inertiajs-D0DMCEQB.js";import{_ as N}from"./SectionMain-Vot1TOkK.js";import{L as j}from"./LayoutAuthenticated-Cg0aCPtS.js";import{a6 as M,a7 as Q,a8 as H,j as V,b as q}from"./@mdi-ArhfA4cU.js";import{_ as p}from"./BaseButton-eMTGofBM.js";import{_ as E}from"./BaseButtons-B17KSMwc.js";import{_ as v}from"./CardBox-jfYP3QDG.js";import{a as w}from"./axios-CCb-kr4I.js";import I from"./NotificationList-DaLhp5Z5.js";import K from"./UserGroups-BSZibvNY.js";import{r,e as c,o as P,aU as a,a0 as y,bH as i,aa as e,bl as u,a3 as d,a2 as g,a1 as _}from"./@vue-BRgAy5zV.js";import"./deepmerge-CtOfIP5S.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./app-C7XN5cFx.js";import"./jspdf-Ciebq7We.js";import"./@babel-BsCcpEdk.js";import"./fflate-EnPhvkmS.js";import"./laravel-echo-C9ppFO4I.js";import"./pusher-js-Cl-1XqxI.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./pinia-BhnhDyRZ.js";import"./vue-toastification-ejyjJRED.js";import"./firebase-DL3QX-oU.js";import"./@firebase--zA4YiqN.js";import"./idb-Bn1DMRyg.js";import"./BaseIcon-B4kwkOCn.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./colors-S7_1wET5.js";import"./OverlayLayer-BSs7OF78.js";import"./FormField-Da_P6kO8.js";import"./FormControl-BSsARiYM.js";import"./main-BNmBi4-k.js";import"./chart.js-B5vlqDTT.js";import"./@kurkle-BZxJdD1U.js";import"./CardBoxModal-CC98zKJS.js";const Z={class:"mb-6"},z={key:0,class:"transition-opacity duration-500"},D={class:"max-w-3xl mx-auto"},J={class:"flex items-center justify-between mb-6"},O={key:0,class:"space-y-6"},R={key:1,class:"transition-opacity duration-500"},S={key:2,class:"transition-opacity duration-500"},Wo={__name:"NotificationManager",setup(W){const f=T({title:"",content:"",type:"system",target_users:"all",user_ids:[],group_id:null,translations:{vi:{title:"",content:""},ja:{title:"",content:""}}}),l=r([]),b=r([]),h=r(""),n=r([]),k=r(!1);r(!1);const $=r(""),L=r([]),C=r(null),s=r("campaign"),m=r(!1),A=()=>{if(!h.value){n.value=l.value;return}const o=h.value.toLowerCase();n.value=l.value.filter(t=>t.full_name.toLowerCase().includes(o)||t.phone_number.includes(o))};c(h,()=>{A()});const B=async()=>{k.value=!0;try{const o=await w.get("/api/users");console.log("Users fetched:",o.data),o.data&&Array.isArray(o.data.data)?(l.value=o.data.data,n.value=[...l.value],console.log("Users array:",l.value),console.log("FilteredUsers array:",n.value)):console.error("Invalid response format:",o.data)}catch(o){console.error("Lỗi khi tải danh sách người dùng:",o),$.value="Không thể tải danh sách người dùng"}finally{k.value=!1}},F=async()=>{try{const o=await w.get("/api/user-groups");L.value=o.data}catch(o){console.error("Lỗi khi tải nhóm:",o)}};c(b,o=>{Array.isArray(o)&&(f.user_ids=o)},{deep:!0}),c(C,o=>{f.group_id=o},{deep:!0}),P(()=>{B(),F()}),c(()=>f.target_users,o=>{console.log("Target users changed:",o)},{immediate:!0}),c(l,o=>{console.log("Users updated:",o),console.log("Current filteredUsers:",n.value)},{deep:!0}),c(n,o=>{console.log("FilteredUsers updated:",o)},{deep:!0});const U=()=>{m.value=!m.value,m.value||(f.reset(),b.value=[],C.value=null)};return(o,t)=>(a(),y(j,null,{default:i(()=>[e(u(G),{title:"Quản lý thông báo"}),e(N,null,{default:i(()=>[d("div",Z,[e(E,null,{default:i(()=>[e(p,{color:s.value==="campaign"?"info":"light",onClick:t[0]||(t[0]=x=>s.value="campaign"),label:"Chiến dịch thông báo",icon:u(M),class:"transition-colors duration-300"},null,8,["color","icon"]),e(p,{color:s.value==="history"?"info":"light",onClick:t[1]||(t[1]=x=>s.value="history"),label:"Lịch sử thông báo",icon:u(Q),class:"transition-colors duration-300"},null,8,["color","icon"]),e(p,{color:s.value==="groups"?"info":"light",onClick:t[2]||(t[2]=x=>s.value="groups"),label:"Quản lý nhóm",icon:u(H),class:"transition-colors duration-300"},null,8,["color","icon"])]),_:1})]),s.value==="campaign"?(a(),g("div",z,[e(v,{class:"mb-6"},{default:i(()=>[d("div",D,[d("div",J,[t[3]||(t[3]=d("h2",{class:"text-2xl font-bold"},"Tạo chiến dịch thông báo mới",-1)),m.value?(a(),y(p,{key:0,color:"danger",icon:u(V),onClick:U,small:""},null,8,["icon"])):(a(),y(p,{key:1,color:"info",icon:u(q),label:"Tạo mới",onClick:U},null,8,["icon"]))]),m.value?(a(),g("div",O)):_("",!0)])]),_:1}),e(v,{class:"mb-6"},{default:i(()=>t[4]||(t[4]=[d("div",{class:"overflow-x-auto"},null,-1)])),_:1})])):_("",!0),s.value==="history"?(a(),g("div",R,[e(v,null,{default:i(()=>[e(I)]),_:1})])):_("",!0),s.value==="groups"?(a(),g("div",S,[e(v,null,{default:i(()=>[e(K)]),_:1})])):_("",!0)]),_:1})]),_:1}))}};export{Wo as default};
