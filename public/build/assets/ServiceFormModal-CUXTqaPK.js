import{r as h,c as j,o as $,aU as a,a0 as z,bH as A,a3 as t,bJ as c,bA as f,bl as o,a2 as n,bf as m,a1 as u,bz as N,b0 as M,F as U,bM as q,aa as F}from"./@vue-BRgAy5zV.js";import{T as P}from"./@inertiajs-D0DMCEQB.js";import{C as H}from"./CardBoxModal-Lj_lwZN_.js";import{_ as T}from"./BaseIcon-B4kwkOCn.js";import{u as J}from"./vue-toastification-ejyjJRED.js";import{j as L,b as O}from"./@mdi-DWfqH7fj.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./axios-CCb-kr4I.js";import"./deepmerge-CtOfIP5S.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./BaseButton-eMTGofBM.js";import"./colors-S7_1wET5.js";import"./BaseButtons-B17KSMwc.js";import"./CardBox-jfYP3QDG.js";import"./OverlayLayer-BSs7OF78.js";const K={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},W={key:0,class:"form-error"},Q=["value"],X={key:0,class:"form-error"},Y={key:0,class:"form-error"},Z={key:0,class:"form-error"},ee={key:0,class:"form-error"},re={key:0,class:"form-error"},oe={key:0,class:"form-error"},te={key:0,class:"py-2"},ie={class:"flex flex-wrap gap-4 mb-4"},se=["src"],le=["onClick"],ae={key:0,class:"text-red-500 text-sm"},ne={key:0,class:"form-error"},de={__name:"ServiceFormModal",props:{modelValue:Boolean,service:{type:Object,default:null},categories:{type:Array,default:()=>[]}},emits:["update:modelValue","close","service-saved"],setup(x,{emit:B}){const g=J(),k=h(null),_=h([]),b=h([]),s=x,y=B,p=j(()=>!!s.service),e=P({service_name:"",description:"",duration:0,category_id:"",single_price:0,combo_5_price:0,combo_10_price:0,validity_period:0,images:[]}),E=()=>{k.value.click()},D=l=>{const r=Array.from(l.target.files);if(b.value.length+r.length>10){g.error("Không được upload quá 10 ảnh");return}r.forEach(v=>{if(v.size>2*1024*1024){g.error(`File ${v.name} vượt quá 2MB`);return}const w=new FileReader;w.onload=G=>{_.value.push(G.target.result)},w.readAsDataURL(v),b.value.push(v)}),e.images=b.value},I=l=>{_.value.splice(l,1),b.value.splice(l,1),e.images=b.value};$(async()=>{s.service&&(e.service_name=s.service.service_name,e.description=s.service.description,e.duration=s.service.duration,e.category_id=s.service.category_id,e.single_price=s.service.single_price,e.combo_5_price=s.service.combo_5_price||0,e.combo_10_price=s.service.combo_10_price||0,e.validity_period=s.service.validity_period||0,s.service.media&&s.service.media.length>0&&(_.value=[],s.service.media.forEach(l=>{const r=l.file_path.startsWith("http")?l.file_path:`/storage/${l.file_path.replace(/^\/+/,"")}`;_.value.push(r)})))});const S=l=>{y("update:modelValue",l)},C=()=>{y("close")},V=()=>{const l=new FormData;Object.keys(e).forEach(d=>{(d!=="images"||!p.value)&&l.append(d,e[d])}),p.value||b.value.forEach((d,v)=>{l.append(`images[${v}]`,d)});const r=p.value?route("services.update",s.service.id):route("services.store"),i=p.value?"put":"post";e[i](r,{data:l,forceFormData:!0,onSuccess:()=>{g.success(p.value?"Cập nhật dịch vụ thành công":"Thêm dịch vụ mới thành công"),y("service-saved"),C()},onError:d=>{console.log(d),g.error("Có lỗi xảy ra, vui lòng thử lại")}})};return(l,r)=>(a(),z(H,{"model-value":x.modelValue,"onUpdate:modelValue":S,title:p.value?"Chỉnh sửa dịch vụ":"Thêm dịch vụ mới",button:"primary","button-label":p.value?"Cập nhật":"Thêm mới","has-cancel":"",onConfirm:V,onCancel:C},{default:A(()=>[t("form",{onSubmit:q(V,["prevent"]),class:"space-y-6"},[t("div",K,[t("div",null,[r[8]||(r[8]=t("label",{class:"form-label required"},"Tên dịch vụ",-1)),c(t("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=i=>o(e).service_name=i),class:"form-input",required:""},null,512),[[f,o(e).service_name]]),o(e).errors.service_name?(a(),n("div",W,m(o(e).errors.service_name),1)):u("",!0)]),t("div",null,[r[10]||(r[10]=t("label",{class:"form-label required"},"Danh mục",-1)),c(t("select",{"onUpdate:modelValue":r[1]||(r[1]=i=>o(e).category_id=i),class:"form-select",required:""},[r[9]||(r[9]=t("option",{value:""},"Chọn danh mục",-1)),(a(!0),n(U,null,M(s.categories,i=>(a(),n("option",{key:i.id,value:i.id},m(i.service_category_name),9,Q))),128))],512),[[N,o(e).category_id]]),o(e).errors.category_id?(a(),n("div",X,m(o(e).errors.category_id),1)):u("",!0)]),t("div",null,[r[11]||(r[11]=t("label",{class:"form-label required"},"Giá dịch vụ đơn lẻ",-1)),c(t("input",{type:"number","onUpdate:modelValue":r[2]||(r[2]=i=>o(e).single_price=i),class:"form-input",required:"",min:"0"},null,512),[[f,o(e).single_price]]),o(e).errors.single_price?(a(),n("div",Y,m(o(e).errors.single_price),1)):u("",!0)]),t("div",null,[r[12]||(r[12]=t("label",{class:"form-label required"},"Thời gian (phút)",-1)),c(t("input",{type:"number","onUpdate:modelValue":r[3]||(r[3]=i=>o(e).duration=i),class:"form-input",required:"",min:"0"},null,512),[[f,o(e).duration]]),o(e).errors.duration?(a(),n("div",Z,m(o(e).errors.duration),1)):u("",!0)]),t("div",null,[r[13]||(r[13]=t("label",{class:"form-label"},"Giá combo 5 lần",-1)),c(t("input",{type:"number","onUpdate:modelValue":r[4]||(r[4]=i=>o(e).combo_5_price=i),class:"form-input",min:"0"},null,512),[[f,o(e).combo_5_price]]),o(e).errors.combo_5_price?(a(),n("div",ee,m(o(e).errors.combo_5_price),1)):u("",!0)]),t("div",null,[r[14]||(r[14]=t("label",{class:"form-label"},"Giá combo 10 lần",-1)),c(t("input",{type:"number","onUpdate:modelValue":r[5]||(r[5]=i=>o(e).combo_10_price=i),class:"form-input",min:"0"},null,512),[[f,o(e).combo_10_price]]),o(e).errors.combo_10_price?(a(),n("div",re,m(o(e).errors.combo_10_price),1)):u("",!0)]),t("div",null,[r[15]||(r[15]=t("label",{class:"form-label"},"Thời hạn sử dụng combo (ngày)",-1)),c(t("input",{type:"number","onUpdate:modelValue":r[6]||(r[6]=i=>o(e).validity_period=i),class:"form-input",min:"0"},null,512),[[f,o(e).validity_period]]),o(e).errors.validity_period?(a(),n("div",oe,m(o(e).errors.validity_period),1)):u("",!0)])]),p.value?u("",!0):(a(),n("div",te,[r[16]||(r[16]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2"},"Hình ảnh dịch vụ",-1)),t("div",ie,[(a(!0),n(U,null,M(_.value,(i,d)=>(a(),n("div",{key:d,class:"relative w-24 h-24 border rounded-lg overflow-hidden"},[t("img",{src:i,class:"w-full h-full object-cover"},null,8,se),t("button",{onClick:q(v=>I(d),["prevent"]),class:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600"},[F(T,{path:o(L),size:"16"},null,8,["path"])],8,le)]))),128)),t("div",{class:"w-24 h-24 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center cursor-pointer hover:border-primary-500",onClick:E},[F(T,{path:o(O),size:"24",class:"text-gray-400"},null,8,["path"]),t("input",{type:"file",ref_key:"fileInput",ref:k,class:"hidden",multiple:"",onChange:D,accept:"image/*"},null,544)])]),r[17]||(r[17]=t("p",{class:"text-xs text-gray-500"},"PNG, JPG, GIF tối đa 2MB",-1)),o(e).errors.images?(a(),n("span",ae,m(o(e).errors.images),1)):u("",!0)])),t("div",null,[r[18]||(r[18]=t("label",{class:"form-label"},"Mô tả",-1)),c(t("textarea",{"onUpdate:modelValue":r[7]||(r[7]=i=>o(e).description=i),class:"form-textarea",rows:"4"},null,512),[[f,o(e).description]]),o(e).errors.description?(a(),n("div",ne,m(o(e).errors.description),1)):u("",!0)])],32)]),_:1},8,["model-value","title","button-label"]))}},Pe=R(de,[["__scopeId","data-v-cb15eb45"]]);export{Pe as default};
