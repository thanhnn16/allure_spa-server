import{r as f,c as $,aU as u,a0 as b,bH as o,aa as a,bl as _,a3 as m,bf as s,a9 as k,a1 as S,a2 as v,b0 as N,F as U,bM as q}from"./@vue-BRgAy5zV.js";import{L as w}from"./LayoutAuthenticated-CGMlm712.js";import{_ as B}from"./SectionMain-BbIPmLtw.js";import{_ as y}from"./CardBox-jfYP3QDG.js";import{_ as d}from"./FormField-Da_P6kO8.js";import{_ as c}from"./FormControl-BSsARiYM.js";import{_ as g}from"./BaseButton-eMTGofBM.js";import{_ as F}from"./NotificationBar-C1pDMsZl.js";import{Z as L,F as C}from"./@inertiajs-D0DMCEQB.js";import{j as T}from"./@mdi-CTfBXXzV.js";import{a as j}from"./axios-CCb-kr4I.js";import"./app-BDuwkw34.js";import"./jspdf-Ciebq7We.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./@babel-BsCcpEdk.js";import"./fflate-EnPhvkmS.js";import"./laravel-echo-C9ppFO4I.js";import"./pusher-js-Cl-1XqxI.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./pinia-BhnhDyRZ.js";import"./vue-toastification-ejyjJRED.js";import"./firebase-DL3QX-oU.js";import"./@firebase--zA4YiqN.js";import"./idb-Bn1DMRyg.js";import"./deepmerge-CtOfIP5S.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./BaseIcon-B4kwkOCn.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./colors-S7_1wET5.js";import"./OverlayLayer-BSs7OF78.js";import"./main-BNmBi4-k.js";import"./BaseLevel-vqqndN8O.js";const A={class:"space-y-4"},D={class:"text-2xl font-bold"},E=["value"],M={class:"flex justify-end space-x-2"},Tt={__name:"Edit",props:{appointment:{type:Object,required:!0},timeSlots:{type:Array,default:()=>[]}},setup(p){const l=p,r=f(null),h=f(!1),i=f({appointment_date:l.appointment.appointment_date,time_slot_id:l.appointment.time_slot_id,note:l.appointment.note,slots:l.appointment.slots}),V=async()=>{var n,t;try{h.value=!0,(await j.put(`/api/appointments/${l.appointment.id}`,i.value)).data.success&&(r.value={type:"success",message:"Cập nhật lịch hẹn thành công"},setTimeout(()=>{C.visit(`/appointments/${l.appointment.id}`)},1e3))}catch(e){r.value={type:"danger",message:((t=(n=e.response)==null?void 0:n.data)==null?void 0:t.message)||"Có lỗi xảy ra khi cập nhật lịch hẹn"}}finally{h.value=!1}},x=$(()=>l.timeSlots.filter(n=>n.id===l.appointment.time_slot_id?!0:n.available));return(n,t)=>(u(),b(w,null,{default:o(()=>[a(_(L),{title:"Chỉnh sửa lịch hẹn"}),a(B,{breadcrumbs:[{label:"Lịch hẹn",href:n.route("appointments.index")},{label:"Chi tiết",href:`/appointments/${p.appointment.id}`},{label:"Chỉnh sửa"}]},{default:o(()=>[a(y,{class:"mb-6"},{default:o(()=>[m("div",A,[m("h1",D,"Chỉnh sửa lịch hẹn #"+s(p.appointment.id),1),t[5]||(t[5]=m("p",{class:"text-gray-500"},"Cập nhật thông tin lịch hẹn",-1))])]),_:1}),r.value?(u(),b(F,{key:0,color:r.value.type,icon:_(T),class:"mb-6"},{default:o(()=>[k(s(r.value.message),1)]),_:1},8,["color","icon"])):S("",!0),a(y,null,{default:o(()=>[m("form",{onSubmit:q(V,["prevent"]),class:"space-y-6"},[a(d,{label:"Ngày hẹn",help:"Chọn ngày cho lịch hẹn"},{default:o(()=>[a(c,{modelValue:i.value.appointment_date,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value.appointment_date=e),type:"date",required:""},null,8,["modelValue"])]),_:1}),a(d,{label:"Khung giờ",help:"Chọn khung giờ phù hợp"},{default:o(()=>[a(c,{modelValue:i.value.time_slot_id,"onUpdate:modelValue":t[1]||(t[1]=e=>i.value.time_slot_id=e),type:"select",required:""},{default:o(()=>[t[6]||(t[6]=m("option",{value:""},"Chọn khung giờ",-1)),(u(!0),v(U,null,N(x.value,e=>(u(),v("option",{key:e.id,value:e.id},s(e.start_time)+" - "+s(e.end_time)+" ("+s(e.available?"Còn trống":"Đã đầy")+") ",9,E))),128))]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"Số lượng slot",help:"Chọn số lượng slot cần đặt"},{default:o(()=>[a(c,{modelValue:i.value.slots,"onUpdate:modelValue":t[2]||(t[2]=e=>i.value.slots=e),type:"number",min:"1",required:""},null,8,["modelValue"])]),_:1}),a(d,{label:"Ghi chú",help:"Thêm ghi chú cho lịch hẹn (không bắt buộc)"},{default:o(()=>[a(c,{modelValue:i.value.note,"onUpdate:modelValue":t[3]||(t[3]=e=>i.value.note=e),type:"textarea",rows:4},null,8,["modelValue"])]),_:1}),m("div",M,[a(g,{type:"button",color:"info",label:"Quay lại",outline:"",onClick:t[4]||(t[4]=e=>_(C).visit(`/appointments/${p.appointment.id}`))}),a(g,{type:"submit",color:"success",label:"Cập nhật",loading:h.value},null,8,["loading"])])],32)]),_:1})]),_:1},8,["breadcrumbs"])]),_:1}))}};export{Tt as default};
