import{r as y,c as z,o as N,aU as l,a0 as $,bH as A,a3 as t,bJ as c,bA as b,bl as o,a2 as n,bf as m,a1 as u,bz as L,b0 as U,F as q,bM as F,aa as T}from"./@vue-BRgAy5zV.js";import{T as P}from"./@inertiajs-D0DMCEQB.js";import{C as H}from"./CardBoxModal-DEGnNy3P.js";import{_ as B}from"./BaseIcon-B4kwkOCn.js";import{u as J}from"./vue-toastification-ejyjJRED.js";import{j as O,b as R}from"./@mdi-D7koDRFv.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./axios-CCb-kr4I.js";import"./deepmerge-CtOfIP5S.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./BaseButton-eMTGofBM.js";import"./colors-S7_1wET5.js";import"./BaseButtons-B17KSMwc.js";import"./CardBox-jfYP3QDG.js";import"./OverlayLayer-BSs7OF78.js";const Q={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},W={key:0,class:"form-error"},X=["value"],Y={key:0,class:"form-error"},Z={key:0,class:"form-error"},ee={key:0,class:"form-error"},re={key:0,class:"form-error"},oe={key:0,class:"form-error"},te={key:0,class:"form-error"},ie={class:"py-2"},se={class:"flex flex-wrap gap-4 mb-4"},le=["src"],ae=["onClick"],ne={key:0,class:"text-red-500 text-sm"},de={key:0,class:"form-error"},me={__name:"ServiceFormModal",props:{modelValue:Boolean,service:{type:Object,default:null}},emits:["update:modelValue","close","service-saved"],setup(x,{emit:E}){const f=J(),k=y(null),_=y([]),p=y([]),a=x,h=E,g=z(()=>!!a.service),C=y([]),e=P({service_name:"",description:"",duration:0,category_id:"",single_price:0,combo_5_price:0,combo_10_price:0,validity_period:0,images:[]}),D=()=>{k.value.click()},I=s=>{const r=Array.from(s.target.files);if(p.value.length+r.length>10){f.error("Không được upload quá 10 ảnh");return}r.forEach(v=>{if(v.size>2*1024*1024){f.error(`File ${v.name} vượt quá 2MB`);return}const M=new FileReader;M.onload=G=>{_.value.push(G.target.result)},M.readAsDataURL(v),p.value.push(v)}),e.images=p.value},S=s=>{_.value.splice(s,1),p.value.splice(s,1),e.images=p.value};N(async()=>{try{const r=await(await fetch("/api/services/categories")).json();C.value=r.data}catch{f.error("Lỗi khi tải danh mục dịch vụ")}a.service&&(e.service_name=a.service.service_name,e.description=a.service.description,e.duration=a.service.duration,e.category_id=a.service.category_id,e.single_price=a.service.single_price,e.combo_5_price=a.service.combo_5_price,e.combo_10_price=a.service.combo_10_price,e.validity_period=a.service.validity_period,a.service.media&&a.service.media.forEach(s=>{_.value.push(s.url)}))});const j=s=>{h("update:modelValue",s)},V=()=>{e.reset(),_.value=[],p.value=[],h("close")},w=()=>{const s=new FormData;Object.keys(e).forEach(d=>{d!=="images"&&s.append(d,e[d])}),p.value.forEach((d,v)=>{s.append(`images[${v}]`,d)});const r=g.value?route("services.update",a.service.id):route("services.store"),i=g.value?"put":"post";e[i](r,{data:s,forceFormData:!0,onSuccess:()=>{f.success(g.value?"Cập nhật dịch vụ thành công":"Thêm dịch vụ mới thành công"),h("service-saved"),V()},onError:d=>{console.log(d),f.error("Có lỗi xảy ra, vui lòng thử lại")}})};return(s,r)=>(l(),$(H,{"model-value":x.modelValue,"onUpdate:modelValue":j,title:g.value?"Chỉnh sửa dịch vụ":"Thêm dịch vụ mới",button:"primary","button-label":g.value?"Cập nhật":"Thêm mới","has-cancel":"",onConfirm:w,onCancel:V},{default:A(()=>[t("form",{onSubmit:F(w,["prevent"]),class:"space-y-6"},[t("div",Q,[t("div",null,[r[8]||(r[8]=t("label",{class:"form-label required"},"Tên dịch vụ",-1)),c(t("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=i=>o(e).service_name=i),class:"form-input",required:""},null,512),[[b,o(e).service_name]]),o(e).errors.service_name?(l(),n("div",W,m(o(e).errors.service_name),1)):u("",!0)]),t("div",null,[r[10]||(r[10]=t("label",{class:"form-label required"},"Danh mục",-1)),c(t("select",{"onUpdate:modelValue":r[1]||(r[1]=i=>o(e).category_id=i),class:"form-select",required:""},[r[9]||(r[9]=t("option",{value:""},"Chọn danh mục",-1)),(l(!0),n(q,null,U(C.value,i=>(l(),n("option",{key:i.id,value:i.id},m(i.service_category_name),9,X))),128))],512),[[L,o(e).category_id]]),o(e).errors.category_id?(l(),n("div",Y,m(o(e).errors.category_id),1)):u("",!0)]),t("div",null,[r[11]||(r[11]=t("label",{class:"form-label required"},"Giá dịch vụ đơn lẻ",-1)),c(t("input",{type:"number","onUpdate:modelValue":r[2]||(r[2]=i=>o(e).single_price=i),class:"form-input",required:"",min:"0"},null,512),[[b,o(e).single_price]]),o(e).errors.single_price?(l(),n("div",Z,m(o(e).errors.single_price),1)):u("",!0)]),t("div",null,[r[12]||(r[12]=t("label",{class:"form-label required"},"Thời gian (phút)",-1)),c(t("input",{type:"number","onUpdate:modelValue":r[3]||(r[3]=i=>o(e).duration=i),class:"form-input",required:"",min:"0"},null,512),[[b,o(e).duration]]),o(e).errors.duration?(l(),n("div",ee,m(o(e).errors.duration),1)):u("",!0)]),t("div",null,[r[13]||(r[13]=t("label",{class:"form-label"},"Giá combo 5 lần",-1)),c(t("input",{type:"number","onUpdate:modelValue":r[4]||(r[4]=i=>o(e).combo_5_price=i),class:"form-input",min:"0"},null,512),[[b,o(e).combo_5_price]]),o(e).errors.combo_5_price?(l(),n("div",re,m(o(e).errors.combo_5_price),1)):u("",!0)]),t("div",null,[r[14]||(r[14]=t("label",{class:"form-label"},"Giá combo 10 lần",-1)),c(t("input",{type:"number","onUpdate:modelValue":r[5]||(r[5]=i=>o(e).combo_10_price=i),class:"form-input",min:"0"},null,512),[[b,o(e).combo_10_price]]),o(e).errors.combo_10_price?(l(),n("div",oe,m(o(e).errors.combo_10_price),1)):u("",!0)]),t("div",null,[r[15]||(r[15]=t("label",{class:"form-label"},"Thời hạn sử dụng combo (ngày)",-1)),c(t("input",{type:"number","onUpdate:modelValue":r[6]||(r[6]=i=>o(e).validity_period=i),class:"form-input",min:"0"},null,512),[[b,o(e).validity_period]]),o(e).errors.validity_period?(l(),n("div",te,m(o(e).errors.validity_period),1)):u("",!0)])]),t("div",ie,[r[16]||(r[16]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2"},"Hình ảnh dịch vụ",-1)),t("div",se,[(l(!0),n(q,null,U(_.value,(i,d)=>(l(),n("div",{key:d,class:"relative w-24 h-24 border rounded-lg overflow-hidden"},[t("img",{src:i,class:"w-full h-full object-cover"},null,8,le),t("button",{onClick:F(v=>S(d),["prevent"]),class:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600"},[T(B,{path:o(O),size:"16"},null,8,["path"])],8,ae)]))),128)),t("div",{class:"w-24 h-24 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center cursor-pointer hover:border-primary-500",onClick:D},[T(B,{path:o(R),size:"24",class:"text-gray-400"},null,8,["path"]),t("input",{type:"file",ref_key:"fileInput",ref:k,class:"hidden",multiple:"",onChange:I,accept:"image/*"},null,544)])]),r[17]||(r[17]=t("p",{class:"text-xs text-gray-500"},"PNG, JPG, GIF tối đa 2MB",-1)),o(e).errors.images?(l(),n("span",ne,m(o(e).errors.images),1)):u("",!0)]),t("div",null,[r[18]||(r[18]=t("label",{class:"form-label"},"Mô tả",-1)),c(t("textarea",{"onUpdate:modelValue":r[7]||(r[7]=i=>o(e).description=i),class:"form-textarea",rows:"4"},null,512),[[b,o(e).description]]),o(e).errors.description?(l(),n("div",de,m(o(e).errors.description),1)):u("",!0)])],32)]),_:1},8,["model-value","title","button-label"]))}},Pe=K(me,[["__scopeId","data-v-84c27aca"]]);export{Pe as default};
