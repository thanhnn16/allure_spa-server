import{r as h,e as v,o as G,aU as m,a0 as j,bH as D,a3 as t,bJ as u,bA as a,bl as i,j as x,a2 as p,bf as b,a1 as y,bz as I,b0 as U,F as S,aa as B,bM as H}from"./@vue-BRgAy5zV.js";import{T as L,F as O}from"./@inertiajs-D0DMCEQB.js";import{u as z}from"./vue-toastification-ejyjJRED.js";import{C as A}from"./CardBoxModal-CvqbfEHw.js";import{_ as M}from"./BaseButton-eMTGofBM.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./axios-CCb-kr4I.js";import"./deepmerge-CtOfIP5S.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./@mdi-Dzgtc9aE.js";import"./BaseButtons-B17KSMwc.js";import"./CardBox-jfYP3QDG.js";import"./OverlayLayer-BSs7OF78.js";import"./colors-S7_1wET5.js";import"./BaseIcon-B4kwkOCn.js";const K={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Q={key:0,class:"text-red-500 text-sm"},R=["value"],W={key:0,class:"text-red-500 text-sm"},X={key:0,class:"text-red-500 text-sm"},Y={key:0,class:"text-red-500 text-sm"},Z={class:"space-y-4"},_={key:0,class:"bg-red-50 p-4 rounded-md"},ee={class:"mt-2 text-sm text-red-600"},te={class:"flex justify-end space-x-2"},re={__name:"EditProductModal",props:{modelValue:{type:Boolean,required:!0},product:{type:Object,required:!0},categories:{type:Array,required:!0}},emits:["update:modelValue","close","product-updated"],setup(k,{emit:T}){var C;const l=k,q=T,w=z(),s=h({}),g=h(!1),V=n=>new Intl.NumberFormat("vi-VN").format(n),F=n=>Number(n.replace(/[^\d]/g,"")),c=h(""),r=L({name:l.product.name,category_id:l.product.category_id,price:((C=l.product)==null?void 0:C.price)||0,quantity:l.product.quantity,brand_description:l.product.brand_description||"",usage:l.product.usage||"",benefits:l.product.benefits||"",key_ingredients:l.product.key_ingredients||"",ingredients:l.product.ingredients||"",directions:l.product.directions||"",storage_instructions:l.product.storage_instructions||"",product_notes:l.product.product_notes||""}),$=n=>{const e=n.target.value.replace(/[^\d]/g,"");e?(c.value=V(e),r.price=F(c.value)):(c.value="",r.price=0)},E=()=>{r.price&&(c.value=V(r.price))},P=()=>{var e;s.value={};let n=!0;return(e=r.name)!=null&&e.trim()||(s.value.name="Tên sản phẩm là bắt buộc",n=!1),r.category_id||(s.value.category_id="Vui lòng chọn danh mục",n=!1),(!r.price||isNaN(Number(r.price))||Number(r.price)<=0)&&(s.value.price="Giá sản phẩm phải lớn hơn 0",n=!1),(!r.quantity||isNaN(Number(r.quantity))||Number(r.quantity)<0)&&(s.value.quantity="Số lượng không được âm",n=!1),n},f=(n,e)=>{const o={name:d=>d?d.length<3?"Tên sản phẩm phải có ít nhất 3 ký tự":null:"Tên sản phẩm là bắt buộc",category_id:d=>d?null:"Danh mục là bắt buộc",price:d=>d?isNaN(d)?"Giá phải là số":parseFloat(d)<=0?"Giá phải lớn hơn 0":null:"Giá là bắt buộc",quantity:d=>d?isNaN(d)?"Số lượng phải là số":parseInt(d)<0?"Số lượng không được âm":null:"Số lượng là bắt buộc"};if(o[n]){const d=o[n](e);return d?(s.value[n]=d,!1):(delete s.value[n],!0)}return!0},N=async()=>{if(!g.value&&P()){g.value=!0;try{r.put(route("api.products.update",l.product.id),{preserveScroll:!0,onSuccess:()=>{w.success("Cập nhật sản phẩm thành công"),q("product-updated"),O.reload(),q("close")},onError:n=>{s.value=n,w.error("Có lỗi xảy ra khi cập nhật sản phẩm")}})}catch(n){console.error("Error updating product:",n),w.error("Có lỗi xảy ra khi cập nhật sản phẩm")}finally{g.value=!1}}};return v(()=>r.name,n=>f("name",n)),v(()=>r.category_id,n=>f("category_id",n)),v(()=>r.price,n=>f("price",n)),v(()=>r.quantity,n=>f("quantity",n)),G(()=>{var n;Object.keys(r).forEach(e=>{l.product[e]!==void 0&&(r[e]=l.product[e])}),(n=l.product)!=null&&n.price&&(c.value=V(l.product.price))}),(n,e)=>(m(),j(A,{modelValue:k.modelValue,"onUpdate:modelValue":e[14]||(e[14]=o=>n.$emit("update:modelValue")),title:"Chỉnh sửa sản phẩm",onSubmit:N,onCancel:e[15]||(e[15]=o=>n.$emit("close")),isLoading:g.value,hasButton:!1},{default:D(()=>[t("form",{onSubmit:H(N,["prevent"]),class:"space-y-6"},[t("div",K,[t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700"},"Tên sản phẩm *",-1)),u(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>i(r).name=o),class:x(["mt-1 block w-full rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",s.value.name?"border-red-500":"border-gray-300"]),onBlur:e[1]||(e[1]=o=>f("name",i(r).name)),type:"text",required:""},null,34),[[a,i(r).name]]),s.value.name?(m(),p("span",Q,b(s.value.name),1)):y("",!0)]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700"},"Danh mục *",-1)),u(t("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>i(r).category_id=o),class:x(["mt-1 block w-full rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",s.value.category_id?"border-red-500":"border-gray-300"]),required:""},[e[17]||(e[17]=t("option",{value:""},"Chọn danh mục",-1)),(m(!0),p(S,null,U(k.categories,o=>(m(),p("option",{key:o.id,value:o.id},b(o.category_name),9,R))),128))],2),[[I,i(r).category_id]]),s.value.category_id?(m(),p("span",W,b(s.value.category_id),1)):y("",!0)]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700"},"Giá *",-1)),u(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>c.value=o),onInput:$,onBlur:E,type:"text",class:x(["mt-1 block w-full rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",s.value.price?"border-red-500":"border-gray-300"]),required:""},null,34),[[a,c.value]]),s.value.price?(m(),p("span",X,b(s.value.price),1)):y("",!0)]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700"},"Số lượng *",-1)),u(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>i(r).quantity=o),type:"number",min:"0",class:x(["mt-1 block w-full rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",s.value.quantity?"border-red-500":"border-gray-300"]),required:""},null,2),[[a,i(r).quantity]]),s.value.quantity?(m(),p("span",Y,b(s.value.quantity),1)):y("",!0)])]),t("div",Z,[t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-700"},"Mô tả thương hiệu",-1)),u(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=o=>i(r).brand_description=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[a,i(r).brand_description]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700"},"Cách sử dụng",-1)),u(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=o=>i(r).usage=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[a,i(r).usage]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-gray-700"},"Lợi ích",-1)),u(t("textarea",{"onUpdate:modelValue":e[7]||(e[7]=o=>i(r).benefits=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[a,i(r).benefits]])]),t("div",null,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-gray-700"},"Thành phần chính",-1)),u(t("textarea",{"onUpdate:modelValue":e[8]||(e[8]=o=>i(r).key_ingredients=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[a,i(r).key_ingredients]])]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700"},"Thành phần đầy đủ",-1)),u(t("textarea",{"onUpdate:modelValue":e[9]||(e[9]=o=>i(r).ingredients=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[a,i(r).ingredients]])]),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700"},"Hướng dẫn sử dụng",-1)),u(t("textarea",{"onUpdate:modelValue":e[10]||(e[10]=o=>i(r).directions=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[a,i(r).directions]])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700"},"Hướng dẫn bảo quản",-1)),u(t("textarea",{"onUpdate:modelValue":e[11]||(e[11]=o=>i(r).storage_instructions=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[a,i(r).storage_instructions]])]),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-gray-700"},"Ghi chú sản phẩm",-1)),u(t("textarea",{"onUpdate:modelValue":e[12]||(e[12]=o=>i(r).product_notes=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[a,i(r).product_notes]])])]),Object.keys(s.value).length>0?(m(),p("div",_,[e[29]||(e[29]=t("p",{class:"text-red-700 font-medium"},"Vui lòng sửa các lỗi sau:",-1)),t("ul",ee,[(m(!0),p(S,null,U(s.value,(o,d)=>(m(),p("li",{key:d},b(o),1))),128))])])):y("",!0),t("div",te,[B(M,{type:"button",label:"Hủy",onClick:e[13]||(e[13]=o=>n.$emit("close"))}),B(M,{type:"submit",color:"info",label:"Cập nhật",loading:g.value,disabled:g.value},null,8,["loading","disabled"])])],32)]),_:1},8,["modelValue","isLoading"]))}},Pe=J(re,[["__scopeId","data-v-393bd9db"]]);export{Pe as default};
