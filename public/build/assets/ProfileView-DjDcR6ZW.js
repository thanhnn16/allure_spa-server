import{c as w,aU as _,a0 as b,bH as o,b1 as q,aa as e,bl as n,a3 as p,a9 as $,bf as g,a2 as G,a1 as C,f as N,o as E,bM as T}from"./@vue-BRgAy5zV.js";import{Q as I,Z as K}from"./@inertiajs-D0DMCEQB.js";import{u as F}from"./main-BNmBi4-k.js";import{aB as O,B as H,aC as L,n as j,a as Q,P as X,aD as J,aE as R,C as Z,o as W,aF as S}from"./@mdi-Dzgtc9aE.js";import{_ as Y}from"./SectionMain-BbIPmLtw.js";import{_ as V}from"./CardBox-jfYP3QDG.js";import{_ as ee,L as ae}from"./LayoutAuthenticated-CzfwhAgZ.js";import{_ as u}from"./FormField-Da_P6kO8.js";import{_ as d}from"./FormControl-BSsARiYM.js";import{_ as v}from"./BaseButton-eMTGofBM.js";import{_ as B}from"./BaseButtons-B17KSMwc.js";import{_ as te}from"./BaseLevel-vqqndN8O.js";import{_ as oe}from"./UserAvatar-C0woRmoK.js";import{_ as re}from"./PillTag-BbG8P_L6.js";import{_ as D}from"./BaseIcon-B4kwkOCn.js";import{_ as ne}from"./SectionTitleLineWithButton-DiemkpGv.js";import{a as y}from"./axios-CCb-kr4I.js";import{u as le}from"./vue-toastification-ejyjJRED.js";import"./deepmerge-CtOfIP5S.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./pinia-BhnhDyRZ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./app-Dn86IW14.js";import"./jspdf-Ciebq7We.js";import"./@babel-BsCcpEdk.js";import"./fflate-EnPhvkmS.js";import"./laravel-echo-C9ppFO4I.js";import"./pusher-js-Cl-1XqxI.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./firebase-DL3QX-oU.js";import"./@firebase--zA4YiqN.js";import"./idb-Bn1DMRyg.js";import"./colors-S7_1wET5.js";import"./OverlayLayer-BSs7OF78.js";const se={__name:"UserAvatarCurrentUser",props:{avatarUrl:{type:String,default:null},size:{type:String,default:"md"}},setup(h){const s=w(()=>{const i=I().props.auth.user;return i&&i.full_name?i.full_name:"Guest"});return(i,t)=>(_(),b(oe,{fullName:s.value,"avatar-url":h.avatarUrl,size:h.size},{default:o(()=>[q(i.$slots,"default")]),_:3},8,["fullName","avatar-url","size"]))}},ie={class:"space-y-3 text-center md:text-left lg:mx-12"},me={class:"text-2xl"},ue={class:"flex items-center justify-center md:justify-start text-gray-500"},de={key:0,class:"flex items-center justify-center md:justify-start text-gray-500"},pe={class:"flex justify-center md:block"},ce={__name:"UserCard",props:{userData:{type:Object,required:!0}},setup(h){const s=F(),i=w(()=>s.fullName),t=w(()=>({admin:"Quản trị viên",staff:"Nhân viên",user:"Khách hàng"})[s.user.role]||s.user.role);return(m,c)=>(_(),b(V,null,{default:o(()=>[e(te,{type:"justify-around lg:justify-center"},{default:o(()=>[e(se,{class:"lg:mx-12","avatar-url":n(s).user.avatar_url,fullName:i.value,size:"lg"},null,8,["avatar-url","fullName"]),p("div",ie,[p("h1",me,[c[0]||(c[0]=$(" Xin chào, ")),p("b",null,g(i.value),1),c[1]||(c[1]=$("! "))]),p("div",ue,[e(D,{path:n(O),class:"mr-2",size:"20"},null,8,["path"]),p("span",null,g(t.value),1)]),n(s).user.email?(_(),G("div",de,[e(D,{path:n(H),class:"mr-2",size:"20"},null,8,["path"]),p("span",null,g(n(s).user.email),1)])):C("",!0),p("div",pe,[n(s).user.email_verified_at?(_(),b(re,{key:0,label:"Đã xác thực",color:"info",icon:n(L)},null,8,["icon"])):C("",!0)])])]),_:1})]),_:1}))}},fe={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},pa={__name:"ProfileView",setup(h){const s=F(),i=le(),t=N({full_name:"",email:"",phone_number:"",gender:"",date_of_birth:"",skin_condition:"",avatar:null}),m=N({password_current:"",password:"",password_confirmation:""}),c=()=>{const l=s.user;t.full_name=l.full_name,t.email=l.email,t.phone_number=l.phone_number,t.gender=l.gender,t.date_of_birth=l.date_of_birth,t.skin_condition=l.skin_condition,t.avatar=l.avatar_url},M=()=>{const l=new FormData;Object.keys(t).forEach(a=>{t[a]!==null&&l.append(a,t[a])}),y.post(`/api/users/${s.user.id}`,l,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>{s.setUser(a.data.data),i.success("Cập nhật thông tin thành công")}).catch(a=>{i.error("Có lỗi xảy ra khi cập nhật thông tin")})},z=async l=>{var U,x;const a=l.target.files[0];if(!a)return;if(a.size>2*1024*1024){i.error("Kích thước file không được vượt quá 2MB");return}if(!["image/jpeg","image/png","image/gif","image/jpg"].includes(a.type)){i.error("Chỉ chấp nhận file ảnh định dạng JPG, PNG hoặc GIF");return}const k=new FormData;k.append("avatar",a);try{i.info("Đang tải ảnh lên...");const f=await y.post("/api/users/upload-avatar",k,{headers:{"Content-Type":"multipart/form-data",Accept:"application/json"}});f.data.success&&(s.setUser(f.data.data.user),t.avatar=f.data.data.avatar_url,l.target.value="",i.success("Tải ảnh đại diện thành công"))}catch(f){console.error("Upload error:",f);const A=((x=(U=f.response)==null?void 0:U.data)==null?void 0:x.message)||"Không thể tải lên ảnh đại diện";i.error(A)}},P=()=>{y.post("/api/change-password",m).then(l=>{m.password_current="",m.password="",m.password_confirmation=""}).catch(l=>{})};return E(async()=>{await s.fetchUserInfo(),c()}),(l,a)=>(_(),b(ae,null,{default:o(()=>[e(n(K),{title:"Thông tin cá nhân"}),e(Y,null,{default:o(()=>[e(ne,{icon:n(j),title:"Thông tin cá nhân",main:""},{default:o(()=>[e(v,{icon:n(Q),label:"Tải lên ảnh đại diện",color:"info","rounded-full":"",small:"",onClick:a[0]||(a[0]=r=>l.$refs.avatarInput.click())},null,8,["icon"]),p("input",{ref:"avatarInput",type:"file",accept:"image/*",class:"hidden",onChange:z},null,544)]),_:1},8,["icon"]),e(ce,{class:"mb-6",userData:n(s).user},null,8,["userData"]),p("div",fe,[e(V,{"is-form":"",onSubmit:T(M,["prevent"])},{footer:o(()=>[e(B,null,{default:o(()=>[e(v,{color:"info",type:"submit",label:"Cập nhật"})]),_:1})]),default:o(()=>[e(u,{label:"Họ và tên",help:"Bắt buộc"},{default:o(()=>[e(d,{modelValue:t.full_name,"onUpdate:modelValue":a[1]||(a[1]=r=>t.full_name=r),icon:n(j),name:"full_name",required:""},null,8,["modelValue","icon"])]),_:1}),e(u,{label:"Email"},{default:o(()=>[e(d,{modelValue:t.email,"onUpdate:modelValue":a[2]||(a[2]=r=>t.email=r),icon:n(X),type:"email",name:"email",autocomplete:"email"},null,8,["modelValue","icon"])]),_:1}),e(u,{label:"Số điện thoại"},{default:o(()=>[e(d,{modelValue:t.phone_number,"onUpdate:modelValue":a[3]||(a[3]=r=>t.phone_number=r),icon:n(J),name:"phone_number"},null,8,["modelValue","icon"])]),_:1}),e(u,{label:"Giới tính"},{default:o(()=>[e(d,{modelValue:t.gender,"onUpdate:modelValue":a[4]||(a[4]=r=>t.gender=r),icon:n(R),type:"select",options:[{value:"male",label:"Nam"},{value:"female",label:"Nữ"},{value:"other",label:"Khác"}],name:"gender"},null,8,["modelValue","icon"])]),_:1}),e(u,{label:"Ngày sinh"},{default:o(()=>[e(d,{modelValue:t.date_of_birth,"onUpdate:modelValue":a[5]||(a[5]=r=>t.date_of_birth=r),icon:n(Z),type:"date",name:"date_of_birth"},null,8,["modelValue","icon"])]),_:1}),e(u,{label:"Tình trạng da"},{default:o(()=>[e(d,{modelValue:t.skin_condition,"onUpdate:modelValue":a[6]||(a[6]=r=>t.skin_condition=r),name:"skin_condition"},null,8,["modelValue"])]),_:1})]),_:1}),e(V,{"is-form":"",onSubmit:T(P,["prevent"])},{footer:o(()=>[e(B,null,{default:o(()=>[e(v,{type:"submit",color:"info",label:"Đổi mật khẩu"})]),_:1})]),default:o(()=>[e(u,{label:"Mật khẩu hiện tại",help:"Bắt buộc nhập mật khẩu hiện tại"},{default:o(()=>[e(d,{modelValue:m.password_current,"onUpdate:modelValue":a[7]||(a[7]=r=>m.password_current=r),icon:n(W),name:"password_current",type:"password",required:"",autocomplete:"current-password"},null,8,["modelValue","icon"])]),_:1}),e(ee),e(u,{label:"Mật khẩu mới",help:"Bắt buộc nhập mật khẩu mới"},{default:o(()=>[e(d,{modelValue:m.password,"onUpdate:modelValue":a[8]||(a[8]=r=>m.password=r),icon:n(S),name:"password",type:"password",required:"",autocomplete:"new-password"},null,8,["modelValue","icon"])]),_:1}),e(u,{label:"Xác nhận mật khẩu",help:"Nhập lại mật khẩu mới"},{default:o(()=>[e(d,{modelValue:m.password_confirmation,"onUpdate:modelValue":a[9]||(a[9]=r=>m.password_confirmation=r),icon:n(S),name:"password_confirmation",type:"password",required:"",autocomplete:"new-password"},null,8,["modelValue","icon"])]),_:1})]),_:1})])]),_:1})]),_:1}))}};export{pa as default};
