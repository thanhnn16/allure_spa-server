import{Z as P,F as h}from"./@inertiajs-D0DMCEQB.js";import{L as V}from"./LayoutAuthenticated-CfK2QHAr.js";import{_ as B}from"./SectionMain-Vot1TOkK.js";import{P as F}from"./Pagination-CjFMuWLP.js";import{r as g,aL as H,b2 as u,aU as o,a0 as j,bH as _,aa as k,a3 as e,a2 as i,bf as l,a1 as C,bJ as S,bz as U,bA as M,F as A,b0 as E,j as T,a9 as I}from"./@vue-BRgAy5zV.js";import{a as K}from"./axios-CCb-kr4I.js";import{c as z,d as R,j as Q}from"./@mdi-ArhfA4cU.js";import{u as X}from"./vue-toastification-ejyjJRED.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./deepmerge-CtOfIP5S.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./app-CjmWsnNA.js";import"./jspdf-Ciebq7We.js";import"./@babel-BsCcpEdk.js";import"./fflate-EnPhvkmS.js";import"./laravel-echo-C9ppFO4I.js";import"./pusher-js-Cl-1XqxI.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./pinia-BhnhDyRZ.js";import"./firebase-DL3QX-oU.js";import"./@firebase--zA4YiqN.js";import"./idb-Bn1DMRyg.js";import"./BaseIcon-B4kwkOCn.js";import"./colors-S7_1wET5.js";import"./OverlayLayer-BSs7OF78.js";const G={components:{Head:P,LayoutAuthenticated:V,SectionMain:B,Pagination:F},props:{orders:{type:Object,required:!0,default:()=>({data:[],links:[],meta:{}})},error:{type:String,default:null}},setup(D){const r=g({status:"",search:""}),n=g(null),t=X(),x=g(!1),c=g(""),p=g(null),y=()=>{n.value&&clearTimeout(n.value),n.value=setTimeout(()=>{m()},300)},m=()=>{h.get(route("orders.index"),{status:r.value.status,search:r.value.search},{preserveState:!0,preserveScroll:!0,replace:!0})};return H(()=>{n.value&&clearTimeout(n.value)}),{filters:r,formatCurrency:s=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(s),getStatusClass:s=>{const d="px-2 inline-flex text-xs leading-5 font-semibold rounded-full items-center transition-colors duration-150";return{pending:`${d} bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300`,confirmed:`${d} bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300`,shipping:`${d} bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300`,completed:`${d} bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300`,cancelled:`${d} bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300`}[s.toLowerCase()]||`${d} bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300`},getStatusDotClass:s=>({pending:"bg-yellow-400",confirmed:"bg-blue-400",shipping:"bg-purple-400",completed:"bg-green-400",cancelled:"bg-red-400"})[s.toLowerCase()]||"bg-gray-400",getStatusText:s=>({pending:"Chờ xác nhận",confirmed:"Đã xác nhận",shipping:"Đang giao hàng",completed:"Hoàn thành",cancelled:"Đã hủy"})[s.toLowerCase()]||"Không xác định",getPaymentStatusText:s=>{switch(s){case"pending":return"Chờ thanh toán";case"partial":return"Thanh toán một phần";case"paid":return"Đã thanh toán";case"cancelled":return"Đã hủy";default:return"Không xác định"}},getPaymentStatusClass:s=>({pending:"text-yellow-600",partial:"text-blue-600",paid:"text-green-600",cancelled:"text-red-600"})[s.toLowerCase()]||"text-gray-600",viewOrderDetails:s=>{h.visit(`/orders/${s}`)},createNewOrder:()=>{h.visit("/orders/create")},applyFilters:m,debounceSearch:y,showCancelModal:x,cancelReason:c,openCancelModal:s=>{p.value=s,c.value="",x.value=!0},cancelOrder:async()=>{var s,d;if(!c.value.trim()){t.error("Vui lòng nhập lý do hủy đơn hàng");return}try{await K.put(`/api/orders/${p.value}/cancel`,{reason:c.value}),t.success("Đơn hàng đã được hủy thành công"),x.value=!1,h.reload()}catch(w){console.error("Error cancelling order:",w),t.error(((d=(s=w.response)==null?void 0:s.data)==null?void 0:d.message)||"Có lỗi xảy ra khi hủy đơn hàng")}},formatDate:s=>new Date(s).toLocaleDateString("vi-VN"),mdiEye:z,mdiPencil:R,mdiClose:Q}}},J={class:"container mx-auto px-4 py-8 dark:bg-dark-bg"},Z={key:0,class:"mb-4 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-800 text-red-700 dark:text-red-300 px-4 py-3 rounded"},W={class:"flex justify-between items-center mb-6"},Y={class:"mb-6 flex flex-wrap items-center gap-4"},$={class:"flex items-center space-x-4 flex-grow"},ee={key:1,class:"overflow-x-auto bg-white dark:bg-dark-surface rounded-lg shadow-md"},te={class:"min-w-full divide-y divide-gray-200 dark:divide-dark-border"},re={class:"bg-white dark:bg-dark-surface divide-y divide-gray-200 dark:divide-dark-border"},ae={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-dark-text"},se={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-dark-text/70"},oe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-dark-text/70"},ne={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-dark-text/70"},de={class:"px-6 py-4 whitespace-nowrap"},ie={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},le={key:1,class:"text-yellow-600"},ce={class:"px-6 py-4 whitespace-nowrap text-sm"},ge={class:"flex space-x-2"},ue=["onClick"],xe={class:"w-5 h-5",viewBox:"0 0 24 24"},pe=["d"],me={class:"w-5 h-5",viewBox:"0 0 24 24"},he=["d"],ke=["onClick"],ye={class:"w-5 h-5",viewBox:"0 0 24 24"},be=["d"],fe={key:2,class:"text-center py-8 text-gray-500 dark:text-dark-text/70"},ve={key:3,class:"mt-6"},we={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},_e={class:"flex items-center justify-center min-h-screen px-4"},Ce={class:"relative bg-white dark:bg-dark-surface rounded-lg max-w-md w-full p-6 shadow-xl"},Se={class:"mt-4 flex justify-end space-x-3"};function Te(D,r,n,t,x,c){const p=u("Head"),y=u("Link"),m=u("Pagination"),O=u("SectionMain"),L=u("LayoutAuthenticated");return o(),j(L,null,{default:_(()=>[k(p,{title:"Quản lý đơn hàng"}),k(O,null,{default:_(()=>{var b,f,v;return[e("div",J,[n.error?(o(),i("div",Z,l(n.error),1)):C("",!0),e("div",W,[r[8]||(r[8]=e("h1",{class:"text-2xl font-semibold text-gray-900 dark:text-dark-text"},"Quản lý đơn hàng",-1)),e("button",{onClick:r[0]||(r[0]=(...a)=>t.createNewOrder&&t.createNewOrder(...a)),class:"bg-green-500 dark:bg-green-600 hover:bg-green-600 dark:hover:bg-green-700 text-white font-bold py-2 px-4 rounded transition-colors"}," Tạo đơn hàng mới ")]),e("div",Y,[e("div",$,[S(e("select",{"onUpdate:modelValue":r[1]||(r[1]=a=>t.filters.status=a),onChange:r[2]||(r[2]=(...a)=>t.applyFilters&&t.applyFilters(...a)),class:"form-select rounded-md shadow-sm w-48 dark:bg-dark-surface dark:border-dark-border dark:text-dark-text focus:border-primary-500 dark:focus:border-primary-500"},r[9]||(r[9]=[e("option",{value:""},"Tất cả trạng thái",-1),e("option",{value:"pending"},"Chờ xác nhận",-1),e("option",{value:"confirmed"},"Đã xác nhận",-1),e("option",{value:"shipping"},"Đang giao hàng",-1),e("option",{value:"completed"},"Hoàn thành",-1),e("option",{value:"cancelled"},"Đã hủy",-1)]),544),[[U,t.filters.status]]),S(e("input",{"onUpdate:modelValue":r[3]||(r[3]=a=>t.filters.search=a),onInput:r[4]||(r[4]=(...a)=>t.debounceSearch&&t.debounceSearch(...a)),type:"text",placeholder:"Tìm kiếm theo ID hoặc tên khách hàng",class:"form-input rounded-md shadow-sm flex-grow dark:bg-dark-surface dark:border-dark-border dark:text-dark-text focus:border-primary-500 dark:focus:border-primary-500 placeholder-gray-400 dark:placeholder-dark-text/50"},null,544),[[M,t.filters.search]])])]),((f=(b=n.orders)==null?void 0:b.data)==null?void 0:f.length)>0?(o(),i("div",ee,[e("table",te,[r[10]||(r[10]=e("thead",null,[e("tr",null,[e("th",{class:"px-6 py-4 bg-gray-50 dark:bg-dark-surface text-left text-xs font-medium text-gray-500 dark:text-dark-text/70 uppercase tracking-wider"}," Mã đơn hàng "),e("th",{class:"px-6 py-4 bg-gray-50 dark:bg-dark-surface text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Khách hàng "),e("th",{class:"px-6 py-4 bg-gray-50 dark:bg-dark-surface text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Tổng tiền "),e("th",{class:"px-6 py-4 bg-gray-50 dark:bg-dark-surface text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Giảm giá "),e("th",{class:"px-6 py-4 bg-gray-50 dark:bg-dark-surface text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Trạng thái "),e("th",{class:"px-6 py-4 bg-gray-50 dark:bg-dark-surface text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Thanh toán "),e("th",{class:"px-6 py-4 bg-gray-50 dark:bg-dark-surface text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Hành động ")])],-1)),e("tbody",re,[(o(!0),i(A,null,E(n.orders.data,a=>(o(),i("tr",{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-dark-surface-hover"},[e("td",ae," #"+l(a.id),1),e("td",se,l(a.user.full_name),1),e("td",oe,l(t.formatCurrency(a.total_amount)),1),e("td",ne,l(t.formatCurrency(a.discount_amount)),1),e("td",de,[e("span",{class:T(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full items-center",t.getStatusClass(a.status)])},[e("span",{class:T(["h-2 w-2 rounded-full mr-2 self-center",t.getStatusDotClass(a.status)])},null,2),I(" "+l(t.getStatusText(a.status)),1)],2)]),e("td",ie,[a.invoice?(o(),i("span",{key:0,class:T(t.getPaymentStatusClass(a.invoice.status))},l(t.getPaymentStatusText(a.invoice.status)),3)):(o(),i("span",le,"Chưa thanh toán"))]),e("td",ce,[e("div",ge,[e("button",{onClick:N=>t.viewOrderDetails(a.id),class:"p-1.5 rounded-lg hover:bg-indigo-50 dark:hover:bg-indigo-900/50 text-indigo-600 dark:text-indigo-400 hover:text-indigo-700 dark:hover:text-indigo-300 transition-all duration-200"},[(o(),i("svg",xe,[e("path",{d:t.mdiEye,fill:"currentColor"},null,8,pe)]))],8,ue),k(y,{href:D.route("orders.edit",a.id),class:"p-1.5 rounded-lg hover:bg-emerald-50 dark:hover:bg-emerald-900/50 text-emerald-600 dark:text-emerald-400 hover:text-emerald-700 dark:hover:text-emerald-300 transition-all duration-200"},{default:_(()=>[(o(),i("svg",me,[e("path",{d:t.mdiPencil,fill:"currentColor"},null,8,he)]))]),_:2},1032,["href"]),e("button",{onClick:N=>t.openCancelModal(a.id),class:"p-1.5 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/50 text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 transition-all duration-200"},[(o(),i("svg",ye,[e("path",{d:t.mdiClose,fill:"currentColor"},null,8,be)]))],8,ke)])])]))),128))])])])):(o(),i("div",fe," Không có đơn hàng nào ")),(v=n.orders)!=null&&v.links?(o(),i("div",ve,[k(m,{links:n.orders.links,class:"mt-6"},null,8,["links"])])):C("",!0)]),t.showCancelModal?(o(),i("div",we,[e("div",_e,[r[12]||(r[12]=e("div",{class:"fixed inset-0 bg-black/50 transition-opacity"},null,-1)),e("div",Ce,[r[11]||(r[11]=e("h3",{class:"text-lg font-medium text-gray-900 dark:text-dark-text mb-4"}," Xác nhận hủy đơn hàng ",-1)),S(e("textarea",{"onUpdate:modelValue":r[5]||(r[5]=a=>t.cancelReason=a),class:"w-full p-2 border rounded-md dark:bg-dark-surface dark:border-dark-border dark:text-dark-text",placeholder:"Nhập lý do hủy đơn hàng",rows:"3"},"            ",512),[[M,t.cancelReason]]),e("div",Se,[e("button",{onClick:r[6]||(r[6]=a=>t.showCancelModal=!1),class:"px-4 py-2 text-gray-700 dark:text-dark-text bg-gray-100 dark:bg-dark-surface-hover rounded-md hover:bg-gray-200 dark:hover:bg-dark-active transition-colors"}," Hủy bỏ "),e("button",{onClick:r[7]||(r[7]=(...a)=>t.cancelOrder&&t.cancelOrder(...a)),class:"px-4 py-2 text-white bg-red-600 dark:bg-red-700 rounded-md hover:bg-red-700 dark:hover:bg-red-800 transition-colors"}," Xác nhận ")])])])])):C("",!0)]}),_:1})]),_:1})}const bt=q(G,[["render",Te]]);export{bt as default};
