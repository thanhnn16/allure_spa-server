import{r as u,aU as s,a2 as o,a3 as t,aa as n,bl as w,a1 as y,bf as d,F as C,b0 as S,j as D,bM as O,o as Z,bH as f,bJ as W,bz as X,a0 as K,aI as Y,a9 as G}from"./@vue-BRgAy5zV.js";import{Z as tt}from"./@inertiajs-D0DMCEQB.js";import{L as et}from"./LayoutAuthenticated-BvAVfgDR.js";import{_ as at}from"./SectionMain-BbIPmLtw.js";import{_ as st}from"./CardBox-jfYP3QDG.js";import{_ as rt}from"./BaseButtons-B17KSMwc.js";import{_ as j}from"./BaseButton-eMTGofBM.js";import{_ as ot}from"./FormControl-BSsARiYM.js";import{k as F,aG as lt,aH as nt,w as it,aa as dt,aI as ct}from"./@mdi-BvzXeHmh.js";import{_ as T}from"./BaseIcon-B4kwkOCn.js";import{a as U}from"./axios-CCb-kr4I.js";import{u as ut}from"./vue-toastification-ejyjJRED.js";import{_ as mt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./deepmerge-CtOfIP5S.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./app-Bm8xTv_r.js";import"./jspdf-Ciebq7We.js";import"./@babel-BsCcpEdk.js";import"./fflate-EnPhvkmS.js";import"./laravel-echo-C9ppFO4I.js";import"./pusher-js-Cl-1XqxI.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./pinia-BhnhDyRZ.js";import"./firebase-DL3QX-oU.js";import"./@firebase--zA4YiqN.js";import"./idb-Bn1DMRyg.js";import"./colors-S7_1wET5.js";import"./OverlayLayer-BSs7OF78.js";import"./main-BNmBi4-k.js";const pt={class:"relative max-w-4xl w-full mx-4"},gt={class:"relative bg-black rounded-lg overflow-hidden"},xt=["src","alt"],ht={class:"absolute bottom-4 left-1/2 -translate-x-1/2 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm"},vt={key:0,class:"flex justify-center mt-4 gap-2 overflow-x-auto pb-2"},ft=["onClick"],yt=["src","alt"],kt={__name:"ImageGalleryModal",props:{images:{type:Array,required:!0},initialIndex:{type:Number,default:0}},emits:["close"],setup(m,{emit:I}){const g=m,c=I,l=u(g.initialIndex),k=()=>{l.value=(l.value+1)%g.images.length},x=()=>{l.value=(l.value-1+g.images.length)%g.images.length},_=p=>{p.key==="ArrowRight"&&k(),p.key==="ArrowLeft"&&x(),p.key==="Escape"&&c("close")};return onMounted(()=>{document.addEventListener("keydown",_)}),onBeforeUnmount(()=>{document.removeEventListener("keydown",_)}),(p,h)=>(s(),o("div",{class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75",onClick:h[1]||(h[1]=O($=>p.$emit("close"),["self"]))},[t("div",pt,[t("button",{class:"absolute -top-12 right-0 text-white hover:text-gray-300 transition-colors",onClick:h[0]||(h[0]=$=>p.$emit("close"))},[n(T,{path:w(F),class:"w-8 h-8"},null,8,["path"])]),t("div",gt,[t("img",{src:m.images[l.value].url,class:"max-h-[80vh] w-full object-contain",alt:`Image ${l.value+1} of ${m.images.length}`},null,8,xt),m.images.length>1?(s(),o("button",{key:0,class:"absolute left-0 top-1/2 -translate-y-1/2 p-2 text-white hover:text-gray-300 bg-black bg-opacity-50 rounded-r transition-colors",onClick:x},[n(T,{path:w(lt),class:"w-8 h-8"},null,8,["path"])])):y("",!0),m.images.length>1?(s(),o("button",{key:1,class:"absolute right-0 top-1/2 -translate-y-1/2 p-2 text-white hover:text-gray-300 bg-black bg-opacity-50 rounded-l transition-colors",onClick:k},[n(T,{path:w(nt),class:"w-8 h-8"},null,8,["path"])])):y("",!0),t("div",ht,d(l.value+1)+" / "+d(m.images.length),1)]),m.images.length>1?(s(),o("div",vt,[(s(!0),o(C,null,S(m.images,($,i)=>(s(),o("button",{key:i,class:D(["w-16 h-16 flex-shrink-0 rounded-lg overflow-hidden transition-transform hover:scale-105 focus:outline-none",{"ring-2 ring-blue-500":i===l.value}]),onClick:V=>l.value=i},[t("img",{src:$.url,class:"w-full h-full object-cover",alt:`Thumbnail ${i+1}`},null,8,yt)],10,ft))),128))])):y("",!0)])]))}},_t={class:"flex flex-col md:flex-row justify-between items-center mb-6"},bt={class:"flex items-center space-x-2"},wt={key:0,class:"animate-spin"},$t={class:"flex flex-col md:flex-row gap-4 mt-4 md:mt-0 w-full md:w-auto"},Ct={class:"relative"},It={class:"overflow-x-auto rounded-lg border dark:border-slate-700"},jt={class:"w-full"},St={class:"bg-white dark:bg-slate-900 divide-y dark:divide-slate-700"},Tt={class:"px-4 py-4 whitespace-nowrap"},Vt={class:"flex items-center"},Lt={class:"flex-shrink-0 h-10 w-10"},Dt=["src"],Et={class:"ml-4"},Nt={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},Mt={class:"text-sm text-gray-500 dark:text-gray-400"},zt={class:"px-4 py-4"},Bt={class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"},Rt={class:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100"},At={class:"px-4 py-4"},Kt={class:"flex space-x-1"},Gt={class:"px-4 py-4 text-sm text-gray-500 dark:text-gray-400 max-w-xs"},Ut={class:"truncate"},Ft={class:"px-4 py-4"},Ht={key:0,class:"flex items-center gap-2"},Pt={class:"flex -space-x-1"},Qt=["onClick"],qt=["src","alt"],Jt=["onClick"],Ot={key:1,class:"text-sm text-gray-400 dark:text-gray-600 italic"},Zt={class:"px-4 py-4 text-sm text-gray-500 dark:text-gray-400"},Wt={class:"px-4 py-4"},Xt={key:0,class:"flex space-x-2"},Yt={class:"flex justify-between items-center mt-6"},te={class:"text-sm text-gray-700 dark:text-gray-300"},ee={__name:"Index",setup(m){const I=u([]),g=u(!1),c=u(1),l=u(1),k=u(""),x=u(""),_=u(!1),p=u([]),h=u(0),$=ut(),i=async()=>{var r;g.value=!0;try{const e=await U.get("/api/ratings",{params:{page:c.value,status:k.value,search:x.value}});console.log("Rating response:",e.data),console.log("First rating media:",(r=e.data.data.data[0])==null?void 0:r.media_urls),I.value=e.data.data.data,l.value=e.data.data.last_page}catch(e){console.error("Error fetching ratings:",e),L("Không thể tải danh sách đánh giá","danger")}g.value=!1},V=async(r,e)=>{try{await U.patch(`/api/ratings/${r}/status`,{status:e}),L("Cập nhật trạng thái thành công","success"),await i()}catch(a){console.error("Error updating rating status:",a),L("Không thể cập nhật trạng thái","danger")}},L=(r,e="success")=>{$[e](r)},H=r=>Array(5).fill().map((e,a)=>a<r?dt:ct),P=r=>new Date(r).toLocaleDateString("vi-VN"),Q=r=>r==="product"?"SP":"DV",q=r=>({pending:"Chờ duyệt",approved:"Đã duyệt",rejected:"Đã từ chối"})[r]||r,E=(r,e=0)=>{p.value=r,h.value=e,_.value=!0},J=r=>{r.target.src="/path/to/fallback/image.jpg"};return Z(()=>{i()}),(r,e)=>(s(),o(C,null,[n(et,null,{default:f(()=>[n(w(tt),{title:"Quản lý đánh giá"}),n(at,null,{default:f(()=>[n(st,{class:"mb-6"},{default:f(()=>[t("div",_t,[t("div",bt,[e[6]||(e[6]=t("h1",{class:"text-2xl font-bold dark:text-gray-100"},"Quản lý đánh giá",-1)),g.value?(s(),o("span",wt,"⌛")):y("",!0)]),t("div",$t,[t("div",Ct,[n(ot,{modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=a=>x.value=a),placeholder:"Tìm kiếm theo tên khách hàng...",class:"min-w-[250px] dark:bg-slate-800 dark:border-slate-700 dark:text-gray-100",onInput:i},{rightIcon:f(()=>[x.value?(s(),o("span",{key:0,class:"cursor-pointer text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",onClick:e[0]||(e[0]=a=>{x.value="",i()})}," ✕ ")):y("",!0)]),_:1},8,["modelValue"])]),W(t("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>k.value=a),class:"rounded-lg border-gray-300 dark:bg-slate-800 dark:border-slate-700 dark:text-gray-100 focus:border-blue-500 focus:ring-blue-500 transition-colors duration-150",onChange:i},e[7]||(e[7]=[t("option",{value:""},"Tất cả",-1),t("option",{value:"pending"},"Chờ duyệt",-1),t("option",{value:"approved"},"Đã duyệt",-1),t("option",{value:"rejected"},"Đã từ chối",-1)]),544),[[X,k.value]])])]),t("div",It,[t("table",jt,[e[8]||(e[8]=t("thead",null,[t("tr",{class:"bg-gray-50 dark:bg-slate-800 border-b dark:border-slate-700"},[t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Khách hàng "),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Loại "),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Sản phẩm/Dịch vụ "),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Đánh giá "),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Bình luận "),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Hình ảnh "),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Ngày tạo "),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Trạng thái ")])],-1)),t("tbody",St,[(s(!0),o(C,null,S(I.value,a=>{var N,M,z,B,R,A;return s(),o("tr",{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-slate-800 transition-colors duration-150"},[t("td",Tt,[t("div",Vt,[t("div",Lt,[t("img",{class:"h-10 w-10 rounded-full",src:((N=a.user)==null?void 0:N.avatar_url)||"path/to/default/avatar.png",alt:""},null,8,Dt)]),t("div",Et,[t("div",Nt,d((M=a.user)==null?void 0:M.name),1),t("div",Mt,d((z=a.user)==null?void 0:z.email),1)])])]),t("td",zt,[t("span",Bt,d(Q(a.rating_type)),1)]),t("td",Rt,d(((B=a.item)==null?void 0:B.name)||((R=a.item)==null?void 0:R.service_name)),1),t("td",At,[t("div",Kt,[(s(!0),o(C,null,S(H(a.stars),(v,b)=>(s(),K(T,{key:b,path:v,class:D(["w-5 h-5",b<a.stars?"text-yellow-400":"text-gray-300 dark:text-gray-600"])},null,8,["path","class"]))),128))])]),t("td",Gt,[t("div",Ut,d(a.comment),1)]),t("td",Ft,[(A=a.media_urls)!=null&&A.length?(s(),o("div",Ht,[t("div",Pt,[(s(!0),o(C,null,S(a.media_urls.slice(0,3),(v,b)=>(s(),o("div",{key:v.id,class:"relative group cursor-pointer",onClick:ae=>E(a.media_urls,b)},[t("img",{src:v.url,class:"w-12 h-12 object-cover rounded-lg border-2 border-white dark:border-slate-800 transition-all duration-200 hover:z-10 hover:scale-110",style:Y({zIndex:b}),alt:`Ảnh đánh giá ${b+1}`,onError:J},null,44,qt)],8,Qt))),128))]),a.media_urls.length>3?(s(),o("span",{key:0,class:"text-sm text-gray-500 dark:text-gray-400 cursor-pointer hover:text-blue-500",onClick:v=>E(a.media_urls,3)}," +"+d(a.media_urls.length-3)+" ảnh khác ",9,Jt)):y("",!0)])):(s(),o("div",Ot," Không có ảnh "))]),t("td",Zt,d(P(a.created_at)),1),t("td",Wt,[a.status==="pending"?(s(),o("div",Xt,[n(j,{color:"success",icon:w(it),onClick:v=>V(a.id,"approved"),small:"",tooltip:"Duyệt đánh giá",class:"hover:scale-105 transition-transform duration-200"},null,8,["icon","onClick"]),n(j,{color:"danger",icon:w(F),onClick:v=>V(a.id,"rejected"),small:"",tooltip:"Từ chối đánh giá",class:"hover:scale-105 transition-transform duration-200"},null,8,["icon","onClick"])])):(s(),o("span",{key:1,class:D(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",{"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":a.status==="approved","bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":a.status==="rejected"}])},d(q(a.status)),3))])])}),128))])])]),t("div",Yt,[t("div",te," Trang "+d(c.value)+" / "+d(l.value),1),n(rt,null,{default:f(()=>[n(j,{disabled:c.value===1,onClick:e[3]||(e[3]=a=>{c.value--,i()}),color:c.value===1?"light":"info",class:"transition-all duration-200"},{default:f(()=>e[9]||(e[9]=[G(" Trước ")])),_:1},8,["disabled","color"]),n(j,{disabled:c.value===l.value,onClick:e[4]||(e[4]=a=>{c.value++,i()}),color:c.value===l.value?"light":"info",class:"transition-all duration-200"},{default:f(()=>e[10]||(e[10]=[G(" Sau ")])),_:1},8,["disabled","color"])]),_:1})])]),_:1})]),_:1})]),_:1}),_.value?(s(),K(kt,{key:0,images:p.value,"initial-index":h.value,onClose:e[5]||(e[5]=a=>_.value=!1)},null,8,["images","initial-index"])):y("",!0)],64))}},Oe=mt(ee,[["__scopeId","data-v-1e260bc2"]]);export{Oe as default};
