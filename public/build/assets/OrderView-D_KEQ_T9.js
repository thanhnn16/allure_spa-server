import{Z as P,F as h}from"./@inertiajs-D0DMCEQB.js";import{L as V}from"./LayoutAuthenticated-Bk4mopHR.js";import{_ as M}from"./SectionMain-BbIPmLtw.js";import{P as B}from"./Pagination-CjFMuWLP.js";import{r as g,aL as F,b2 as u,aU as d,a0 as H,bH as _,aa as y,a3 as t,a2 as i,bf as l,a1 as C,bJ as O,bz as A,bA as E,F as I,b0 as U,j as S,a9 as j}from"./@vue-BRgAy5zV.js";import{a as K}from"./axios-CCb-kr4I.js";import{d as z,e as Q,k as q}from"./@mdi-CTfBXXzV.js";import{u as G}from"./vue-toastification-ejyjJRED.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./deepmerge-CtOfIP5S.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./app-C72kzin2.js";import"./jspdf-Ciebq7We.js";import"./@babel-BsCcpEdk.js";import"./fflate-EnPhvkmS.js";import"./laravel-echo-C9ppFO4I.js";import"./pusher-js-Cl-1XqxI.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./pinia-BhnhDyRZ.js";import"./firebase-DL3QX-oU.js";import"./@firebase--zA4YiqN.js";import"./idb-Bn1DMRyg.js";import"./BaseIcon-B4kwkOCn.js";import"./colors-S7_1wET5.js";import"./OverlayLayer-BSs7OF78.js";const R={components:{Head:P,LayoutAuthenticated:V,SectionMain:M,Pagination:B},props:{orders:{type:Object,required:!0,default:()=>({data:[],links:[],meta:{}})},error:{type:String,default:null}},setup(T){const a=g({status:"",search:""}),o=g(null),e=G(),p=g(!1),c=g(""),m=g(null),k=()=>{o.value&&clearTimeout(o.value),o.value=setTimeout(()=>{x()},300)},x=()=>{h.get(route("orders.index"),{status:a.value.status,search:a.value.search},{preserveState:!0,preserveScroll:!0,replace:!0})};return F(()=>{o.value&&clearTimeout(o.value)}),{filters:a,formatCurrency:s=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(s),getStatusClass:s=>{const n="px-2 inline-flex text-xs leading-5 font-semibold rounded-full items-center transition-colors duration-150";return{pending:`${n} bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300`,confirmed:`${n} bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300`,shipping:`${n} bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300`,completed:`${n} bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300`,cancelled:`${n} bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300`}[s.toLowerCase()]||`${n} bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300`},getStatusDotClass:s=>({pending:"bg-yellow-400",confirmed:"bg-blue-400",shipping:"bg-purple-400",completed:"bg-green-400",cancelled:"bg-red-400"})[s.toLowerCase()]||"bg-gray-400",getStatusText:s=>({pending:"Chờ xác nhận",confirmed:"Đã xác nhận",shipping:"Đang giao hàng",completed:"Hoàn thành",cancelled:"Đã hủy"})[s.toLowerCase()]||"Không xác định",getPaymentStatusText:s=>{switch(s){case"pending":return"Chờ thanh toán";case"partial":return"Thanh toán một phần";case"paid":return"Đã thanh toán";case"cancelled":return"Đã hủy";default:return"Không xác định"}},getPaymentStatusClass:s=>({pending:"text-yellow-600",partial:"text-blue-600",paid:"text-green-600",cancelled:"text-red-600"})[s.toLowerCase()]||"text-gray-600",viewOrderDetails:s=>{h.visit(`/orders/${s}`)},createNewOrder:()=>{h.visit("/orders/create")},applyFilters:x,debounceSearch:k,showCancelModal:p,cancelReason:c,openCancelModal:s=>{m.value=s,c.value="",p.value=!0},cancelOrder:async()=>{var s,n;if(!c.value.trim()){e.error("Vui lòng nhập lý do hủy đơn hàng");return}try{await K.put(`/api/orders/${m.value}/cancel`,{reason:c.value}),e.success("Đơn hàng đã được hủy thành công"),p.value=!1,h.reload()}catch(w){console.error("Error cancelling order:",w),e.error(((n=(s=w.response)==null?void 0:s.data)==null?void 0:n.message)||"Có lỗi xảy ra khi hủy đơn hàng")}},formatDate:s=>new Date(s).toLocaleDateString("vi-VN"),mdiEye:z,mdiPencil:Q,mdiClose:q}}},Z={class:"container mx-auto px-4 py-8 dark:bg-dark-bg"},W={key:0,class:"mb-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded"},X={class:"flex justify-between items-center mb-6"},Y={class:"mb-6 flex flex-wrap items-center gap-4"},$={class:"flex items-center space-x-4 flex-grow"},tt={key:1,class:"overflow-x-auto bg-white dark:bg-dark-surface shadow-md rounded-lg"},et={class:"min-w-full divide-y divide-gray-200 dark:divide-dark-border"},rt={class:"bg-white dark:bg-dark-surface divide-y divide-gray-200 dark:divide-dark-border"},at={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-dark-text"},st={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ot={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},nt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},dt={class:"px-6 py-4 whitespace-nowrap"},it={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},lt={key:1,class:"text-yellow-600"},ct={class:"px-6 py-4 whitespace-nowrap text-sm"},gt={class:"flex space-x-2"},ut=["onClick"],pt={class:"w-5 h-5",viewBox:"0 0 24 24"},mt=["d"],xt={class:"w-5 h-5",viewBox:"0 0 24 24"},ht=["d"],yt=["onClick"],kt={class:"w-5 h-5",viewBox:"0 0 24 24"},ft=["d"],bt={key:2,class:"mt-6"};function vt(T,a,o,e,p,c){const m=u("Head"),k=u("Link"),x=u("Pagination"),D=u("SectionMain"),L=u("LayoutAuthenticated");return d(),H(L,null,{default:_(()=>[y(m,{title:"Quản lý đơn hàng"}),y(D,null,{default:_(()=>{var f,b,v;return[t("div",Z,[o.error?(d(),i("div",W,l(o.error),1)):C("",!0),t("div",X,[a[5]||(a[5]=t("h1",{class:"text-2xl font-semibold"},"Quản lý đơn hàng",-1)),t("button",{onClick:a[0]||(a[0]=(...r)=>e.createNewOrder&&e.createNewOrder(...r)),class:"bg-green-500 dark:bg-green-600 hover:bg-green-600 dark:hover:bg-green-700 text-white font-bold py-2 px-4 rounded transition-colors"}," Tạo đơn hàng mới ")]),t("div",Y,[t("div",$,[O(t("select",{"onUpdate:modelValue":a[1]||(a[1]=r=>e.filters.status=r),onChange:a[2]||(a[2]=(...r)=>e.applyFilters&&e.applyFilters(...r)),class:"form-select rounded-md shadow-sm w-48 dark:bg-dark-surface dark:border-dark-border dark:text-dark-text"},a[6]||(a[6]=[t("option",{value:""},"Tất cả trạng thái",-1),t("option",{value:"pending"},"Chờ xác nhận",-1),t("option",{value:"confirmed"},"Đã xác nhận",-1),t("option",{value:"shipping"},"Đang giao hàng",-1),t("option",{value:"completed"},"Hoàn thành",-1),t("option",{value:"cancelled"},"Đã hủy",-1)]),544),[[A,e.filters.status]]),O(t("input",{"onUpdate:modelValue":a[3]||(a[3]=r=>e.filters.search=r),onInput:a[4]||(a[4]=(...r)=>e.debounceSearch&&e.debounceSearch(...r)),type:"text",placeholder:"Tìm kiếm theo ID hoặc tên khách hàng",class:"form-input rounded-md shadow-sm flex-grow dark:bg-dark-surface dark:border-dark-border dark:text-dark-text"},null,544),[[E,e.filters.search]])])]),((b=(f=o.orders)==null?void 0:f.data)==null?void 0:b.length)>0?(d(),i("div",tt,[t("table",et,[a[7]||(a[7]=t("thead",null,[t("tr",null,[t("th",{class:"px-6 py-4 bg-gray-50 dark:bg-dark-surface text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Mã đơn hàng "),t("th",{class:"px-6 py-4 bg-gray-50 dark:bg-dark-surface text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Khách hàng "),t("th",{class:"px-6 py-4 bg-gray-50 dark:bg-dark-surface text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Tổng tiền "),t("th",{class:"px-6 py-4 bg-gray-50 dark:bg-dark-surface text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Giảm giá "),t("th",{class:"px-6 py-4 bg-gray-50 dark:bg-dark-surface text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Trạng thái "),t("th",{class:"px-6 py-4 bg-gray-50 dark:bg-dark-surface text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Thanh toán "),t("th",{class:"px-6 py-4 bg-gray-50 dark:bg-dark-surface text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Hành động ")])],-1)),t("tbody",rt,[(d(!0),i(I,null,U(o.orders.data,r=>(d(),i("tr",{key:r.id,class:"hover:bg-gray-50 dark:hover:bg-dark-bg/50"},[t("td",at," #"+l(r.id),1),t("td",st,l(r.user.full_name),1),t("td",ot,l(e.formatCurrency(r.total_amount)),1),t("td",nt,l(e.formatCurrency(r.discount_amount)),1),t("td",dt,[t("span",{class:S(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full items-center",e.getStatusClass(r.status)])},[t("span",{class:S(["h-2 w-2 rounded-full mr-2 self-center",e.getStatusDotClass(r.status)])},null,2),j(" "+l(e.getStatusText(r.status)),1)],2)]),t("td",it,[r.invoice?(d(),i("span",{key:0,class:S(e.getPaymentStatusClass(r.invoice.status))},l(e.getPaymentStatusText(r.invoice.status)),3)):(d(),i("span",lt,"Chưa thanh toán"))]),t("td",ct,[t("div",gt,[t("button",{onClick:N=>e.viewOrderDetails(r.id),class:"p-1.5 rounded-lg hover:bg-indigo-50 dark:hover:bg-indigo-900/50 text-indigo-600 dark:text-indigo-400 hover:text-indigo-700 dark:hover:text-indigo-300 transition-all duration-200"},[(d(),i("svg",pt,[t("path",{d:e.mdiEye,fill:"currentColor"},null,8,mt)]))],8,ut),y(k,{href:T.route("orders.edit",r.id),class:"p-1.5 rounded-lg hover:bg-emerald-50 dark:hover:bg-emerald-900/50 text-emerald-600 dark:text-emerald-400 hover:text-emerald-700 dark:hover:text-emerald-300 transition-all duration-200"},{default:_(()=>[(d(),i("svg",xt,[t("path",{d:e.mdiPencil,fill:"currentColor"},null,8,ht)]))]),_:2},1032,["href"]),t("button",{onClick:N=>e.openCancelModal(r.id),class:"p-1.5 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/50 text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 transition-all duration-200"},[(d(),i("svg",kt,[t("path",{d:e.mdiClose,fill:"currentColor"},null,8,ft)]))],8,yt)])])]))),128))])])])):C("",!0),(v=o.orders)!=null&&v.links?(d(),i("div",bt,[y(x,{links:o.orders.links,class:"mt-6"},null,8,["links"])])):C("",!0)])]}),_:1})]),_:1})}const me=J(R,[["render",vt]]);export{me as default};
