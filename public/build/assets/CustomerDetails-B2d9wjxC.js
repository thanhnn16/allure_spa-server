import{r as j,f as I,c as O,o as ce,e as Ct,aU as l,a0 as ut,bH as f,aa as d,bl as i,a3 as t,a2 as o,b0 as $,j as D,bf as r,F as V,bJ as x,bz as q,bx as me,a1 as w,a9 as N,bM as X,bA as U,bw as ct,aI as ge}from"./@vue-BRgAy5zV.js";import{r as J,s as Vt,t as mt,u as gt,v as pe,j as xe,i as he,d as Tt,b as $t,w as be,x as fe,e as ye,y as ve,z as jt,A as _e,n as pt,B as St,C as ke}from"./@mdi-ArhfA4cU.js";import{L as we}from"./LayoutAuthenticated-D078pk3d.js";import{_ as Ce}from"./SectionMain-Vot1TOkK.js";import{_ as Z}from"./CardBox-jfYP3QDG.js";import{_ as y}from"./BaseButton-eMTGofBM.js";import{_ as T}from"./BaseIcon-B4kwkOCn.js";import{Z as Ve}from"./@inertiajs-D0DMCEQB.js";import{u as Te}from"./vue-toastification-ejyjJRED.js";import{a as k}from"./axios-CCb-kr4I.js";import{_ as $e}from"./UserAvatar-l4ifIgfP.js";import{_ as je}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{f as Ut,p as Mt,v as Dt}from"./date-fns-9vLFlIJ3.js";import{S as W,Y as P,G as tt,V as et}from"./@headlessui-BdO8fvzs.js";import"./app-B23a1NkA.js";import"./jspdf-Ciebq7We.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./@babel-BsCcpEdk.js";import"./fflate-EnPhvkmS.js";import"./laravel-echo-C9ppFO4I.js";import"./pusher-js-Cl-1XqxI.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./pinia-BhnhDyRZ.js";import"./firebase-DL3QX-oU.js";import"./@firebase--zA4YiqN.js";import"./idb-Bn1DMRyg.js";import"./deepmerge-CtOfIP5S.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./colors-S7_1wET5.js";import"./OverlayLayer-BSs7OF78.js";const Se={class:"bg-white dark:bg-slate-900 rounded-lg shadow-md p-4 mb-6"},Ue={class:"flex space-x-2"},Me=["onClick"],De={class:"flex items-center space-x-2"},Ne={key:0,class:"space-y-6"},Ae={class:"flex flex-col md:flex-row md:items-start md:space-x-6"},Oe={class:"flex flex-col items-center space-y-3 mb-6 md:mb-0"},qe={class:"relative"},Ee={class:"text-center"},Ke={class:"text-xl font-bold dark:text-white"},Ge={class:"text-gray-600 dark:text-gray-400"},Le={class:"flex-1 grid grid-cols-2 md:grid-cols-4 gap-4"},He={class:"bg-blue-50 dark:bg-blue-900/30 p-4 rounded-lg"},Be={class:"flex items-center space-x-2"},Fe={class:"mt-2 text-2xl font-bold text-blue-700 dark:text-blue-300"},Ie={class:"bg-green-50 dark:bg-green-900/30 p-4 rounded-lg"},ze={class:"flex items-center space-x-2"},Re={class:"mt-2 text-2xl font-bold text-green-700 dark:text-green-300"},Qe={class:"bg-purple-50 dark:bg-purple-900/30 p-4 rounded-lg"},Ye={class:"flex items-center space-x-2"},Xe={class:"mt-2 text-2xl font-bold text-purple-700 dark:text-purple-300"},Je={class:"bg-orange-50 dark:bg-orange-900/30 p-4 rounded-lg"},Ze={class:"flex items-center space-x-2"},We={class:"mt-2 text-2xl font-bold text-orange-700 dark:text-orange-300"},Pe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ts={class:"space-y-4"},es={class:"flex-1"},ss={class:"text-sm text-gray-600 dark:text-gray-400"},as={class:"flex items-center gap-2"},rs=["onUpdate:modelValue"],ls=["value"],os=["onUpdate:modelValue","type"],ds={class:"flex-1"},ns={class:"font-medium dark:text-white"},is={key:0,class:"flex items-center mt-1"},us={class:"space-y-4"},cs={class:"flex-1"},ms={class:"text-sm text-gray-600 dark:text-gray-400"},gs={class:"font-medium dark:text-white"},ps={class:"p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-800"},xs={class:"font-medium dark:text-white mt-1"},hs={class:"flex justify-between items-center mb-6"},bs={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},fs={class:"flex justify-between"},ys={class:"space-y-2"},vs={class:"flex items-start space-x-2"},_s={class:"font-medium dark:text-white"},ks={class:"text-sm text-gray-600 dark:text-gray-400"},ws={class:"flex flex-wrap gap-2"},Cs={key:0,class:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 rounded-full"},Vs={key:1,class:"px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200 rounded-full"},Ts={class:"px-2 py-1 text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200 rounded-full"},$s={class:"flex space-x-2"},js={key:1,class:"text-center py-8 text-gray-500 dark:text-gray-400"},Ss={key:1,class:"space-y-6"},Us={class:"bg-white dark:bg-slate-900 rounded-lg shadow-md overflow-hidden"},Ms={class:"p-4 border-b dark:border-slate-700"},Ds={class:"flex justify-between items-center"},Ns={class:"bg-white dark:bg-slate-900 rounded-lg shadow-md overflow-hidden"},As={key:0,class:"p-8 text-center"},Os={key:1,class:"divide-y dark:divide-slate-700"},qs={class:"flex justify-between items-start mb-4"},Es={class:"flex items-center space-x-2"},Ks={class:"font-medium text-lg dark:text-white"},Gs={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},Ls={class:"font-medium text-lg text-primary-600 dark:text-primary-400"},Hs={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm mb-4"},Bs={class:"font-medium dark:text-white"},Fs={class:"font-medium dark:text-white"},Is={class:"font-medium dark:text-white"},zs={class:"font-medium dark:text-white"},Rs={class:"flex justify-end space-x-2"},Qs={class:"fixed inset-0 overflow-y-auto"},Ys={class:"flex min-h-full items-center justify-center p-4"},Xs={key:0,class:"space-y-4"},Js={class:"flex justify-between items-start"},Zs={class:"font-medium dark:text-white"},Ws={class:"text-sm text-gray-600 dark:text-gray-400"},Ps={class:"grid grid-cols-2 gap-4 text-sm"},ta={class:"font-medium dark:text-white"},ea={class:"font-medium dark:text-white"},sa={class:"font-medium dark:text-white"},aa={class:"font-medium dark:text-white"},ra={class:"font-medium dark:text-white"},la={class:"font-medium dark:text-white"},oa={class:"pt-4 border-t dark:border-gray-700"},da={class:"flex justify-between space-x-3"},na={key:2,class:"space-y-6"},ia={class:"bg-white dark:bg-slate-900 rounded-lg shadow-md overflow-hidden"},ua={key:0,class:"space-y-4"},ca={class:"p-4 border-b dark:border-slate-700 flex justify-between items-center"},ma={class:"text-sm text-gray-600 dark:text-gray-400"},ga={class:"text-sm text-gray-600 dark:text-gray-400"},pa={class:"text-right"},xa={class:"p-4 space-y-3"},ha={class:"flex items-center space-x-3"},ba={class:"flex-shrink-0"},fa=["src","alt"],ya={key:1,class:"w-12 h-12 bg-gray-200 dark:bg-slate-700 rounded-md flex items-center justify-center"},va={class:"font-medium dark:text-white"},_a={class:"text-sm text-gray-600 dark:text-gray-400"},ka={class:"font-medium dark:text-white"},wa={class:"p-4 bg-gray-50 dark:bg-slate-800 space-y-2"},Ca={class:"flex justify-between text-sm"},Va={class:"dark:text-white"},Ta={class:"flex justify-between text-sm"},$a={class:"text-green-600 dark:text-green-400"},ja={class:"flex justify-between font-medium pt-2 border-t dark:border-slate-700"},Sa={class:"text-lg text-primary-600 dark:text-primary-400"},Ua={key:0,class:"p-4 border-t dark:border-slate-700 flex justify-end space-x-3"},Ma={key:1,class:"bg-white dark:bg-slate-900 rounded-lg shadow-md p-8 text-center"},Da={class:"fixed inset-0 overflow-y-auto"},Na={class:"flex min-h-full items-center justify-center p-4"},Aa={class:"space-y-4"},Oa=["value"],qa=["value"],Ea=["value"],Ka={class:"flex items-center space-x-4"},Ga={class:"flex items-center"},La={class:"flex items-center"},Ha={class:"flex justify-end space-x-3 pt-4 border-t dark:border-gray-700"},Ba={class:"fixed inset-0 overflow-y-auto"},Fa={class:"flex min-h-full items-center justify-center p-4"},Ia={key:0},za=["value"],Ra={class:"flex justify-between space-x-3 pt-4"},Qa={class:"flex space-x-2"},Ya={key:1},Xa={class:"grid grid-cols-2 gap-4"},Ja={class:"flex items-center space-x-4"},Za={class:"flex items-center"},Wa={class:"flex justify-between space-x-3 pt-4"},Pa={key:3,class:"space-y-6"},tr={class:"bg-white dark:bg-slate-900 rounded-lg shadow-md overflow-hidden"},er={key:0,class:"divide-y dark:divide-slate-700 p-4"},sr={class:"flex justify-between items-start mb-4"},ar={class:"flex items-center space-x-2"},rr={class:"font-medium dark:text-white"},lr={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},or={class:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700 mb-4"},dr={class:"grid grid-cols-3 gap-4 text-sm mb-4"},nr={class:"font-medium dark:text-white"},ir={class:"font-medium dark:text-white"},ur={class:"font-medium dark:text-white"},cr={key:0,class:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg"},mr={class:"flex items-center space-x-2"},gr={class:"text-sm text-blue-800 dark:text-blue-300"},pr={key:1,class:"mt-4 p-4 bg-blue-50 dark:bg-blue-900/30 rounded-lg border border-blue-100 dark:border-blue-800"},xr={class:"flex items-start space-x-3"},hr={class:"flex-1"},br={class:"mt-1 space-y-1"},fr={class:"text-sm text-blue-800 dark:text-blue-300"},yr={class:"flex items-center text-sm text-blue-700 dark:text-blue-400"},vr={key:0,class:"flex items-center text-sm text-blue-700 dark:text-blue-400"},_r={key:2,class:"mt-4"},kr={class:"border-t dark:border-slate-700 pt-4"},wr={class:"space-y-3"},Cr={class:"flex justify-between items-start"},Vr={class:"text-sm text-gray-900 dark:text-white"},Tr={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},$r={class:"flex items-center space-x-2"},jr={class:"flex items-center space-x-2 mt-1"},Sr={key:0,class:"text-sm text-gray-600 dark:text-gray-400 text-right"},Ur={key:0,class:"mt-2 text-sm text-gray-600 dark:text-gray-400"},Mr={key:1,class:"p-6 text-center text-gray-600 dark:text-gray-400"},Dr={class:"bg-white dark:bg-slate-900 rounded-lg shadow-md overflow-hidden mt-6"},Nr={key:0,class:"divide-y dark:divide-slate-700 p-4"},Ar={class:"flex justify-between items-start mb-4"},Or={class:"flex items-center space-x-2"},qr={class:"font-medium dark:text-white"},Er={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},Kr={class:"grid grid-cols-3 gap-4 text-sm"},Gr={class:"font-medium dark:text-white"},Lr={class:"font-medium dark:text-white"},Hr={key:0,class:"mt-4"},Br={class:"border-t dark:border-slate-700 pt-4"},Fr={class:"space-y-3"},Ir={class:"flex justify-between items-start"},zr={class:"text-sm text-gray-900 dark:text-white"},Rr={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},Qr={class:"flex items-center space-x-2"},Yr={class:"flex items-center space-x-2 mt-1"},Xr={key:0,class:"text-sm text-gray-600 dark:text-gray-400 text-right"},Jr={key:0,class:"mt-2 text-sm text-gray-600 dark:text-gray-400"},Zr={key:1,class:"p-6 text-center text-gray-600 dark:text-gray-400"},Wr={class:"fixed inset-0 overflow-y-auto"},Pr={class:"flex min-h-full items-center justify-center p-4"},tl=["value"],el={class:"flex justify-end space-x-3 pt-4"},sl={__name:"CustomerDetails",props:{user:Object,upcomingBirthdays:Number},setup(Nt,{expose:At}){const c=Nt,v=Te(),Ot=[{id:"personal",label:"Thông tin cá nhân",icon:J},{id:"service_combos",label:"Combo dịch vụ",icon:J},{id:"invoices",label:"Đơn hàng",icon:gt},{id:"vouchers",label:"Vouchers",icon:ke}],G=j("personal");j(!1);const z=j(!1),E=j(null),xt=j([]),ht=j([]),bt=j([]),_=I({province:"",district:"",ward:"",address:"",address_type:"home",is_default:!1,is_temporary:!1}),st=j(!1),ft=j([]),K=I({voucher_id:"",total_uses:1}),H=j(!1),h=I({code:"",discount_type:"percentage",discount_value:0,min_order_value:0,max_discount_amount:0,usage_limit:1,start_date:new Date().toISOString().split("T")[0],end_date:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],is_unlimited:!1,uses_per_user:1,status:"active"}),at=j(!1),C=j(null),R=a=>{if(!a)return"";const e=new Date(a);return`${e.getDate().toString().padStart(2,"0")}/${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getFullYear()}`},qt=a=>{switch(a){case"male":return"Nam";case"female":return"Nữ";default:return"Khác"}},b=O(()=>c.user||{}),L=a=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(a),A=I({full_name:!1,phone_number:!1,email:!1,gender:!1,date_of_birth:!1}),Et=O(()=>{var a,e,n,g,p,s,u,m,M,B,F,wt;return[{label:"Họ và tên",key:"full_name",value:(a=c.user)==null?void 0:a.full_name,editValue:(e=c.user)==null?void 0:e.full_name,get isEditing(){return A.full_name}},{label:"Số điện thoại",key:"phone_number",value:(n=c.user)==null?void 0:n.phone_number,editValue:(g=c.user)==null?void 0:g.phone_number,get isEditing(){return A.phone_number},type:"tel",verified:(p=c.user)==null?void 0:p.phone_verified},{label:"Email",key:"email",value:(s=c.user)==null?void 0:s.email,editValue:(u=c.user)==null?void 0:u.email,get isEditing(){return A.email},type:"email",verified:(m=c.user)==null?void 0:m.email_verified},{label:"Giới tính",key:"gender",value:qt((M=c.user)==null?void 0:M.gender),editValue:(B=c.user)==null?void 0:B.gender,get isEditing(){return A.gender},type:"select",options:[{value:"male",label:"Nam"},{value:"female",label:"Nữ"},{value:"other",label:"Khác"}]},{label:"Ngày sinh",key:"date_of_birth",value:it((F=c.user)==null?void 0:F.date_of_birth),editValue:(wt=c.user)==null?void 0:wt.date_of_birth,get isEditing(){return A.date_of_birth},type:"date"}]}),Kt=O(()=>[{label:"Điểm tích lũy",value:b.value.point},{label:"Số lần mua hàng",value:b.value.purchase_count},{label:"Ngày tạo",value:R(b.value.created_at)},{label:"Ngày chỉnh sửa",value:R(b.value.updated_at)}]),Gt=()=>{E.value=null,yt(),z.value=!0},Lt=a=>{E.value=a,Object.assign(_,a),z.value=!0},rt=()=>{z.value=!1,yt()},yt=()=>{Object.assign(_,{province:"",district:"",ward:"",address:"",address_type:"home",is_default:!1,is_temporary:!1}),ht.value=[],bt.value=[]},Ht=async()=>{var a,e;try{const n={..._};E.value?await k.put(`/addresses/${E.value.id}`,n):(n.user_id=c.user.id,await k.post("/addresses",n));const g=await k.get(`/users/${c.user.id}`);Object.assign(c.user,g.data.data),rt(),v.success(`Đã ${E.value?"cập nhật":"thêm"} địa chỉ thành công`)}catch(n){v.error(((e=(a=n.response)==null?void 0:a.data)==null?void 0:e.message)||"Có lỗi xảy ra")}},Bt=async a=>{var e,n;if(confirm("Bạn có chắc muốn xóa địa chỉ này?"))try{await k.delete(`/addresses/${a.id}`);const g=await k.get(`/users/${c.user.id}`);Object.assign(c.user,g.data.data),v.success("Đã xóa địa chỉ thành công")}catch(g){v.error(((n=(e=g.response)==null?void 0:e.data)==null?void 0:n.message)||"Có lỗi xảy ra khi xóa địa chỉ")}},Ft=a=>{switch(a){case"home":return"Nhà riêng";case"work":return"Nơi làm việc";case"shipping":return"Địa chỉ giao hàng";case"others":return"Khác";default:return a}},Q=()=>{st.value=!1,H.value=!1,Rt()},It=async()=>{var a,e;try{await k.post("/vouchers/assign-to-user",{user_id:c.user.id,...K});const n=await k.get(`/vouchers/user/${c.user.id}/vouchers`);c.user.vouchers=n.data.data,Q(),v.success("Đã gán voucher thành công")}catch(n){v.error(((e=(a=n.response)==null?void 0:a.data)==null?void 0:e.message)||"Có lỗi xảy ra khi gán voucher")}},zt=async()=>{var a,e,n;try{if(!h.code||!h.discount_value)throw new Error("Vui lòng điền đầy đủ thông tin voucher");if(!((a=(await k.post("/vouchers",{...h,description:`Voucher created for user ${c.user.full_name}`})).data.data)!=null&&a.id))throw new Error("Không thể tạo voucher");const p=await k.get(`/vouchers/user/${c.user.id}/vouchers`);p.data.data&&(c.user.vouchers=p.data.data),H.value=!1,Q(),v.success("Đã tạo và gán voucher thành công")}catch(g){console.error("Error creating/assigning voucher:",g),v.error(((n=(e=g.response)==null?void 0:e.data)==null?void 0:n.message)||g.message||"Có lỗi xảy ra khi tạo và gán voucher")}},Rt=()=>{Object.assign(h,{code:"",discount_type:"percentage",discount_value:0,min_order_value:0,max_discount_amount:0,usage_limit:1,start_date:new Date().toISOString().split("T")[0],end_date:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],is_unlimited:!1,uses_per_user:1,status:"active"}),K.total_uses=1},Qt=async a=>{var e,n;if(confirm("Bạn có chắc muốn trả lại voucher này?"))try{await k.post("/api/vouchers/return",{user_id:c.user.id,voucher_id:a});const g=await k.get(`/vouchers/user/${c.user.id}/vouchers`);c.user.vouchers=g.data.data,v.success("Đã trả lại voucher thành công")}catch(g){v.error(((n=(e=g.response)==null?void 0:e.data)==null?void 0:n.message)||"Có lỗi xảy ra khi trả lại voucher")}},Yt=async()=>{var a,e;try{const n=await k.get(`/vouchers/user/${c.user.id}/vouchers`);n.data.data&&(c.user.vouchers=n.data.data)}catch(n){console.error("Error fetching vouchers:",n),v.error(((e=(a=n.response)==null?void 0:a.data)==null?void 0:e.message)||"Không thể tải danh sách voucher")}};ce(()=>{var a;(a=c.user)!=null&&a.id&&(Yt(),oe())});const Xt=async()=>{var a,e;try{const n=await k.get("/vouchers");n.data.success&&(ft.value=n.data.data)}catch(n){console.error("Error loading vouchers:",n),v.error(((e=(a=n.response)==null?void 0:a.data)==null?void 0:e.message)||"Không thể tải danh sách voucher")}},Jt=async()=>{st.value=!0,await Xt()},Zt=a=>{switch(a){case"pending":return"Chờ xử lý";case"processing":return"Đang xử lý";case"completed":return"Hoàn thành";case"cancelled":return"Đã hủy";default:return a}},Wt=async a=>{var e,n;if(confirm("Bạn có chắc muốn hủy đơn hàng này?"))try{const g=await k.delete(`/api/orders/${a}/cancel`),p=await k.get(`/users/${c.user.id}`);Object.assign(c.user,p.data.data),v.success("Đã hủy đơn hàng thành công")}catch(g){v.error(((n=(e=g.response)==null?void 0:e.data)==null?void 0:n.message)||"Có lỗi xảy ra khi hủy đơn hàng")}},Y=O(()=>{var a;return(a=b.value)!=null&&a.user_service_packages?b.value.user_service_packages.filter(e=>e&&(e.status==="active"||e.status==="pending")).sort((e,n)=>e.status==="pending"&&n.status!=="pending"?-1:e.status!=="pending"&&n.status==="pending"?1:new Date(e.expiry_date)-new Date(n.expiry_date)):[]}),lt=O(()=>{var a;return(a=b.value)!=null&&a.user_service_packages?b.value.user_service_packages.filter(e=>e.status==="completed").sort((e,n)=>new Date(n.updated_at)-new Date(e.updated_at)):[]}),Pt=O(()=>lt.value.length),te=O(()=>Y.value.length);O(()=>{const a=Y.value.map(e=>e.next_appointment).filter(Boolean).sort((e,n)=>new Date(e.appointment_date)-new Date(n.appointment_date))[0];return a?R(a.appointment_date):null});const ee=a=>{C.value=a,at.value=!0},vt=()=>{at.value=!1,C.value=null},se=async a=>{var e,n,g;try{const p=await k.post(`/api/vouchers/${a}/toggle-status`);if(p.data.success){const s=c.user.vouchers.findIndex(u=>u.id===a);s!==-1&&(c.user.vouchers[s]=p.data.data),((e=C.value)==null?void 0:e.id)===a&&(C.value=p.data.data),v.success(p.data.message)}}catch(p){v.error(((g=(n=p.response)==null?void 0:n.data)==null?void 0:g.message)||"Có lỗi xảy ra khi cập nhật trạng thái voucher")}},ot=j(!1),S=I({staff_user_id:"",start_time:"",end_time:"",result:"",notes:""}),_t=j(null),ae=async a=>{_t.value=a,ot.value=!0,await le(),Object.assign(S,{staff_user_id:"",start_time:"",end_time:"",result:"",notes:""})},dt=()=>{ot.value=!1},re=async()=>{var a,e,n;try{const g=await k.post("/api/treatment-sessions",{...S,user_service_package_id:_t.value.id}),p=await k.get(`/users/${c.user.id}`);Object.assign(c.user,p.data.data),dt(),v.success("Thêm lịch sử dịch vụ thành công")}catch(g){console.error("Treatment form:",S),console.error("Error submitting treatment session:",(a=g.response)==null?void 0:a.data),v.error(((n=(e=g.response)==null?void 0:e.data)==null?void 0:n.message)||"Có lỗi xảy ra khi thêm lịch sử dịch vụ")}},kt=j([]),le=async()=>{try{const a=await k.get("/api/users/get-staff-list");kt.value=a.data.data}catch(a){console.error("Error loading staff:",a),v.error("Không thể tải danh sách nhân viên")}},nt=a=>a?Ut(Mt(a),"HH:mm - dd/MM/yyyy",{locale:Dt}):"",it=a=>a?Ut(Mt(a),"dd/MM/yyyy",{locale:Dt}):"";At({formatDateTime:nt,formatDate:it,formatTime:a=>{if(!a)return"";const[e,n]=a.split(":");return`${e}:${n}`}}),Ct(()=>_.is_default,a=>{a&&(_.is_temporary=!1)}),Ct(()=>_.is_temporary,a=>{a&&(_.is_default=!1)});const oe=async()=>{try{const a=await k.get("/api/address/provinces");xt.value=a.data.data}catch(a){console.error("Error loading provinces:",a)}},de=a=>{a.editValue=c.user[a.key],A[a.key]=!0},ne=a=>{A[a.key]=!1,a.editValue=c.user[a.key]},ie=async(a,e)=>{var n,g;try{const p=await k.patch(`/users/${c.user.id}`,{[a]:e});p.data.data&&(Object.assign(c.user,p.data.data),A[a]=!1,v.success("Đã cập nhật thông tin thành công"))}catch(p){console.error("Update error:",p),v.error(((g=(n=p.response)==null?void 0:n.data)==null?void 0:g.message)||"Có lỗi xảy ra khi cập nhật thông tin")}},ue=async a=>{if(a.editValue)try{await ie(a.key,a.editValue)}catch(e){console.error("Update error:",e)}finally{a.isEditing=!1}};return(a,e)=>(l(),ut(we,null,{default:f(()=>[d(i(Ve),{title:"Chi tiết khách hàng"}),d(Ce,{breadcrumbs:[{label:"Quản lý khách hàng",href:a.route("users.index")},{label:b.value.full_name}]},{default:f(()=>{var n,g,p;return[t("div",Se,[t("div",Ue,[(l(),o(V,null,$(Ot,s=>t("button",{key:s.id,onClick:u=>G.value=s.id,class:D(["px-4 py-2 rounded-md transition-all duration-200",[G.value===s.id?"bg-blue-500 text-white shadow-md":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-800"]])},[t("div",De,[d(T,{path:s.icon,class:"w-5 h-5"},null,8,["path"]),t("span",null,r(s.label),1)])],10,Me)),64))])]),G.value==="personal"?(l(),o("div",Ne,[d(Z,{class:"!p-6 dark:bg-slate-900"},{default:f(()=>[t("div",Ae,[t("div",Oe,[t("div",qe,[d($e,{fullName:b.value.full_name,avatarUrl:b.value.avatar_url,size:"3xl"},null,8,["fullName","avatarUrl"])]),t("div",Ee,[t("h2",Ke,r(b.value.full_name),1),t("p",Ge,r(b.value.phone_number),1)])]),t("div",Le,[t("div",He,[t("div",Be,[d(T,{path:i(J),class:"w-6 h-6 text-blue-600 dark:text-blue-400"},null,8,["path"]),e[26]||(e[26]=t("span",{class:"text-sm text-blue-600 dark:text-blue-400"},"Liệu trình",-1))]),t("p",Fe,r(te.value),1),e[27]||(e[27]=t("p",{class:"text-sm text-blue-600 dark:text-blue-400"},"Đang thực hiện",-1))]),t("div",Ie,[t("div",ze,[d(T,{path:i(Vt),class:"w-6 h-6 text-green-600 dark:text-green-400"},null,8,["path"]),e[28]||(e[28]=t("span",{class:"text-sm text-green-600 dark:text-green-400"},"Hoàn thành",-1))]),t("p",Re,r(Pt.value),1),e[29]||(e[29]=t("p",{class:"text-sm text-green-600 dark:text-green-400"},"Liệu trình",-1))]),t("div",Qe,[t("div",Ye,[d(T,{path:i(mt),class:"w-6 h-6 text-purple-600 dark:text-purple-400"},null,8,["path"]),e[30]||(e[30]=t("span",{class:"text-sm text-purple-600 dark:text-purple-400"},"Điểm",-1))]),t("p",Xe,r(b.value.point||0),1),e[31]||(e[31]=t("p",{class:"text-sm text-purple-600 dark:text-purple-400"},"Tích lũy",-1))]),t("div",Je,[t("div",Ze,[d(T,{path:i(gt),class:"w-6 h-6 text-orange-600 dark:text-orange-400"},null,8,["path"]),e[32]||(e[32]=t("span",{class:"text-sm text-orange-600 dark:text-orange-400"},"Đơn hàng",-1))]),t("p",We,r(b.value.purchase_count||0),1),e[33]||(e[33]=t("p",{class:"text-sm text-orange-600 dark:text-orange-400"},"Tổng số",-1))])])])]),_:1}),t("div",Pe,[d(Z,{class:"!p-6 dark:bg-slate-900"},{default:f(()=>[e[34]||(e[34]=t("div",{class:"flex justify-between items-center mb-4"},[t("h3",{class:"text-lg font-semibold dark:text-white"},"Thông tin cơ bản")],-1)),t("div",ts,[(l(!0),o(V,null,$(Et.value,(s,u)=>(l(),o("div",{key:u,class:"flex items-center p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-800 transition-colors"},[t("div",es,[t("p",ss,r(s.label),1),t("div",as,[s.isEditing?(l(),o(V,{key:0},[s.type==="select"?x((l(),o("select",{key:0,"onUpdate:modelValue":m=>s.editValue=m,class:"flex-1 rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500"},[(l(!0),o(V,null,$(s.options,m=>(l(),o("option",{key:m.value,value:m.value},r(m.label),9,ls))),128))],8,rs)),[[q,s.editValue]]):x((l(),o("input",{key:1,"onUpdate:modelValue":m=>s.editValue=m,type:s.type||"text",class:"flex-1 rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,8,os)),[[me,s.editValue]]),d(y,{color:"success",icon:i(pe),small:"",onClick:m=>ue(s)},null,8,["icon","onClick"]),d(y,{color:"danger",icon:i(xe),small:"",onClick:m=>ne(s)},null,8,["icon","onClick"])],64)):(l(),o(V,{key:1},[t("div",ds,[t("p",ns,r(s.value),1),["email","phone_number"].includes(s.key)?(l(),o("div",is,[d(T,{path:s.verified?i(Vt):i(he),class:D([s.verified?"text-green-500":"text-red-500","w-4 h-4"])},null,8,["path","class"]),t("span",{class:D([s.verified?"text-green-500":"text-red-500","text-sm ml-1"])},r(s.verified?"Đã xác thực":"Chưa xác thực"),3)])):w("",!0)]),d(y,{color:"info",icon:i(Tt),small:"",onClick:m=>de(s)},null,8,["icon","onClick"])],64))])])]))),128))])]),_:1}),d(Z,{class:"!p-6 dark:bg-slate-900"},{default:f(()=>[e[36]||(e[36]=t("div",{class:"flex justify-between items-center mb-4"},[t("h3",{class:"text-lg font-semibold dark:text-white"},"Thông tin bổ sung")],-1)),t("div",us,[(l(!0),o(V,null,$(Kt.value,(s,u)=>(l(),o("div",{key:u,class:"flex items-center p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-800 transition-colors"},[t("div",cs,[t("p",ms,r(s.label),1),t("p",gs,r(s.value),1)])]))),128)),t("div",ps,[e[35]||(e[35]=t("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Ghi chú",-1)),t("p",xs,r(b.value.note||"Không có ghi chú"),1)])])]),_:1})]),d(Z,{class:"!p-6 dark:bg-slate-900"},{default:f(()=>{var s;return[t("div",hs,[e[37]||(e[37]=t("h3",{class:"text-lg font-semibold dark:text-white"},"Địa chỉ",-1)),d(y,{label:"Thêm địa chỉ",color:"info",onClick:Gt,icon:i($t),small:""},null,8,["icon"])]),(s=b.value.addresses)!=null&&s.length?(l(),o("div",bs,[(l(!0),o(V,null,$(b.value.addresses,u=>(l(),o("div",{key:u.id,class:D(["p-4 rounded-lg border dark:border-slate-700 hover:shadow-md transition-shadow relative",{"border-blue-500 dark:border-blue-400 bg-blue-50 dark:bg-blue-900/30":u.is_default}])},[t("div",fs,[t("div",ys,[t("div",vs,[d(T,{path:u.address_type==="home"?i(be):i(fe),class:"w-5 h-5 text-gray-500 dark:text-gray-400"},null,8,["path"]),t("div",null,[t("p",_s,r(u.address),1),t("p",ks,r(u.district)+", "+r(u.province),1)])]),t("div",ws,[u.is_default?(l(),o("span",Cs," Mặc định ")):w("",!0),u.is_temporary?(l(),o("span",Vs," Tạm thời ")):w("",!0),t("span",Ts,r(Ft(u.address_type)),1)])]),t("div",$s,[d(y,{color:"info",icon:i(Tt),small:"",onClick:m=>Lt(u)},null,8,["icon","onClick"]),d(y,{color:"danger",icon:i(ye),small:"",onClick:m=>Bt(u)},null,8,["icon","onClick"])])])],2))),128))])):(l(),o("div",js,[d(T,{path:i(ve),class:"w-12 h-12 mx-auto mb-3 opacity-50"},null,8,["path"]),e[38]||(e[38]=t("p",null,"Chưa có địa chỉ nào được thêm",-1))]))]}),_:1})])):w("",!0),G.value==="vouchers"?(l(),o("div",Ss,[t("div",Us,[t("div",Ms,[t("div",Ds,[e[39]||(e[39]=t("h3",{class:"text-lg font-medium leading-6 dark:text-white"},"Danh sách voucher",-1)),d(y,{label:"Gán voucher",color:"info",onClick:Jt,icon:i(mt),small:""},null,8,["icon"])])]),t("div",Ns,[(n=b.value.vouchers)!=null&&n.length?(l(),o("div",Os,[(l(!0),o(V,null,$(b.value.vouchers,s=>(l(),o("div",{key:s.id,class:"p-6 hover:bg-gray-50 dark:hover:bg-slate-800/50 transition-colors"},[t("div",qs,[t("div",null,[t("div",Es,[t("h4",Ks,r(s.code),1),t("span",{class:D({"px-2 py-1 text-xs font-medium rounded-full":!0,"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300":s.status==="active","bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300":s.status==="inactive"})},r(s.status==="active"?"Đang kích hoạt":"Đã vô hiệu"),3)]),t("p",Gs,r(s.description||"Không có mô tả"),1)]),t("p",Ls,r(s.formatted_discount),1)]),t("div",Hs,[t("div",null,[e[42]||(e[42]=t("p",{class:"text-gray-600 dark:text-gray-400"},"Đơn tối thiểu",-1)),t("p",Bs,r(s.min_order_value_formatted),1)]),t("div",null,[e[43]||(e[43]=t("p",{class:"text-gray-600 dark:text-gray-400"},"Giảm tối đa",-1)),t("p",Fs,r(s.max_discount_amount_formatted),1)]),t("div",null,[e[44]||(e[44]=t("p",{class:"text-gray-600 dark:text-gray-400"},"Lần sử dụng còn lại",-1)),t("p",Is,r(s.remaining_uses),1)]),t("div",null,[e[45]||(e[45]=t("p",{class:"text-gray-600 dark:text-gray-400"},"Hiệu lực đến",-1)),t("p",zs,r(s.end_date_formatted),1)])]),t("div",Rs,[d(y,{label:"Chi tiết",color:"info",small:"",onClick:u=>ee(s)},null,8,["onClick"]),s.remaining_uses>0?(l(),ut(y,{key:0,label:"Trả lại voucher",color:"danger",small:"",onClick:u=>Qt(s.id)},null,8,["onClick"])):w("",!0)])]))),128))])):(l(),o("div",As,[d(T,{path:i(mt),class:"w-16 h-16 mx-auto text-gray-400 dark:text-gray-500"},null,8,["path"]),e[40]||(e[40]=t("h3",{class:"mt-4 text-lg font-medium dark:text-white"}," Chưa có voucher nào ",-1)),e[41]||(e[41]=t("p",{class:"mt-2 text-gray-600 dark:text-gray-400"}," Khách hàng chưa được gán voucher nào. ",-1))]))])])])):w("",!0),d(i(W),{appear:"",show:at.value,as:"template"},{default:f(()=>[d(i(P),{as:"div",onClose:vt,class:"relative z-50"},{default:f(()=>[e[53]||(e[53]=t("div",{class:"fixed inset-0 bg-black/30 dark:bg-black/50"},null,-1)),t("div",Qs,[t("div",Ys,[d(i(tt),{class:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white dark:bg-slate-900 p-6 shadow-xl transition-all"},{default:f(()=>[d(i(et),{as:"h3",class:"text-lg font-medium leading-6 text-gray-900 dark:text-white mb-4"},{default:f(()=>e[46]||(e[46]=[N(" Chi tiết Voucher ")])),_:1}),C.value?(l(),o("div",Xs,[t("div",Js,[t("div",null,[t("h4",Zs,r(C.value.code),1),t("p",Ws,r(C.value.description||"Không có mô tả"),1)]),t("div",{class:D({"px-2 py-1 text-xs font-medium rounded-full":!0,"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300":C.value.status==="active","bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300":C.value.status==="inactive"})},r(C.value.status==="active"?"Đang kích hoạt":"Đã vô hiệu"),3)]),t("div",Ps,[t("div",null,[e[47]||(e[47]=t("p",{class:"text-gray-600 dark:text-gray-400"},"Loại giảm giá",-1)),t("p",ta,r(C.value.discount_type==="percentage"?"Phần trăm":"Số tiền cố định"),1)]),t("div",null,[e[48]||(e[48]=t("p",{class:"text-gray-600 dark:text-gray-400"},"Giá trị giảm",-1)),t("p",ea,r(C.value.formatted_discount),1)]),t("div",null,[e[49]||(e[49]=t("p",{class:"text-gray-600 dark:text-gray-400"},"Đơn tối thiểu",-1)),t("p",sa,r(C.value.min_order_value_formatted),1)]),t("div",null,[e[50]||(e[50]=t("p",{class:"text-gray-600 dark:text-gray-400"},"Giảm tối đa",-1)),t("p",aa,r(C.value.max_discount_amount_formatted),1)]),t("div",null,[e[51]||(e[51]=t("p",{class:"text-gray-600 dark:text-gray-400"},"Ngày bắt đầu",-1)),t("p",ra,r(C.value.start_date_formatted),1)]),t("div",null,[e[52]||(e[52]=t("p",{class:"text-gray-600 dark:text-gray-400"},"Ngày kết thúc",-1)),t("p",la,r(C.value.end_date_formatted),1)])]),t("div",oa,[t("div",da,[d(y,{type:"button",label:C.value.status==="active"?"Vô hiệu hóa":"Kích hoạt",color:C.value.status==="active"?"danger":"success",onClick:e[0]||(e[0]=s=>se(C.value.id))},null,8,["label","color"]),d(y,{type:"button",label:"Đóng",color:"white",onClick:vt})])])])):w("",!0)]),_:1})])])]),_:1})]),_:1},8,["show"]),G.value==="invoices"?(l(),o("div",na,[t("div",ia,[e[59]||(e[59]=t("div",{class:"p-4 border-b dark:border-slate-700"},[t("h3",{class:"text-lg font-medium leading-6 dark:text-white"},"Lịch sử đơn hàng")],-1)),(g=b.value.orders)!=null&&g.length?(l(),o("div",ua,[(l(!0),o(V,null,$(b.value.orders,s=>(l(),o("div",{key:s.id,class:"bg-white dark:bg-slate-900 rounded-lg shadow-md overflow-hidden"},[t("div",ca,[t("div",null,[t("p",ma," Mã đơn hàng: #"+r(s.id),1),t("p",ga,r(R(s.created_at)),1)]),t("div",pa,[t("span",{class:D({"px-2 py-1 text-xs font-medium rounded-full":!0,"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":s.status==="pending","bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":s.status==="processing","bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":s.status==="completed","bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":s.status==="cancelled"})},r(Zt(s.status)),3)])]),t("div",xa,[(l(!0),o(V,null,$(s.order_items,u=>{var m,M,B,F;return l(),o("div",{key:u.id,class:"flex justify-between items-center py-2"},[t("div",ha,[t("div",ba,[(m=u.product)!=null&&m.image_url?(l(),o("img",{key:0,src:u.product.image_url,alt:(M=u.product)==null?void 0:M.name,class:"w-12 h-12 object-cover rounded-md"},null,8,fa)):(l(),o("div",ya,[d(T,{path:i(J),class:"w-6 h-6 text-gray-400 dark:text-gray-500"},null,8,["path"])]))]),t("div",null,[t("p",va,r(((B=u.product)==null?void 0:B.name)||((F=u.service)==null?void 0:F.service_name)||"Sản phẩm đã xóa"),1),t("p",_a,r(L(u.price))+" x "+r(u.quantity),1)])]),t("p",ka,r(L(u.price*u.quantity)),1)])}),128))]),t("div",wa,[t("div",Ca,[e[54]||(e[54]=t("span",{class:"text-gray-600 dark:text-gray-400"},"Tạm tính",-1)),t("span",Va,r(L(s.total_amount)),1)]),t("div",Ta,[e[55]||(e[55]=t("span",{class:"text-gray-600 dark:text-gray-400"},"Giảm giá",-1)),t("span",$a," -"+r(L(s.discount_amount)),1)]),t("div",ja,[e[56]||(e[56]=t("span",{class:"dark:text-white"},"Tổng cộng",-1)),t("span",Sa,r(L(s.total_amount-s.discount_amount)),1)])]),s.status==="pending"?(l(),o("div",Ua,[d(y,{label:"Hủy đơn",color:"danger",onClick:u=>Wt(s.id),loading:s.loading},null,8,["onClick","loading"])])):w("",!0)]))),128))])):(l(),o("div",Ma,[d(T,{path:i(gt),class:"w-16 h-16 mx-auto text-gray-400 dark:text-gray-500"},null,8,["path"]),e[57]||(e[57]=t("h3",{class:"mt-4 text-lg font-medium dark:text-white"}," Chưa có đơn hàng nào ",-1)),e[58]||(e[58]=t("p",{class:"mt-2 text-gray-600 dark:text-gray-400"}," Khách hàng chưa thc hiện đơn hàng nào. ",-1))]))])])):w("",!0),d(i(W),{appear:"",show:z.value,as:"template"},{default:f(()=>[d(i(P),{as:"div",onClose:rt,class:"relative z-50"},{default:f(()=>[t("div",Da,[t("div",Na,[d(i(tt),{class:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white dark:bg-slate-900 p-6 shadow-xl transition-all"},{default:f(()=>[d(i(et),{as:"h3",class:"text-lg font-medium leading-6 text-gray-900 dark:text-white mb-4"},{default:f(()=>[N(r(E.value?"Sửa địa chỉ":"Thêm địa chỉ mới"),1)]),_:1}),t("form",{onSubmit:X(Ht,["prevent"]),class:"space-y-4"},[t("div",Aa,[t("div",null,[e[61]||(e[61]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Tỉnh/Thành phố * ",-1)),x(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>_.province=s),required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},[e[60]||(e[60]=t("option",{value:""},"-- Chọn tỉnh/thành phố --",-1)),(l(!0),o(V,null,$(xt.value,s=>(l(),o("option",{key:s.code,value:s.code},r(s.name),9,Oa))),128))],512),[[q,_.province]])]),t("div",null,[e[63]||(e[63]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Quận/Huyện * ",-1)),x(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>_.district=s),required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},[e[62]||(e[62]=t("option",{value:""},"-- Chọn quận/huyện --",-1)),(l(!0),o(V,null,$(ht.value,s=>(l(),o("option",{key:s.code,value:s.code},r(s.name),9,qa))),128))],512),[[q,_.district]])]),t("div",null,[e[65]||(e[65]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Phường/Xã * ",-1)),x(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>_.ward=s),required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},[e[64]||(e[64]=t("option",{value:""},"-- Chọn phường/xã --",-1)),(l(!0),o(V,null,$(bt.value,s=>(l(),o("option",{key:s.code,value:s.code},r(s.name),9,Ea))),128))],512),[[q,_.ward]])]),t("div",null,[e[66]||(e[66]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Đa chỉ chi tiết * ",-1)),x(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>_.address=s),type:"text",required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500",placeholder:"Số nhà, tên đường, phường/xã"},null,512),[[U,_.address]])]),t("div",null,[e[68]||(e[68]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Loại địa chỉ ",-1)),x(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>_.address_type=s),class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},e[67]||(e[67]=[t("option",{value:"home"},"Nhà riêng",-1),t("option",{value:"work"},"Nơi làm việc",-1),t("option",{value:"shipping"},"Địa chỉ giao hàng",-1),t("option",{value:"others"},"Khác",-1)]),512),[[q,_.address_type]])]),t("div",Ka,[t("div",Ga,[x(t("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=s=>_.is_default=s),id:"is_default",class:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500"},null,512),[[ct,_.is_default]]),e[69]||(e[69]=t("label",{for:"is_default",class:"ml-2 text-sm text-gray-700 dark:text-gray-300"}," Đặt làm địa chỉ mặc định ",-1))]),t("div",La,[x(t("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=s=>_.is_temporary=s),id:"is_temporary",class:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500"},null,512),[[ct,_.is_temporary]]),e[70]||(e[70]=t("label",{for:"is_temporary",class:"ml-2 text-sm text-gray-700 dark:text-gray-300"}," Địa chỉ tạm thời ",-1))])])]),t("div",Ha,[d(y,{type:"button",label:"Hủy",color:"white",onClick:rt}),d(y,{type:"submit",label:E.value?"Cập nhật":"Thêm mới",color:"info"},null,8,["label"])])],32)]),_:1})])])]),_:1})]),_:1},8,["show"]),d(i(W),{appear:"",show:st.value,as:"template"},{default:f(()=>[d(i(P),{as:"div",onClose:Q,class:"relative z-50"},{default:f(()=>[t("div",Ba,[t("div",Fa,[d(i(tt),{class:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white dark:bg-slate-900 p-6 shadow-xl transition-all"},{default:f(()=>[d(i(et),{as:"h3",class:"text-lg font-medium leading-6 text-gray-900 dark:text-white mb-4"},{default:f(()=>e[71]||(e[71]=[N(" Gán voucher cho khách hàng ")])),_:1}),H.value?(l(),o("div",Ya,[t("form",{onSubmit:X(zt,["prevent"]),class:"space-y-4"},[t("div",null,[e[75]||(e[75]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Mã voucher * ",-1)),x(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>h.code=s),type:"text",required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[U,h.code]])]),t("div",null,[e[77]||(e[77]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Loại giảm giá * ",-1)),x(t("select",{"onUpdate:modelValue":e[12]||(e[12]=s=>h.discount_type=s),required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},e[76]||(e[76]=[t("option",{value:"percentage"},"Phần trăm",-1),t("option",{value:"fixed"},"Số tiền cố định",-1)]),512),[[q,h.discount_type]])]),t("div",null,[e[78]||(e[78]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Giá trị giảm * ",-1)),x(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>h.discount_value=s),type:"number",required:"",min:"0",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[U,h.discount_value,void 0,{number:!0}]])]),t("div",null,[e[79]||(e[79]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Giá trị đơn hàng tối thiểu ",-1)),x(t("input",{"onUpdate:modelValue":e[14]||(e[14]=s=>h.min_order_value=s),type:"number",min:"0",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[U,h.min_order_value,void 0,{number:!0}]])]),t("div",null,[e[80]||(e[80]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Giảm giá tối đa ",-1)),x(t("input",{"onUpdate:modelValue":e[15]||(e[15]=s=>h.max_discount_amount=s),type:"number",min:"0",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[U,h.max_discount_amount,void 0,{number:!0}]])]),t("div",Xa,[t("div",null,[e[81]||(e[81]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Ngày bắt đầu * ",-1)),x(t("input",{"onUpdate:modelValue":e[16]||(e[16]=s=>h.start_date=s),type:"date",required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[U,h.start_date]])]),t("div",null,[e[82]||(e[82]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Ngày kết thúc * ",-1)),x(t("input",{"onUpdate:modelValue":e[17]||(e[17]=s=>h.end_date=s),type:"date",required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[U,h.end_date]])])]),t("div",Ja,[t("div",Za,[x(t("input",{type:"checkbox","onUpdate:modelValue":e[18]||(e[18]=s=>h.is_unlimited=s),id:"is_unlimited",class:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500"},null,512),[[ct,h.is_unlimited]]),e[83]||(e[83]=t("label",{for:"is_unlimited",class:"ml-2 text-sm text-gray-700 dark:text-gray-300"}," Không giới hạn số lần sử dụng ",-1))])]),t("div",null,[e[84]||(e[84]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Số lần s dụng cho mỗi người dùng * ",-1)),x(t("input",{"onUpdate:modelValue":e[19]||(e[19]=s=>h.uses_per_user=s),type:"number",required:"",min:"1",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[U,h.uses_per_user,void 0,{number:!0}]])]),t("div",Wa,[d(y,{type:"button",label:"Quay lại",color:"white",onClick:e[20]||(e[20]=s=>H.value=!1)}),d(y,{type:"submit",label:"Tạo và gán",color:"success"})])],32)])):(l(),o("div",Ia,[t("form",{onSubmit:X(It,["prevent"]),class:"space-y-4"},[t("div",null,[e[73]||(e[73]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Chọn Voucher có sẵn ",-1)),x(t("select",{"onUpdate:modelValue":e[8]||(e[8]=s=>K.voucher_id=s),class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},[e[72]||(e[72]=t("option",{value:""},"-- Chọn voucher --",-1)),(l(!0),o(V,null,$(ft.value,s=>(l(),o("option",{key:s.id,value:s.id},r(s.code)+" - "+r(s.discount_type==="percentage"?`${s.discount_value}%`:L(s.discount_value)),9,za))),128))],512),[[q,K.voucher_id]])]),t("div",null,[e[74]||(e[74]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Số lần sử dụng ",-1)),x(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>K.total_uses=s),type:"number",min:"1",required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[U,K.total_uses,void 0,{number:!0}]])]),t("div",Ra,[d(y,{type:"button",label:"Tạo voucher mới",color:"success",onClick:e[10]||(e[10]=s=>H.value=!0)}),t("div",Qa,[d(y,{type:"button",label:"Hủy",color:"white",onClick:Q}),d(y,{type:"submit",label:"Xác nhận",color:"info",disabled:!K.voucher_id},null,8,["disabled"])])])],32)]))]),_:1})])])]),_:1})]),_:1},8,["show"]),G.value==="service_combos"?(l(),o("div",Pa,[t("div",tr,[e[93]||(e[93]=t("div",{class:"p-4 border-b dark:border-slate-700"},[t("h3",{class:"text-lg font-medium leading-6 dark:text-white"},"Liệu trình đang thực hiện")],-1)),(p=Y.value)!=null&&p.length?(l(),o("div",er,[(l(!0),o(V,null,$(Y.value,s=>{var u;return l(),o("div",{key:s.id},[t("div",sr,[t("div",null,[t("div",ar,[t("h4",rr,r(s.service_name),1),t("span",{class:D({"px-2 py-0.5 text-xs font-medium rounded-full":!0,[`bg-${s.package_type.color}-100 text-${s.package_type.color}-800`]:!0,[`dark:bg-${s.package_type.color}-900 dark:text-${s.package_type.color}-200`]:!0})},r(s.package_type.name),3)]),t("p",lr," Hết hạn: "+r(s.formatted_expiry_date||"Không giới hạn"),1)]),s.remaining_sessions>0?(l(),ut(y,{key:0,color:"info",label:"Thêm buổi dịch vụ",icon:i($t),onClick:m=>ae(s)},null,8,["icon","onClick"])):w("",!0)]),t("div",or,[t("div",{class:D(["bg-blue-600 h-2.5 rounded-full",{"bg-green-600":s.progress_percentage>=100}]),style:ge({width:`${s.progress_percentage}%`})},null,6)]),t("div",dr,[t("div",null,[e[85]||(e[85]=t("p",{class:"text-gray-600 dark:text-gray-400"},"Tổng số buổi",-1)),t("p",nr,r(s.total_sessions),1)]),t("div",null,[e[86]||(e[86]=t("p",{class:"text-gray-600 dark:text-gray-400"},"Đã sử dụng",-1)),t("p",ir,r(s.used_sessions),1)]),t("div",null,[e[87]||(e[87]=t("p",{class:"text-gray-600 dark:text-gray-400"},"Còn lại",-1)),t("p",ur,r(s.remaining_sessions),1)])]),s.next_session_date?(l(),o("div",cr,[t("div",mr,[d(T,{path:i(jt),class:"w-5 h-5 text-blue-600 dark:text-blue-400"},null,8,["path"]),t("div",null,[e[88]||(e[88]=t("p",{class:"text-sm font-medium text-blue-900 dark:text-blue-200"}," Buổi dịch vụ tiếp theo ",-1)),t("p",gr,r(s.next_session_date),1)])])])):w("",!0),s.next_appointment_details?(l(),o("div",pr,[t("div",xr,[d(T,{path:i(jt),class:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5"},null,8,["path"]),t("div",hr,[e[89]||(e[89]=t("p",{class:"text-sm font-medium text-blue-900 dark:text-blue-200"}," Lịch hẹn sắp tới ",-1)),t("div",br,[t("p",fr,r(s.next_appointment_details.date),1),t("div",yr,[d(T,{path:i(_e),class:"w-4 h-4 mr-1"},null,8,["path"]),N(" "+r(s.next_appointment_details.time.start)+" - "+r(s.next_appointment_details.time.end),1)]),s.next_appointment_details.staff?(l(),o("div",vr,[d(T,{path:i(pt),class:"w-4 h-4 mr-1"},null,8,["path"]),N(" Thực hiện bởi: "+r(s.next_appointment_details.staff.full_name),1)])):w("",!0)])])])])):w("",!0),(u=s.treatment_sessions)!=null&&u.length?(l(),o("div",_r,[t("div",kr,[e[92]||(e[92]=t("h5",{class:"font-medium text-gray-900 dark:text-white mb-3"}," Lịch sử dịch vụ ",-1)),t("div",wr,[(l(!0),o(V,null,$(s.treatment_sessions,m=>{var M;return l(),o("div",{key:m.id,class:"p-3 bg-gray-50 dark:bg-slate-800 rounded-lg"},[t("div",Cr,[t("div",null,[t("div",Vr," Buổi #"+r(s.total_sessions-s.treatment_sessions.indexOf(m)),1),t("div",Tr,[t("div",$r,[d(T,{path:i(St),class:"w-4 h-4"},null,8,["path"]),t("span",null,r(nt(m.start_time)),1)]),t("div",jr,[d(T,{path:i(pt),class:"w-4 h-4"},null,8,["path"]),t("span",null,"Thực hiện: "+r(((M=m.staff)==null?void 0:M.full_name)||"N/A"),1)])])]),m.result?(l(),o("div",Sr,[e[90]||(e[90]=t("span",{class:"font-medium"},"Kết quả:",-1)),N(" "+r(m.result),1)])):w("",!0)]),m.notes?(l(),o("div",Ur,[e[91]||(e[91]=t("span",{class:"font-medium"},"Ghi chú:",-1)),N(" "+r(m.notes),1)])):w("",!0)])}),128))])])])):w("",!0)])}),128))])):(l(),o("div",Mr," Chưa có liệu trình nào đang thực hiện "))]),t("div",Dr,[e[101]||(e[101]=t("div",{class:"p-4 border-b dark:border-slate-700"},[t("h3",{class:"text-lg font-medium leading-6 dark:text-white"},"Liệu trình đã hoàn thành")],-1)),lt.value.length?(l(),o("div",Nr,[(l(!0),o(V,null,$(lt.value,s=>{var u;return l(),o("div",{key:s.id,class:"py-4 first:pt-0 last:pb-0"},[t("div",Ar,[t("div",null,[t("div",Or,[t("h4",qr,r(s.service_name),1),t("span",{class:D({"px-2 py-0.5 text-xs font-medium rounded-full":!0,[`bg-${s.package_type.color}-100 text-${s.package_type.color}-800`]:!0,[`dark:bg-${s.package_type.color}-900 dark:text-${s.package_type.color}-200`]:!0})},r(s.package_type.name),3)]),t("p",Er," Hoàn thành: "+r(it(s.updated_at)),1)])]),e[100]||(e[100]=t("div",{class:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700 mb-4"},[t("div",{class:"bg-green-600 h-2.5 rounded-full w-full"})],-1)),t("div",Kr,[t("div",null,[e[94]||(e[94]=t("p",{class:"text-gray-600 dark:text-gray-400"},"Tổng số buổi",-1)),t("p",Gr,r(s.total_sessions),1)]),t("div",null,[e[95]||(e[95]=t("p",{class:"text-gray-600 dark:text-gray-400"},"Đã sử dụng",-1)),t("p",Lr,r(s.used_sessions),1)]),e[96]||(e[96]=t("div",null,[t("p",{class:"text-gray-600 dark:text-gray-400"},"Trạng thái"),t("p",{class:"font-medium text-green-600 dark:text-green-400"},"Hoàn thành")],-1))]),(u=s.treatment_sessions)!=null&&u.length?(l(),o("div",Hr,[t("div",Br,[e[99]||(e[99]=t("h5",{class:"font-medium text-gray-900 dark:text-white mb-3"}," Lịch sử dịch vụ ",-1)),t("div",Fr,[(l(!0),o(V,null,$(s.treatment_sessions,m=>{var M;return l(),o("div",{key:m.id,class:"p-3 bg-gray-50 dark:bg-slate-800 rounded-lg"},[t("div",Ir,[t("div",null,[t("div",zr," Buổi #"+r(s.total_sessions-s.treatment_sessions.indexOf(m)),1),t("div",Rr,[t("div",Qr,[d(T,{path:i(St),class:"w-4 h-4"},null,8,["path"]),t("span",null,r(nt(m.start_time)),1)]),t("div",Yr,[d(T,{path:i(pt),class:"w-4 h-4"},null,8,["path"]),t("span",null,"Thực hiện: "+r(((M=m.staff)==null?void 0:M.full_name)||"N/A"),1)])])]),m.result?(l(),o("div",Xr,[e[97]||(e[97]=t("span",{class:"font-medium"},"Kết quả:",-1)),N(" "+r(m.result),1)])):w("",!0)]),m.notes?(l(),o("div",Jr,[e[98]||(e[98]=t("span",{class:"font-medium"},"Ghi chú:",-1)),N(" "+r(m.notes),1)])):w("",!0)])}),128))])])])):w("",!0)])}),128))])):(l(),o("div",Zr," Chưa có liệu trình nào hoàn thành "))])])):w("",!0),d(i(W),{appear:"",show:ot.value,as:"template"},{default:f(()=>[d(i(P),{as:"div",onClose:dt,class:"relative z-50"},{default:f(()=>[e[109]||(e[109]=t("div",{class:"fixed inset-0 bg-black/30"},null,-1)),t("div",Wr,[t("div",Pr,[d(i(tt),{class:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white dark:bg-slate-900 p-6 shadow-xl transition-all"},{default:f(()=>[d(i(et),{as:"h3",class:"text-lg font-medium leading-6 text-gray-900 dark:text-white mb-4"},{default:f(()=>e[102]||(e[102]=[N(" Thêm buổi dịch vụ mới ")])),_:1}),t("form",{onSubmit:X(re,["prevent"]),class:"space-y-4"},[t("div",null,[e[104]||(e[104]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Nhân viên thực hiện * ",-1)),x(t("select",{"onUpdate:modelValue":e[21]||(e[21]=s=>S.staff_user_id=s),required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},[e[103]||(e[103]=t("option",{value:""},"-- Chọn nhân viên --",-1)),(l(!0),o(V,null,$(kt.value,s=>(l(),o("option",{key:s.id,value:s.id},r(s.full_name),9,tl))),128))],512),[[q,S.staff_user_id]])]),t("div",null,[e[105]||(e[105]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Thời gian bắt đầu * ",-1)),x(t("input",{"onUpdate:modelValue":e[22]||(e[22]=s=>S.start_time=s),type:"datetime-local",required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[U,S.start_time]])]),t("div",null,[e[106]||(e[106]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Thời gian kết thúc * ",-1)),x(t("input",{"onUpdate:modelValue":e[23]||(e[23]=s=>S.end_time=s),type:"datetime-local",required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[U,S.end_time]])]),t("div",null,[e[107]||(e[107]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Kết quả ",-1)),x(t("textarea",{"onUpdate:modelValue":e[24]||(e[24]=s=>S.result=s),rows:"2",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[U,S.result]])]),t("div",null,[e[108]||(e[108]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Ghi chú ",-1)),x(t("textarea",{"onUpdate:modelValue":e[25]||(e[25]=s=>S.notes=s),rows:"3",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[U,S.notes]])]),t("div",el,[d(y,{type:"button",label:"Hủy",color:"white",onClick:dt}),d(y,{type:"submit",label:"Thêm",color:"info"})])],32)]),_:1})])])]),_:1})]),_:1},8,["show"])]}),_:1},8,["breadcrumbs"])]),_:1}))}},Jl=je(sl,[["__scopeId","data-v-5fbbbdf8"]]);export{Jl as default};
