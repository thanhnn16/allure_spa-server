import{r as u,aU as a,a2 as o,a3 as t,aa as n,bl as w,a1 as y,bf as d,F as C,b0 as j,j as D,bM as J,o as O,bH as f,bJ as Z,bz as W,a0 as R,aI as X,a9 as G}from"./@vue-BRgAy5zV.js";import{Z as Y}from"./@inertiajs-D0DMCEQB.js";import{L as tt}from"./LayoutAuthenticated-XYWWksRn.js";import{_ as et}from"./SectionMain-BbIPmLtw.js";import{_ as st}from"./CardBox-jfYP3QDG.js";import{_ as at}from"./BaseButtons-B17KSMwc.js";import{_ as S}from"./BaseButton-eMTGofBM.js";import{_ as rt}from"./FormControl-BSsARiYM.js";import{k as H,aG as ot,aH as lt,w as nt,aa as it,aI as dt}from"./@mdi-B5XnydK5.js";import{_ as T}from"./BaseIcon-B4kwkOCn.js";import{a as U}from"./axios-CCb-kr4I.js";import{u as ct}from"./vue-toastification-ejyjJRED.js";import{_ as ut}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./deepmerge-CtOfIP5S.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./app-BoYSAkEF.js";import"./jspdf-Ciebq7We.js";import"./@babel-BsCcpEdk.js";import"./fflate-EnPhvkmS.js";import"./laravel-echo-C9ppFO4I.js";import"./pusher-js-Cl-1XqxI.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./pinia-BhnhDyRZ.js";import"./firebase-DL3QX-oU.js";import"./@firebase--zA4YiqN.js";import"./idb-Bn1DMRyg.js";import"./colors-S7_1wET5.js";import"./OverlayLayer-BSs7OF78.js";import"./main-BNmBi4-k.js";const mt={class:"relative max-w-4xl w-full mx-4"},pt={class:"relative bg-black rounded-lg overflow-hidden"},xt=["src","alt"],gt={class:"absolute bottom-4 left-1/2 -translate-x-1/2 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm"},ht={key:0,class:"flex justify-center mt-4 gap-2 overflow-x-auto pb-2"},vt=["onClick"],ft=["src","alt"],yt={__name:"ImageGalleryModal",props:{images:{type:Array,required:!0},initialIndex:{type:Number,default:0}},emits:["close"],setup(m,{emit:I}){const x=m,c=I,l=u(x.initialIndex),k=()=>{l.value=(l.value+1)%x.images.length},g=()=>{l.value=(l.value-1+x.images.length)%x.images.length},_=p=>{p.key==="ArrowRight"&&k(),p.key==="ArrowLeft"&&g(),p.key==="Escape"&&c("close")};return onMounted(()=>{document.addEventListener("keydown",_)}),onBeforeUnmount(()=>{document.removeEventListener("keydown",_)}),(p,h)=>(a(),o("div",{class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75",onClick:h[1]||(h[1]=J($=>p.$emit("close"),["self"]))},[t("div",mt,[t("button",{class:"absolute -top-12 right-0 text-white hover:text-gray-300 transition-colors",onClick:h[0]||(h[0]=$=>p.$emit("close"))},[n(T,{path:w(H),class:"w-8 h-8"},null,8,["path"])]),t("div",pt,[t("img",{src:m.images[l.value].url,class:"max-h-[80vh] w-full object-contain",alt:`Image ${l.value+1} of ${m.images.length}`},null,8,xt),m.images.length>1?(a(),o("button",{key:0,class:"absolute left-0 top-1/2 -translate-y-1/2 p-2 text-white hover:text-gray-300 bg-black bg-opacity-50 rounded-r transition-colors",onClick:g},[n(T,{path:w(ot),class:"w-8 h-8"},null,8,["path"])])):y("",!0),m.images.length>1?(a(),o("button",{key:1,class:"absolute right-0 top-1/2 -translate-y-1/2 p-2 text-white hover:text-gray-300 bg-black bg-opacity-50 rounded-l transition-colors",onClick:k},[n(T,{path:w(lt),class:"w-8 h-8"},null,8,["path"])])):y("",!0),t("div",gt,d(l.value+1)+" / "+d(m.images.length),1)]),m.images.length>1?(a(),o("div",ht,[(a(!0),o(C,null,j(m.images,($,i)=>(a(),o("button",{key:i,class:D(["w-16 h-16 flex-shrink-0 rounded-lg overflow-hidden transition-transform hover:scale-105 focus:outline-none",{"ring-2 ring-blue-500":i===l.value}]),onClick:V=>l.value=i},[t("img",{src:$.url,class:"w-full h-full object-cover",alt:`Thumbnail ${i+1}`},null,8,ft)],10,vt))),128))])):y("",!0)])]))}},kt={class:"flex flex-col md:flex-row justify-between items-center mb-6"},_t={class:"flex items-center space-x-2"},bt={key:0,class:"animate-spin"},wt={class:"flex flex-col md:flex-row gap-4 mt-4 md:mt-0 w-full md:w-auto"},$t={class:"relative"},Ct={class:"overflow-x-auto rounded-lg border dark:border-slate-700"},It={class:"w-full"},St={class:"bg-white dark:bg-slate-900 divide-y dark:divide-slate-700"},jt={class:"px-4 py-4 whitespace-nowrap"},Tt={class:"flex items-center"},Vt={class:"flex-shrink-0 h-10 w-10"},Lt=["src"],Dt={class:"ml-4"},Nt={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},Mt={class:"text-sm text-gray-500 dark:text-gray-400"},zt={class:"px-4 py-4"},Bt={class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"},At={class:"px-4 py-4 text-sm text-gray-900 dark:text-gray-100"},Et={class:"px-4 py-4"},Kt={class:"flex space-x-1"},Rt={class:"px-4 py-4 text-sm text-gray-500 dark:text-gray-400 max-w-xs"},Gt={class:"truncate"},Ut={class:"px-4 py-4"},Ht={key:0,class:"flex items-center gap-2"},Pt={class:"flex -space-x-1"},Qt=["onClick"],Ft=["src","alt"],qt=["onClick"],Jt={key:1,class:"text-sm text-gray-400 dark:text-gray-600 italic"},Ot={class:"px-4 py-4 text-sm text-gray-500 dark:text-gray-400"},Zt={class:"px-4 py-4"},Wt={key:0,class:"flex space-x-2"},Xt={class:"flex justify-between items-center mt-6"},Yt={class:"text-sm text-gray-700 dark:text-gray-300"},te={__name:"Index",setup(m){const I=u([]),x=u(!1),c=u(1),l=u(1),k=u(""),g=u(""),_=u(!1),p=u([]),h=u(0),$=ct(),i=async()=>{x.value=!0;try{const r=await U.get("/api/ratings",{params:{page:c.value,status:k.value,search:g.value}});I.value=r.data.data.data,l.value=r.data.data.last_page}catch{L("Không thể tải danh sách đánh giá","danger")}x.value=!1},V=async(r,s)=>{try{await U.put(`/api/ratings/${r}`,{status:s}),L("Cập nhật trạng thái thành công","success"),await i()}catch(e){console.error("Error updating rating status:",e),L("Không thể cập nhật trạng thái","danger")}},L=(r,s="success")=>{$[s](r)},P=r=>Array(5).fill().map((s,e)=>e<r?it:dt),Q=r=>new Date(r).toLocaleDateString("vi-VN"),F=r=>r==="product"?"SP":"DV",q=r=>({pending:"Chờ duyệt",approved:"Đã duyệt",rejected:"Đã từ chối"})[r]||r,N=(r,s=0)=>{p.value=r,h.value=s,_.value=!0};return O(()=>{i()}),(r,s)=>(a(),o(C,null,[n(tt,null,{default:f(()=>[n(w(Y),{title:"Quản lý đánh giá"}),n(et,null,{default:f(()=>[n(st,{class:"mb-6"},{default:f(()=>[t("div",kt,[t("div",_t,[s[6]||(s[6]=t("h1",{class:"text-2xl font-bold dark:text-gray-100"},"Quản lý đánh giá",-1)),x.value?(a(),o("span",bt,"⌛")):y("",!0)]),t("div",wt,[t("div",$t,[n(rt,{modelValue:g.value,"onUpdate:modelValue":s[1]||(s[1]=e=>g.value=e),placeholder:"Tìm kiếm theo tên khách hàng...",class:"min-w-[250px] dark:bg-slate-800 dark:border-slate-700 dark:text-gray-100",onInput:i},{rightIcon:f(()=>[g.value?(a(),o("span",{key:0,class:"cursor-pointer text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",onClick:s[0]||(s[0]=e=>{g.value="",i()})}," ✕ ")):y("",!0)]),_:1},8,["modelValue"])]),Z(t("select",{"onUpdate:modelValue":s[2]||(s[2]=e=>k.value=e),class:"rounded-lg border-gray-300 dark:bg-slate-800 dark:border-slate-700 dark:text-gray-100 focus:border-blue-500 focus:ring-blue-500 transition-colors duration-150",onChange:i},s[7]||(s[7]=[t("option",{value:""},"Tất cả",-1),t("option",{value:"pending"},"Chờ duyệt",-1),t("option",{value:"approved"},"Đã duyệt",-1),t("option",{value:"rejected"},"Đã từ chối",-1)]),544),[[W,k.value]])])]),t("div",Ct,[t("table",It,[s[8]||(s[8]=t("thead",null,[t("tr",{class:"bg-gray-50 dark:bg-slate-800 border-b dark:border-slate-700"},[t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Khách hàng "),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Loại "),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Sản phẩm/Dịch vụ "),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Đánh giá "),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Bình luận "),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Hình ảnh "),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Ngày tạo "),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Trạng thái ")])],-1)),t("tbody",St,[(a(!0),o(C,null,j(I.value,e=>{var M,z,B,A,E,K;return a(),o("tr",{key:e.id,class:"hover:bg-gray-50 dark:hover:bg-slate-800 transition-colors duration-150"},[t("td",jt,[t("div",Tt,[t("div",Vt,[t("img",{class:"h-10 w-10 rounded-full",src:((M=e.user)==null?void 0:M.avatar_url)||"path/to/default/avatar.png",alt:""},null,8,Lt)]),t("div",Dt,[t("div",Nt,d((z=e.user)==null?void 0:z.name),1),t("div",Mt,d((B=e.user)==null?void 0:B.email),1)])])]),t("td",zt,[t("span",Bt,d(F(e.rating_type)),1)]),t("td",At,d(((A=e.item)==null?void 0:A.name)||((E=e.item)==null?void 0:E.service_name)),1),t("td",Et,[t("div",Kt,[(a(!0),o(C,null,j(P(e.stars),(v,b)=>(a(),R(T,{key:b,path:v,class:D(["w-5 h-5",b<e.stars?"text-yellow-400":"text-gray-300 dark:text-gray-600"])},null,8,["path","class"]))),128))])]),t("td",Rt,[t("div",Gt,d(e.comment),1)]),t("td",Ut,[(K=e.media_urls)!=null&&K.length?(a(),o("div",Ht,[t("div",Pt,[(a(!0),o(C,null,j(e.media_urls.slice(0,3),(v,b)=>(a(),o("div",{key:v.id,class:"relative group cursor-pointer",onClick:ee=>N(e.media_urls,b)},[t("img",{src:v.url,class:"w-12 h-12 object-cover rounded-lg border-2 border-white dark:border-slate-800 transition-all duration-200 hover:z-10 hover:scale-110",style:X({zIndex:b}),alt:`Ảnh đánh giá ${b+1}`},null,12,Ft)],8,Qt))),128))]),e.media_urls.length>3?(a(),o("span",{key:0,class:"text-sm text-gray-500 dark:text-gray-400 cursor-pointer hover:text-blue-500",onClick:v=>N(e.media_urls,3)}," +"+d(e.media_urls.length-3)+" ảnh khác ",9,qt)):y("",!0)])):(a(),o("div",Jt," Không có ảnh "))]),t("td",Ot,d(Q(e.created_at)),1),t("td",Zt,[e.status==="pending"?(a(),o("div",Wt,[n(S,{color:"success",icon:w(nt),onClick:v=>V(e.id,"approved"),small:"",tooltip:"Duyệt đánh giá",class:"hover:scale-105 transition-transform duration-200"},null,8,["icon","onClick"]),n(S,{color:"danger",icon:w(H),onClick:v=>V(e.id,"rejected"),small:"",tooltip:"Từ chối đánh giá",class:"hover:scale-105 transition-transform duration-200"},null,8,["icon","onClick"])])):(a(),o("span",{key:1,class:D(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",{"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":e.status==="approved","bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":e.status==="rejected"}])},d(q(e.status)),3))])])}),128))])])]),t("div",Xt,[t("div",Yt," Trang "+d(c.value)+" / "+d(l.value),1),n(at,null,{default:f(()=>[n(S,{disabled:c.value===1,onClick:s[3]||(s[3]=e=>{c.value--,i()}),color:c.value===1?"light":"info",class:"transition-all duration-200"},{default:f(()=>s[9]||(s[9]=[G(" Trước ")])),_:1},8,["disabled","color"]),n(S,{disabled:c.value===l.value,onClick:s[4]||(s[4]=e=>{c.value++,i()}),color:c.value===l.value?"light":"info",class:"transition-all duration-200"},{default:f(()=>s[10]||(s[10]=[G(" Sau ")])),_:1},8,["disabled","color"])]),_:1})])]),_:1})]),_:1})]),_:1}),_.value?(a(),R(yt,{key:0,images:p.value,"initial-index":h.value,onClose:s[5]||(s[5]=e=>_.value=!1)},null,8,["images","initial-index"])):y("",!0)],64))}},Je=ut(te,[["__scopeId","data-v-a4f3d684"]]);export{Je as default};
