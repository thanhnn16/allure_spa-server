import{r as m,aU as r,a0 as L,bH as M,a3 as l,j as y,bl as a,a2 as i,aa as u,a9 as E,bf as d,bM as T,a1 as x,F as X,b0 as H}from"./@vue-BRgAy5zV.js";import{T as U}from"./@inertiajs-D0DMCEQB.js";import{C as O}from"./CardBoxModal-WWcFA8_N.js";import{_}from"./BaseButton-eMTGofBM.js";import{J as k,j as $,K as z,L as J}from"./@mdi-B8rJ_oIP.js";import{_ as v}from"./BaseIcon-B4kwkOCn.js";import"./axios-CCb-kr4I.js";import"./deepmerge-CtOfIP5S.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./BaseButtons-B17KSMwc.js";import"./CardBox-jfYP3QDG.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./OverlayLayer-BSs7OF78.js";import"./colors-S7_1wET5.js";const K={class:"p-6"},R={class:"mb-6"},q={class:"flex items-center justify-center w-full"},A={key:0,class:"flex flex-col items-center justify-center pt-5 pb-6"},G={key:1,class:"flex items-center bg-gray-100 p-2 rounded"},P={class:"text-sm font-medium text-gray-700"},Q={key:0,class:"mt-2 text-sm text-red-600"},W={key:0,class:"mb-4"},Y={key:1,class:"mb-4"},Z={class:"flex justify-end space-x-2"},Fe={__name:"ImportCustomersModal",props:{modelValue:Boolean},emits:["update:modelValue","imported","close"],setup(C,{emit:V}){const c=V,o=U({file:null}),B=m(null),f=m(""),p=m(!1),s=m(""),n=m(null),D=e=>{const t=e.target.files[0];t&&g(t)},g=e=>{o.file=e,f.value=e.name,s.value="",n.value=null},N=e=>{e.preventDefault(),p.value=!0},S=()=>{p.value=!1},w=e=>{e.preventDefault(),p.value=!1;const t=e.dataTransfer.files[0];t&&g(t)},b=()=>{o.file=null,f.value="",s.value="",n.value=null},j=()=>{if(!o.file){alert("Vui lòng chọn file trước khi xác nhận.");return}s.value="Đang xử lý...",o.post(route("users.import"),{preserveState:!0,preserveScroll:!0,onSuccess:e=>{c("update:modelValue",!1),c("imported",e)},onError:e=>{console.error("Import failed",e),s.value="Có lỗi xảy ra. Vui lòng kiểm tra thông báo lỗi.",n.value=e}})},F=()=>{b(),c("update:modelValue",!1)};return(e,t)=>(r(),L(O,{modelValue:C.modelValue,"onUpdate:modelValue":t[0]||(t[0]=h=>c("update:modelValue",h)),title:"Nhập khách hàng từ file Excel",hasCancel:!1,hasButton:!1},{default:M(()=>[l("div",K,[t[3]||(t[3]=l("h2",{class:"text-lg font-medium text-gray-900 mb-4"}," Nhập khách hàng từ file Excel ",-1)),l("div",R,[l("div",q,[l("label",{for:"file-upload",class:y(["flex flex-col items-center justify-center w-full h-64 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100",{"border-blue-500 bg-blue-50":p.value}]),onDragover:N,onDragleave:S,onDrop:w},[a(o).file?(r(),i("div",G,[u(v,{path:a(k),class:"w-6 h-6 mr-2 text-gray-600"},null,8,["path"]),l("span",P,d(f.value),1),l("button",{type:"button",onClick:T(b,["prevent"]),class:"ml-2 text-sm text-red-600 hover:text-red-800"},[u(v,{path:a($),class:"w-5 h-5"},null,8,["path"])])])):(r(),i("div",A,[u(v,{path:a(k),class:"w-10 h-10 mb-3 text-gray-400"},null,8,["path"]),t[1]||(t[1]=l("p",{class:"mb-2 text-sm text-gray-500 dark:text-gray-400"},[l("span",{class:"font-semibold"},"Nhấp để tải lên"),E(" hoặc kéo và thả ")],-1)),t[2]||(t[2]=l("p",{class:"text-xs text-gray-500 dark:text-gray-400"}," XLSX, XLS, hoặc CSV (Tối đa 10MB) ",-1))])),l("input",{id:"file-upload",ref_key:"fileInput",ref:B,type:"file",class:"hidden",onChange:D,accept:".xlsx,.xls,.csv"},null,544)],34)]),a(o).errors.file?(r(),i("p",Q,d(a(o).errors.file),1)):x("",!0)]),s.value?(r(),i("div",W,[l("p",{class:y({"text-blue-600":s.value==="Đang xử lý...","text-green-600":s.value==="Hoàn thành","text-red-600":s.value==="Có lỗi xảy ra. Vui lòng kiểm tra thông báo lỗi."})},d(s.value),3)])):x("",!0),n.value?(r(),i("div",Y,[(r(!0),i(X,null,H(n.value,(h,I)=>(r(),i("p",{key:I,class:"text-red-600"},d(h),1))),128))])):x("",!0),l("div",Z,[u(_,{type:"button",color:"info",icon:a(z),label:"Xác nhận",onClick:j,disabled:a(o).processing||!a(o).file},null,8,["icon","disabled"]),u(_,{type:"button",color:"danger",icon:a(J),label:"Hủy",onClick:F,disabled:a(o).processing},null,8,["icon","disabled"])])])]),_:1},8,["modelValue"]))}};export{Fe as default};
