import{r as S,f as H,c as N,o as nt,e as oe,aU as o,a0 as de,bH as f,aa as d,bl as u,a3 as e,a2 as n,b0 as $,j as E,bf as r,F as C,bJ as p,bz as O,bx as it,a1 as V,a9 as D,bM as Y,bA as j,bw as ne,aI as ut}from"./@vue-BRgAy5zV.js";import{r as ct,s as ie,t as mt,u as _e,v as ue,w as gt,k as pt,e as ke,b as we,x as ht,y as xt,f as bt,z as ft,A as Ce,B as yt,n as ce,C as vt,D as _t}from"./@mdi-CTfBXXzV.js";import{L as kt}from"./LayoutAuthenticated-DXP3FaW_.js";import{_ as wt}from"./SectionMain-BbIPmLtw.js";import{_ as X}from"./CardBox-jfYP3QDG.js";import{_ as y}from"./BaseButton-eMTGofBM.js";import{_ as T}from"./BaseIcon-B4kwkOCn.js";import{Z as Ct}from"./@inertiajs-D0DMCEQB.js";import{u as Vt}from"./vue-toastification-ejyjJRED.js";import{a as x}from"./axios-CCb-kr4I.js";import{_ as Tt}from"./UserAvatar-C90FUJbv.js";import{_ as St}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{f as Ve,p as Te,v as Se}from"./date-fns-9vLFlIJ3.js";import{S as J,Y as Z,G as W,V as P}from"./@headlessui-BdO8fvzs.js";import"./app-BMT21JMQ.js";import"./jspdf-Ciebq7We.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./@babel-BsCcpEdk.js";import"./fflate-EnPhvkmS.js";import"./laravel-echo-C9ppFO4I.js";import"./pusher-js-Cl-1XqxI.js";import"./laravel-vite-plugin-DEL3ZhID.js";import"./pinia-BhnhDyRZ.js";import"./firebase-DL3QX-oU.js";import"./@firebase--zA4YiqN.js";import"./idb-Bn1DMRyg.js";import"./deepmerge-CtOfIP5S.js";import"./qs-Bnt7aRCy.js";import"./side-channel-FJR906QQ.js";import"./object-inspect-D3SFxae_.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./colors-S7_1wET5.js";import"./OverlayLayer-BSs7OF78.js";const $t={class:"bg-white dark:bg-slate-900 rounded-lg shadow-md p-4 mb-6"},jt={class:"flex space-x-2"},Ut=["onClick"],Dt={class:"flex items-center space-x-2"},Mt={key:0,class:"space-y-6"},At={class:"flex flex-col md:flex-row md:items-start md:space-x-6"},Nt={class:"flex flex-col items-center space-y-3 mb-6 md:mb-0"},Ot={class:"relative"},qt={class:"absolute bottom-0 right-0 bg-blue-500 dark:bg-blue-600 rounded-full p-2 cursor-pointer hover:bg-blue-600 dark:hover:bg-blue-700 transition-colors shadow-md"},Kt={class:"text-center"},Et={class:"text-xl font-bold dark:text-white"},Gt={class:"text-gray-600 dark:text-gray-400"},Bt={class:"flex-1 grid grid-cols-2 md:grid-cols-4 gap-4"},Lt={class:"bg-blue-50 dark:bg-blue-900/30 p-4 rounded-lg"},Ft={class:"flex items-center space-x-2"},Ht={class:"mt-2 text-2xl font-bold text-blue-700 dark:text-blue-300"},It={class:"bg-green-50 dark:bg-green-900/30 p-4 rounded-lg"},zt={class:"flex items-center space-x-2"},Rt={class:"mt-2 text-2xl font-bold text-green-700 dark:text-green-300"},Qt={class:"bg-purple-50 dark:bg-purple-900/30 p-4 rounded-lg"},Yt={class:"flex items-center space-x-2"},Xt={class:"mt-2 text-2xl font-bold text-purple-700 dark:text-purple-300"},Jt={class:"bg-orange-50 dark:bg-orange-900/30 p-4 rounded-lg"},Zt={class:"flex items-center space-x-2"},Wt={class:"mt-2 text-2xl font-bold text-orange-700 dark:text-orange-300"},Pt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},es={class:"space-y-4"},ts={class:"flex-1"},ss={class:"text-sm text-gray-600 dark:text-gray-400"},as={class:"flex items-center gap-2"},rs=["onUpdate:modelValue"],ls=["value"],os=["onUpdate:modelValue","type"],ds={class:"font-medium dark:text-white flex-1"},ns={class:"space-y-4"},is={class:"flex-1"},us={class:"text-sm text-gray-600 dark:text-gray-400"},cs={class:"font-medium dark:text-white"},ms={class:"p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-800"},gs={class:"font-medium dark:text-white mt-1"},ps={class:"flex justify-between items-center mb-6"},hs={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},xs={class:"flex justify-between"},bs={class:"space-y-2"},fs={class:"flex items-start space-x-2"},ys={class:"font-medium dark:text-white"},vs={class:"text-sm text-gray-600 dark:text-gray-400"},_s={class:"flex flex-wrap gap-2"},ks={key:0,class:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 rounded-full"},ws={key:1,class:"px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200 rounded-full"},Cs={class:"px-2 py-1 text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200 rounded-full"},Vs={class:"flex space-x-2"},Ts={key:1,class:"text-center py-8 text-gray-500 dark:text-gray-400"},Ss={key:1,class:"space-y-4"},$s={class:"flex justify-between items-center"},js={key:0,class:"text-center py-8 text-gray-500"},Us={class:"flex justify-between items-start"},Ds={class:"font-medium text-lg"},Ms={class:"text-sm text-gray-600 dark:text-gray-400"},As={class:"text-right"},Ns={class:"font-medium text-lg text-primary-600"},Os={class:"text-sm text-gray-600 dark:text-gray-400"},qs={class:"mt-4 grid grid-cols-2 gap-4 text-sm"},Ks={class:"text-gray-600 dark:text-gray-400"},Es={class:"font-medium"},Gs={class:"text-gray-600 dark:text-gray-400"},Bs={class:"font-medium"},Ls={class:"text-right"},Fs={class:"text-gray-600 dark:text-gray-400"},Hs={class:"font-medium"},Is={class:"text-gray-600 dark:text-gray-400"},zs={class:"font-medium"},Rs={class:"mt-4 flex justify-end space-x-2"},Qs={class:"fixed inset-0 overflow-y-auto"},Ys={class:"flex min-h-full items-center justify-center p-4"},Xs={key:0,class:"space-y-4"},Js={class:"flex justify-between items-start"},Zs={class:"font-medium dark:text-white"},Ws={class:"text-sm text-gray-600 dark:text-gray-400"},Ps={class:"grid grid-cols-2 gap-4 text-sm"},ea={class:"font-medium dark:text-white"},ta={class:"font-medium dark:text-white"},sa={class:"font-medium dark:text-white"},aa={class:"font-medium dark:text-white"},ra={class:"font-medium dark:text-white"},la={class:"font-medium dark:text-white"},oa={class:"pt-4 border-t dark:border-gray-700"},da={class:"flex justify-between space-x-3"},na={key:2,class:"space-y-6"},ia={key:0,class:"space-y-4"},ua={class:"p-4 border-b dark:border-slate-700 flex justify-between items-center"},ca={class:"text-sm text-gray-600 dark:text-gray-400"},ma={class:"text-sm text-gray-600 dark:text-gray-400"},ga={class:"text-right"},pa={class:"p-4 space-y-3"},ha={class:"flex items-center space-x-3"},xa={class:"flex-shrink-0"},ba=["src","alt"],fa={key:1,class:"w-12 h-12 bg-gray-200 dark:bg-slate-700 rounded-md flex items-center justify-center"},ya={class:"font-medium dark:text-white"},va={class:"text-sm text-gray-600 dark:text-gray-400"},_a={class:"font-medium dark:text-white"},ka={class:"p-4 bg-gray-50 dark:bg-slate-800 space-y-2"},wa={class:"flex justify-between text-sm"},Ca={class:"dark:text-white"},Va={class:"flex justify-between text-sm"},Ta={class:"text-green-600 dark:text-green-400"},Sa={class:"flex justify-between font-medium pt-2 border-t dark:border-slate-700"},$a={class:"text-lg text-primary-600 dark:text-primary-400"},ja={key:0,class:"p-4 border-t dark:border-slate-700 flex justify-end space-x-3"},Ua={key:1,class:"bg-white dark:bg-slate-900 rounded-lg shadow-md p-8 text-center"},Da={class:"fixed inset-0 overflow-y-auto"},Ma={class:"flex min-h-full items-center justify-center p-4"},Aa={class:"space-y-4"},Na=["value"],Oa=["value"],qa=["value"],Ka={class:"flex items-center space-x-4"},Ea={class:"flex items-center"},Ga={class:"flex items-center"},Ba={class:"flex justify-end space-x-3 pt-4 border-t dark:border-gray-700"},La={class:"fixed inset-0 overflow-y-auto"},Fa={class:"flex min-h-full items-center justify-center p-4"},Ha={key:0},Ia=["value"],za={class:"flex justify-between space-x-3 pt-4"},Ra={class:"flex space-x-2"},Qa={key:1},Ya={class:"grid grid-cols-2 gap-4"},Xa={class:"flex items-center space-x-4"},Ja={class:"flex items-center"},Za={class:"flex justify-between space-x-3 pt-4"},Wa={key:3,class:"space-y-6"},Pa={class:"bg-white dark:bg-slate-900 rounded-lg shadow-md overflow-hidden"},er={key:0,class:"divide-y dark:divide-slate-700 p-4"},tr={class:"flex justify-between items-start mb-4"},sr={class:"flex items-center space-x-2"},ar={class:"font-medium dark:text-white"},rr={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},lr={class:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700 mb-4"},or={class:"grid grid-cols-3 gap-4 text-sm mb-4"},dr={class:"font-medium dark:text-white"},nr={class:"font-medium dark:text-white"},ir={class:"font-medium dark:text-white"},ur={key:0,class:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg"},cr={class:"flex items-center space-x-2"},mr={class:"text-sm text-blue-800 dark:text-blue-300"},gr={key:1,class:"mt-4 p-4 bg-blue-50 dark:bg-blue-900/30 rounded-lg border border-blue-100 dark:border-blue-800"},pr={class:"flex items-start space-x-3"},hr={class:"flex-1"},xr={class:"mt-1 space-y-1"},br={class:"text-sm text-blue-800 dark:text-blue-300"},fr={class:"flex items-center text-sm text-blue-700 dark:text-blue-400"},yr={key:0,class:"flex items-center text-sm text-blue-700 dark:text-blue-400"},vr={key:2,class:"mt-4"},_r={class:"border-t dark:border-slate-700 pt-4"},kr={class:"space-y-3"},wr={class:"flex justify-between items-start"},Cr={class:"text-sm text-gray-900 dark:text-white"},Vr={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},Tr={class:"flex items-center space-x-2"},Sr={class:"flex items-center space-x-2 mt-1"},$r={key:0,class:"text-sm text-gray-600 dark:text-gray-400 text-right"},jr={key:0,class:"mt-2 text-sm text-gray-600 dark:text-gray-400"},Ur={key:1,class:"p-6 text-center text-gray-600 dark:text-gray-400"},Dr={class:"fixed inset-0 overflow-y-auto"},Mr={class:"flex min-h-full items-center justify-center p-4"},Ar=["value"],Nr={class:"flex justify-end space-x-3 pt-4"},Or={__name:"CustomerDetails",props:{user:Object,upcomingBirthdays:Number},setup($e,{expose:je}){const i=$e,h=Vt(),Ue=[{id:"personal",label:"Thông tin cá nhân",icon:ce},{id:"service_combos",label:"Combo dịch vụ",icon:ie},{id:"invoices",label:"Đơn hàng",icon:ue},{id:"vouchers",label:"Vouchers",icon:_t}],G=S("personal");S(!1);const I=S(!1),q=S(null),me=S([]),ge=S([]),pe=S([]),v=H({province:"",district:"",ward:"",address:"",address_type:"home",is_default:!1,is_temporary:!1}),ee=S(!1),te=S([]),K=H({voucher_id:"",total_uses:1}),L=S(!1),b=H({code:"",discount_type:"percentage",discount_value:0,min_order_value:0,max_discount_amount:0,usage_limit:1,start_date:new Date().toISOString().split("T")[0],end_date:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],is_unlimited:!1,uses_per_user:1,status:"active"}),se=S(!1),w=S(null),z=a=>{if(!a)return"";const t=new Date(a);return`${t.getDate().toString().padStart(2,"0")}/${(t.getMonth()+1).toString().padStart(2,"0")}/${t.getFullYear()}`},De=a=>{switch(a){case"male":return"Nam";case"female":return"Nữ";default:return"Khác"}},_=N(()=>i.user||{}),B=a=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(a),M=H({full_name:!1,phone_number:!1,email:!1,gender:!1,date_of_birth:!1}),Me=N(()=>{var a,t,l,m,k,s,c,g,A,F;return[{label:"Họ và tên",key:"full_name",value:(a=i.user)==null?void 0:a.full_name,editValue:(t=i.user)==null?void 0:t.full_name,get isEditing(){return M.full_name}},{label:"Số điện thoại",key:"phone_number",value:(l=i.user)==null?void 0:l.phone_number,editValue:(m=i.user)==null?void 0:m.phone_number,get isEditing(){return M.phone_number},type:"tel"},{label:"Email",key:"email",value:(k=i.user)==null?void 0:k.email,editValue:(s=i.user)==null?void 0:s.email,get isEditing(){return M.email},type:"email"},{label:"Giới tính",key:"gender",value:De((c=i.user)==null?void 0:c.gender),editValue:(g=i.user)==null?void 0:g.gender,get isEditing(){return M.gender},type:"select",options:[{value:"male",label:"Nam"},{value:"female",label:"Nữ"},{value:"other",label:"Khác"}]},{label:"Ngày sinh",key:"date_of_birth",value:ye((A=i.user)==null?void 0:A.date_of_birth),editValue:(F=i.user)==null?void 0:F.date_of_birth,get isEditing(){return M.date_of_birth},type:"date"}]}),Ae=N(()=>[{label:"Điểm tích lũy",value:_.value.point},{label:"Số lần mua hàng",value:_.value.purchase_count},{label:"Ngày tạo",value:z(_.value.created_at)},{label:"Ngày chỉnh sửa",value:z(_.value.updated_at)}]),Ne=()=>{q.value=null,he(),I.value=!0},Oe=a=>{q.value=a,Object.assign(v,a),I.value=!0},ae=()=>{I.value=!1,he()},he=()=>{Object.assign(v,{province:"",district:"",ward:"",address:"",address_type:"home",is_default:!1,is_temporary:!1}),ge.value=[],pe.value=[]},qe=async()=>{var a,t;try{const l={...v};q.value?await x.put(`/addresses/${q.value.id}`,l):(l.user_id=i.user.id,await x.post("/addresses",l));const m=await x.get(`/users/${i.user.id}`);Object.assign(i.user,m.data.data),ae(),h.success(`Đã ${q.value?"cập nhật":"thêm"} địa chỉ thành công`)}catch(l){h.error(((t=(a=l.response)==null?void 0:a.data)==null?void 0:t.message)||"Có lỗi xảy ra")}},Ke=async a=>{var t,l;if(confirm("Bạn có chắc muốn xóa địa chỉ này?"))try{await x.delete(`/addresses/${a.id}`);const m=await x.get(`/users/${i.user.id}`);Object.assign(i.user,m.data.data),h.success("Đã xóa địa chỉ thành công")}catch(m){h.error(((l=(t=m.response)==null?void 0:t.data)==null?void 0:l.message)||"Có lỗi xảy ra khi xóa địa chỉ")}},Ee=a=>{switch(a){case"home":return"Nhà riêng";case"work":return"Nơi làm việc";case"shipping":return"Địa chỉ giao hàng";case"others":return"Khác";default:return a}},Ge=async a=>{var m,k;const t=a.target.files[0];if(!t)return;const l=new FormData;l.append("avatar",t);try{const s=await x.post("/api/user/avatar",l,{headers:{"Content-Type":"multipart/form-data"}});s.data.data.user&&Object.assign(i.user,s.data.data.user),h.success("Avatar đã được cập nhật thành công")}catch(s){console.error("Upload error:",s),h.error(((k=(m=s.response)==null?void 0:m.data)==null?void 0:k.message)||"Có lỗi xảy ra khi tải lên avatar")}},R=()=>{ee.value=!1,L.value=!1,Fe()},Be=async()=>{var a,t;try{await x.post("/vouchers/assign-to-user",{user_id:i.user.id,...K});const l=await x.get(`/vouchers/user/${i.user.id}/vouchers`);i.user.vouchers=l.data.data,R(),h.success("Đã gán voucher thành công")}catch(l){h.error(((t=(a=l.response)==null?void 0:a.data)==null?void 0:t.message)||"Có lỗi xảy ra khi gán voucher")}},Le=async()=>{var a,t,l;try{if(!b.code||!b.discount_value)throw new Error("Vui lòng điền đầy đủ thông tin voucher");if(!((a=(await x.post("/vouchers",{...b,description:`Voucher created for user ${i.user.full_name}`})).data.data)!=null&&a.id))throw new Error("Không thể tạo voucher");const k=await x.get(`/vouchers/user/${i.user.id}/vouchers`);k.data.data&&(i.user.vouchers=k.data.data),L.value=!1,R(),h.success("Đã tạo và gán voucher thành công")}catch(m){console.error("Error creating/assigning voucher:",m),h.error(((l=(t=m.response)==null?void 0:t.data)==null?void 0:l.message)||m.message||"Có lỗi xảy ra khi tạo và gán voucher")}},Fe=()=>{Object.assign(b,{code:"",discount_type:"percentage",discount_value:0,min_order_value:0,max_discount_amount:0,usage_limit:1,start_date:new Date().toISOString().split("T")[0],end_date:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],is_unlimited:!1,uses_per_user:1,status:"active"}),K.total_uses=1},He=async a=>{var t,l;if(confirm("Bạn có chắc muốn trả lại voucher này?"))try{await x.post("/api/vouchers/return",{user_id:i.user.id,voucher_id:a});const m=await x.get(`/vouchers/user/${i.user.id}/vouchers`);i.user.vouchers=m.data.data,h.success("Đã trả lại voucher thành công")}catch(m){h.error(((l=(t=m.response)==null?void 0:t.data)==null?void 0:l.message)||"Có lỗi xảy ra khi trả lại voucher")}},Ie=async()=>{var a,t;try{const l=await x.get(`/vouchers/user/${i.user.id}/vouchers`);l.data.data&&(i.user.vouchers=l.data.data)}catch(l){console.error("Error fetching vouchers:",l),h.error(((t=(a=l.response)==null?void 0:a.data)==null?void 0:t.message)||"Không thể tải danh sách voucher")}},ze=async()=>{var a,t;try{const l=await x.get(`/api/users/${i.user.id}/service-packages`);l.data.data&&(i.user.userServicePackages=l.data.data)}catch(l){console.error("Error fetching service packages:",l),h.error(((t=(a=l.response)==null?void 0:a.data)==null?void 0:t.message)||"Không thể tải danh sách liệu trình")}};nt(()=>{var a;(a=i.user)!=null&&a.id&&(Ie(),ze(),rt()),console.log("user",i.user),console.log("userServicePackages",i.user.userServicePackages)}),S(!0),oe(te,a=>{console.log("availableVouchers changed:",a)});const Re=async()=>{var a,t;try{const l=await x.get("/vouchers");console.log("Available vouchers response:",l.data),l.data.success&&(te.value=l.data.data)}catch(l){console.error("Error loading vouchers:",l),h.error(((t=(a=l.response)==null?void 0:a.data)==null?void 0:t.message)||"Không thể tải danh sách voucher")}},Qe=async()=>{ee.value=!0,await Re()},Ye=a=>{switch(a){case"pending":return"Chờ xử lý";case"processing":return"Đang xử lý";case"completed":return"Hoàn thành";case"cancelled":return"Đã hủy";default:return a}},Xe=async a=>{var t,l;if(confirm("Bạn có chắc muốn hủy đơn hàng này?"))try{const m=await x.delete(`/api/orders/${a}/cancel`),k=await x.get(`/users/${i.user.id}`);Object.assign(i.user,k.data.data),h.success("Đã hủy đơn hàng thành công")}catch(m){h.error(((l=(t=m.response)==null?void 0:t.data)==null?void 0:l.message)||"Có lỗi xảy ra khi hủy đơn hàng")}},Q=N(()=>{var a;return(a=_.value)!=null&&a.userServicePackages?_.value.userServicePackages.filter(t=>t&&(t.status==="active"||t.status==="pending")).sort((t,l)=>t.status==="pending"&&l.status!=="pending"?-1:t.status!=="pending"&&l.status==="pending"?1:new Date(t.expiry_date)-new Date(l.expiry_date)):[]}),Je=N(()=>{var a;return((a=_.value.userServicePackages)==null?void 0:a.filter(t=>t.status==="completed"))||[]}),Ze=N(()=>Je.value.length),We=N(()=>Q.value.length);N(()=>{const a=Q.value.map(t=>t.next_appointment).filter(Boolean).sort((t,l)=>new Date(t.appointment_date)-new Date(l.appointment_date))[0];return a?z(a.appointment_date):null});const Pe=a=>{w.value=a,se.value=!0},xe=()=>{se.value=!1,w.value=null},et=async a=>{var t,l,m;try{const k=await x.post(`/api/vouchers/${a}/toggle-status`);if(k.data.success){const s=i.user.vouchers.findIndex(c=>c.id===a);s!==-1&&(i.user.vouchers[s]=k.data.data),((t=w.value)==null?void 0:t.id)===a&&(w.value=k.data.data),h.success(k.data.message)}}catch(k){h.error(((m=(l=k.response)==null?void 0:l.data)==null?void 0:m.message)||"Có lỗi xảy ra khi cập nhật trạng thái voucher")}},re=S(!1),U=H({staff_user_id:"",start_time:"",end_time:"",result:"",notes:""}),tt=async a=>{selectedPackage.value=a,re.value=!0,await at(),Object.assign(U,{staff_user_id:"",start_time:"",end_time:"",result:"",notes:""})},le=()=>{re.value=!1},st=async()=>{var a,t;try{const l=await x.post("/api/treatment-sessions",{...U,user_service_package_id:selectedPackage.value.id}),m=await x.get(`/users/${i.user.id}`);Object.assign(i.user,m.data.data),le(),h.success("Thêm lịch sử dịch vụ thành công")}catch(l){h.error(((t=(a=l.response)==null?void 0:a.data)==null?void 0:t.message)||"Có lỗi xảy ra khi thêm lịch sử dịch vụ")}},be=S([]),at=async()=>{try{const a=await x.get("/api/users/get-staff-list");be.value=a.data.data}catch(a){console.error("Error loading staff:",a),h.error("Không thể tải danh sách nhân viên")}},fe=a=>a?Ve(Te(a),"HH:mm - dd/MM/yyyy",{locale:Se}):"",ye=a=>a?Ve(Te(a),"dd/MM/yyyy",{locale:Se}):"";je({formatDateTime:fe,formatDate:ye,formatTime:a=>{if(!a)return"";const[t,l]=a.split(":");return`${t}:${l}`}}),oe(()=>v.is_default,a=>{a&&(v.is_temporary=!1)}),oe(()=>v.is_temporary,a=>{a&&(v.is_default=!1)});const rt=async()=>{try{const a=await x.get("/api/address/provinces");me.value=a.data.data}catch(a){console.error("Error loading provinces:",a)}},lt=a=>{a.editValue=i.user[a.key],M[a.key]=!0},ot=a=>{M[a.key]=!1,a.editValue=i.user[a.key]},dt=async a=>{var t,l;try{(await x.put("/api/user/profile",{[a.key]:a.editValue})).data.success&&(i.user[a.key]=a.editValue,M[a.key]=!1,h.success("Cập nhật thành công"))}catch(m){h.error(((l=(t=m.response)==null?void 0:t.data)==null?void 0:l.message)||"Có lỗi xảy ra khi cập nhật"),a.editValue=i.user[a.key]}};return(a,t)=>(o(),de(kt,null,{default:f(()=>[d(u(Ct),{title:"Chi tiết khách hàng"}),d(wt,{breadcrumbs:[{label:"Quản lý khách hàng",href:a.route("users.index")},{label:_.value.full_name}]},{default:f(()=>{var l,m,k;return[e("div",$t,[e("div",jt,[(o(),n(C,null,$(Ue,s=>e("button",{key:s.id,onClick:c=>G.value=s.id,class:E(["px-4 py-2 rounded-md transition-all duration-200",[G.value===s.id?"bg-blue-500 text-white shadow-md":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-800"]])},[e("div",Dt,[d(T,{path:s.icon,class:"w-5 h-5"},null,8,["path"]),e("span",null,r(s.label),1)])],10,Ut)),64))])]),G.value==="personal"?(o(),n("div",Mt,[d(X,{class:"!p-6 dark:bg-slate-900"},{default:f(()=>[e("div",At,[e("div",Nt,[e("div",Ot,[d(Tt,{fullName:_.value.full_name,avatarUrl:_.value.avatar_url,size:"2xl"},null,8,["fullName","avatarUrl"]),e("label",qt,[e("input",{type:"file",onChange:Ge,accept:"image/*",class:"hidden"},null,32),d(T,{path:u(ct),class:"w-5 h-5 text-white"},null,8,["path"])])]),e("div",Kt,[e("h2",Et,r(_.value.full_name),1),e("p",Gt,r(_.value.phone_number),1)])]),e("div",Bt,[e("div",Lt,[e("div",Ft,[d(T,{path:u(ie),class:"w-6 h-6 text-blue-600 dark:text-blue-400"},null,8,["path"]),t[26]||(t[26]=e("span",{class:"text-sm text-blue-600 dark:text-blue-400"},"Liệu trình",-1))]),e("p",Ht,r(We.value),1),t[27]||(t[27]=e("p",{class:"text-sm text-blue-600 dark:text-blue-400"},"Đang thực hiện",-1))]),e("div",It,[e("div",zt,[d(T,{path:u(mt),class:"w-6 h-6 text-green-600 dark:text-green-400"},null,8,["path"]),t[28]||(t[28]=e("span",{class:"text-sm text-green-600 dark:text-green-400"},"Hoàn thành",-1))]),e("p",Rt,r(Ze.value),1),t[29]||(t[29]=e("p",{class:"text-sm text-green-600 dark:text-green-400"},"Liệu trình",-1))]),e("div",Qt,[e("div",Yt,[d(T,{path:u(_e),class:"w-6 h-6 text-purple-600 dark:text-purple-400"},null,8,["path"]),t[30]||(t[30]=e("span",{class:"text-sm text-purple-600 dark:text-purple-400"},"Điểm",-1))]),e("p",Xt,r(_.value.point||0),1),t[31]||(t[31]=e("p",{class:"text-sm text-purple-600 dark:text-purple-400"},"Tích lũy",-1))]),e("div",Jt,[e("div",Zt,[d(T,{path:u(ue),class:"w-6 h-6 text-orange-600 dark:text-orange-400"},null,8,["path"]),t[32]||(t[32]=e("span",{class:"text-sm text-orange-600 dark:text-orange-400"},"Đơn hàng",-1))]),e("p",Wt,r(_.value.purchase_count||0),1),t[33]||(t[33]=e("p",{class:"text-sm text-orange-600 dark:text-orange-400"},"Tổng số",-1))])])])]),_:1}),e("div",Pt,[d(X,{class:"!p-6 dark:bg-slate-900"},{default:f(()=>[t[34]||(t[34]=e("div",{class:"flex justify-between items-center mb-4"},[e("h3",{class:"text-lg font-semibold dark:text-white"},"Thông tin cơ bản")],-1)),e("div",es,[(o(!0),n(C,null,$(Me.value,(s,c)=>(o(),n("div",{key:c,class:"flex items-center p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-800 transition-colors"},[e("div",ts,[e("p",ss,r(s.label),1),e("div",as,[s.isEditing?(o(),n(C,{key:0},[s.type==="select"?p((o(),n("select",{key:0,"onUpdate:modelValue":g=>s.editValue=g,class:"flex-1 rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500"},[(o(!0),n(C,null,$(s.options,g=>(o(),n("option",{key:g.value,value:g.value},r(g.label),9,ls))),128))],8,rs)),[[O,s.editValue]]):p((o(),n("input",{key:1,"onUpdate:modelValue":g=>s.editValue=g,type:s.type||"text",class:"flex-1 rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,8,os)),[[it,s.editValue]]),d(y,{color:"success",icon:u(gt),small:"",onClick:g=>dt(s)},null,8,["icon","onClick"]),d(y,{color:"danger",icon:u(pt),small:"",onClick:g=>ot(s)},null,8,["icon","onClick"])],64)):(o(),n(C,{key:1},[e("p",ds,r(s.value),1),d(y,{color:"info",icon:u(ke),small:"",onClick:g=>lt(s)},null,8,["icon","onClick"])],64))])])]))),128))])]),_:1}),d(X,{class:"!p-6 dark:bg-slate-900"},{default:f(()=>[t[36]||(t[36]=e("div",{class:"flex justify-between items-center mb-4"},[e("h3",{class:"text-lg font-semibold dark:text-white"},"Thông tin bổ sung")],-1)),e("div",ns,[(o(!0),n(C,null,$(Ae.value,(s,c)=>(o(),n("div",{key:c,class:"flex items-center p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-800 transition-colors"},[e("div",is,[e("p",us,r(s.label),1),e("p",cs,r(s.value),1)])]))),128)),e("div",ms,[t[35]||(t[35]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Ghi chú",-1)),e("p",gs,r(_.value.note||"Không có ghi chú"),1)])])]),_:1})]),d(X,{class:"!p-6 dark:bg-slate-900"},{default:f(()=>{var s;return[e("div",ps,[t[37]||(t[37]=e("h3",{class:"text-lg font-semibold dark:text-white"},"Địa chỉ",-1)),d(y,{label:"Thêm địa chỉ",color:"info",onClick:Ne,icon:u(we),small:""},null,8,["icon"])]),(s=_.value.addresses)!=null&&s.length?(o(),n("div",hs,[(o(!0),n(C,null,$(_.value.addresses,c=>(o(),n("div",{key:c.id,class:E(["p-4 rounded-lg border dark:border-slate-700 hover:shadow-md transition-shadow relative",{"border-blue-500 dark:border-blue-400 bg-blue-50 dark:bg-blue-900/30":c.is_default}])},[e("div",xs,[e("div",bs,[e("div",fs,[d(T,{path:c.address_type==="home"?u(ht):u(xt),class:"w-5 h-5 text-gray-500 dark:text-gray-400"},null,8,["path"]),e("div",null,[e("p",ys,r(c.address),1),e("p",vs,r(c.district)+", "+r(c.province),1)])]),e("div",_s,[c.is_default?(o(),n("span",ks," Mặc định ")):V("",!0),c.is_temporary?(o(),n("span",ws," Tạm thời ")):V("",!0),e("span",Cs,r(Ee(c.address_type)),1)])]),e("div",Vs,[d(y,{color:"info",icon:u(ke),small:"",onClick:g=>Oe(c)},null,8,["icon","onClick"]),d(y,{color:"danger",icon:u(bt),small:"",onClick:g=>Ke(c)},null,8,["icon","onClick"])])])],2))),128))])):(o(),n("div",Ts,[d(T,{path:u(ft),class:"w-12 h-12 mx-auto mb-3 opacity-50"},null,8,["path"]),t[38]||(t[38]=e("p",null,"Chưa có địa chỉ nào được thêm",-1))]))]}),_:1})])):V("",!0),G.value==="vouchers"?(o(),n("div",Ss,[e("div",$s,[t[39]||(t[39]=e("h3",{class:"text-lg font-medium"},"Danh sách voucher",-1)),d(y,{label:"Gán voucher",color:"info",onClick:Qe,icon:u(_e)},null,8,["icon"])]),(l=_.value.vouchers)!=null&&l.length?(o(!0),n(C,{key:1},$(_.value.vouchers,s=>(o(),n("div",{key:s.id,class:E(["bg-white dark:bg-slate-900 rounded-lg shadow-md p-6 mb-4 border-l-4",s.is_active?"border-green-500":"border-gray-300 dark:border-gray-600"])},[e("div",Us,[e("div",null,[e("h4",Ds,r(s.code),1),e("p",Ms,r(s.description||"Không có mô tả"),1)]),e("div",As,[e("p",Ns,r(s.formatted_discount),1),e("p",Os," Còn lại: "+r(s.remaining_uses)+" lần sử dụng ",1)])]),e("div",qs,[e("div",null,[e("p",Ks,[t[40]||(t[40]=D(" Đơn ti thiểu: ")),e("span",Es,r(s.min_order_value_formatted),1)]),e("p",Gs,[t[41]||(t[41]=D(" Giảm tối đa: ")),e("span",Bs,r(s.max_discount_amount_formatted),1)])]),e("div",Ls,[e("p",Fs,[t[42]||(t[42]=D(" Bắt đầu: ")),e("span",Hs,r(s.start_date_formatted),1)]),e("p",Is,[t[43]||(t[43]=D(" Kết thúc: ")),e("span",zs,r(s.end_date_formatted),1)])])]),e("div",Rs,[d(y,{label:"Chi tiết",color:"info",small:"",onClick:c=>Pe(s)},null,8,["onClick"]),s.remaining_uses>0?(o(),de(y,{key:0,label:"Trả lại voucher",color:"danger",small:"",onClick:c=>He(s.id)},null,8,["onClick"])):V("",!0)])],2))),128)):(o(),n("div",js," Chưa có voucher nào được gán ")),d(u(J),{appear:"",show:se.value,as:"template"},{default:f(()=>[d(u(Z),{as:"div",onClose:xe,class:"relative z-50"},{default:f(()=>[e("div",Qs,[e("div",Ys,[d(u(W),{class:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white dark:bg-slate-900 p-6 shadow-xl transition-all"},{default:f(()=>[d(u(P),{as:"h3",class:"text-lg font-medium leading-6 text-gray-900 dark:text-white mb-4"},{default:f(()=>t[44]||(t[44]=[D(" Chi tiết Voucher ")])),_:1}),w.value?(o(),n("div",Xs,[e("div",Js,[e("div",null,[e("h4",Zs,r(w.value.code),1),e("p",Ws,r(w.value.description||"Không có mô tả"),1)]),e("div",{class:E({"px-2 py-1 text-xs font-medium rounded-full":!0,"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":w.value.status==="active","bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":w.value.status==="inactive"})},r(w.value.status==="active"?"Đang kích hoạt":"Đã vô hiệu"),3)]),e("div",Ps,[e("div",null,[t[45]||(t[45]=e("p",{class:"text-gray-600 dark:text-gray-400"},"Loại giảm giá",-1)),e("p",ea,r(w.value.discount_type==="percentage"?"Phần trăm":"Số tiền cố định"),1)]),e("div",null,[t[46]||(t[46]=e("p",{class:"text-gray-600 dark:text-gray-400"},"Giá trị giảm",-1)),e("p",ta,r(w.value.formatted_discount),1)]),e("div",null,[t[47]||(t[47]=e("p",{class:"text-gray-600 dark:text-gray-400"},"Đơn tối thiểu",-1)),e("p",sa,r(w.value.min_order_value_formatted),1)]),e("div",null,[t[48]||(t[48]=e("p",{class:"text-gray-600 dark:text-gray-400"},"Giảm tối đa",-1)),e("p",aa,r(w.value.max_discount_amount_formatted),1)]),e("div",null,[t[49]||(t[49]=e("p",{class:"text-gray-600 dark:text-gray-400"},"Ngày bắt đầu",-1)),e("p",ra,r(w.value.start_date_formatted),1)]),e("div",null,[t[50]||(t[50]=e("p",{class:"text-gray-600 dark:text-gray-400"},"Ngày kết thúc",-1)),e("p",la,r(w.value.end_date_formatted),1)])]),e("div",oa,[e("div",da,[d(y,{type:"button",label:w.value.status==="active"?"Vô hiệu hóa":"Kích hoạt",color:w.value.status==="active"?"danger":"success",onClick:t[0]||(t[0]=s=>et(w.value.id))},null,8,["label","color"]),d(y,{type:"button",label:"Đóng",color:"white",onClick:xe})])])])):V("",!0)]),_:1})])])]),_:1})]),_:1},8,["show"])])):V("",!0),G.value==="invoices"?(o(),n("div",na,[t[56]||(t[56]=e("div",{class:"bg-white dark:bg-slate-900 rounded-lg shadow-md p-4"},[e("h3",{class:"text-lg font-medium dark:text-white"},"Lịch sử đơn hàng")],-1)),(m=_.value.orders)!=null&&m.length?(o(),n("div",ia,[(o(!0),n(C,null,$(_.value.orders,s=>(o(),n("div",{key:s.id,class:"bg-white dark:bg-slate-900 rounded-lg shadow-md overflow-hidden"},[e("div",ua,[e("div",null,[e("p",ca," Mã đơn hàng: #"+r(s.id),1),e("p",ma,r(z(s.created_at)),1)]),e("div",ga,[e("span",{class:E({"px-2 py-1 text-xs font-medium rounded-full":!0,"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":s.status==="pending","bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":s.status==="processing","bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":s.status==="completed","bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":s.status==="cancelled"})},r(Ye(s.status)),3)])]),e("div",pa,[(o(!0),n(C,null,$(s.order_items,c=>{var g,A,F,ve;return o(),n("div",{key:c.id,class:"flex justify-between items-center py-2"},[e("div",ha,[e("div",xa,[(g=c.product)!=null&&g.image_url?(o(),n("img",{key:0,src:c.product.image_url,alt:(A=c.product)==null?void 0:A.name,class:"w-12 h-12 object-cover rounded-md"},null,8,ba)):(o(),n("div",fa,[d(T,{path:u(ie),class:"w-6 h-6 text-gray-400 dark:text-gray-500"},null,8,["path"])]))]),e("div",null,[e("p",ya,r(((F=c.product)==null?void 0:F.name)||((ve=c.service)==null?void 0:ve.service_name)||"Sản phẩm đã xóa"),1),e("p",va,r(B(c.price))+" x "+r(c.quantity),1)])]),e("p",_a,r(B(c.price*c.quantity)),1)])}),128))]),e("div",ka,[e("div",wa,[t[51]||(t[51]=e("span",{class:"text-gray-600 dark:text-gray-400"},"Tạm tính",-1)),e("span",Ca,r(B(s.total_amount)),1)]),e("div",Va,[t[52]||(t[52]=e("span",{class:"text-gray-600 dark:text-gray-400"},"Giảm giá",-1)),e("span",Ta," -"+r(B(s.discount_amount)),1)]),e("div",Sa,[t[53]||(t[53]=e("span",{class:"dark:text-white"},"Tổng cộng",-1)),e("span",$a,r(B(s.total_amount-s.discount_amount)),1)])]),s.status==="pending"?(o(),n("div",ja,[d(y,{label:"Hủy đơn",color:"danger",onClick:c=>Xe(s.id),loading:s.loading},null,8,["onClick","loading"])])):V("",!0)]))),128))])):(o(),n("div",Ua,[d(T,{path:u(ue),class:"w-16 h-16 mx-auto text-gray-400 dark:text-gray-500"},null,8,["path"]),t[54]||(t[54]=e("h3",{class:"mt-4 text-lg font-medium dark:text-white"}," Chưa có đơn hàng nào ",-1)),t[55]||(t[55]=e("p",{class:"mt-2 text-gray-600 dark:text-gray-400"}," Khách hàng chưa thc hiện đơn hàng nào. ",-1))]))])):V("",!0),d(u(J),{appear:"",show:I.value,as:"template"},{default:f(()=>[d(u(Z),{as:"div",onClose:ae,class:"relative z-50"},{default:f(()=>[e("div",Da,[e("div",Ma,[d(u(W),{class:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white dark:bg-slate-900 p-6 shadow-xl transition-all"},{default:f(()=>[d(u(P),{as:"h3",class:"text-lg font-medium leading-6 text-gray-900 dark:text-white mb-4"},{default:f(()=>[D(r(q.value?"Sửa địa chỉ":"Thêm địa chỉ mới"),1)]),_:1}),e("form",{onSubmit:Y(qe,["prevent"]),class:"space-y-4"},[e("div",Aa,[e("div",null,[t[58]||(t[58]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Tỉnh/Thành phố * ",-1)),p(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>v.province=s),required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},[t[57]||(t[57]=e("option",{value:""},"-- Chọn tỉnh/thành phố --",-1)),(o(!0),n(C,null,$(me.value,s=>(o(),n("option",{key:s.code,value:s.code},r(s.name),9,Na))),128))],512),[[O,v.province]])]),e("div",null,[t[60]||(t[60]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Quận/Huyện * ",-1)),p(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>v.district=s),required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},[t[59]||(t[59]=e("option",{value:""},"-- Chọn quận/huyện --",-1)),(o(!0),n(C,null,$(ge.value,s=>(o(),n("option",{key:s.code,value:s.code},r(s.name),9,Oa))),128))],512),[[O,v.district]])]),e("div",null,[t[62]||(t[62]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Phường/Xã * ",-1)),p(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>v.ward=s),required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},[t[61]||(t[61]=e("option",{value:""},"-- Chọn phường/xã --",-1)),(o(!0),n(C,null,$(pe.value,s=>(o(),n("option",{key:s.code,value:s.code},r(s.name),9,qa))),128))],512),[[O,v.ward]])]),e("div",null,[t[63]||(t[63]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Đa chỉ chi tiết * ",-1)),p(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>v.address=s),type:"text",required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500",placeholder:"Số nhà, tên đường, phường/xã"},null,512),[[j,v.address]])]),e("div",null,[t[65]||(t[65]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Loại địa chỉ ",-1)),p(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>v.address_type=s),class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},t[64]||(t[64]=[e("option",{value:"home"},"Nhà riêng",-1),e("option",{value:"work"},"Nơi làm việc",-1),e("option",{value:"shipping"},"Địa chỉ giao hàng",-1),e("option",{value:"others"},"Khác",-1)]),512),[[O,v.address_type]])]),e("div",Ka,[e("div",Ea,[p(e("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=s=>v.is_default=s),id:"is_default",class:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500"},null,512),[[ne,v.is_default]]),t[66]||(t[66]=e("label",{for:"is_default",class:"ml-2 text-sm text-gray-700 dark:text-gray-300"}," Đặt làm địa chỉ mặc định ",-1))]),e("div",Ga,[p(e("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=s=>v.is_temporary=s),id:"is_temporary",class:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500"},null,512),[[ne,v.is_temporary]]),t[67]||(t[67]=e("label",{for:"is_temporary",class:"ml-2 text-sm text-gray-700 dark:text-gray-300"}," Địa chỉ tạm thời ",-1))])])]),e("div",Ba,[d(y,{type:"button",label:"Hủy",color:"white",onClick:ae}),d(y,{type:"submit",label:q.value?"Cập nhật":"Thêm mới",color:"info"},null,8,["label"])])],32)]),_:1})])])]),_:1})]),_:1},8,["show"]),d(u(J),{appear:"",show:ee.value,as:"template"},{default:f(()=>[d(u(Z),{as:"div",onClose:R,class:"relative z-50"},{default:f(()=>[e("div",La,[e("div",Fa,[d(u(W),{class:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white dark:bg-slate-900 p-6 shadow-xl transition-all"},{default:f(()=>[d(u(P),{as:"h3",class:"text-lg font-medium leading-6 text-gray-900 dark:text-white mb-4"},{default:f(()=>t[68]||(t[68]=[D(" Gán voucher cho khách hàng ")])),_:1}),L.value?(o(),n("div",Qa,[e("form",{onSubmit:Y(Le,["prevent"]),class:"space-y-4"},[e("div",null,[t[72]||(t[72]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Mã voucher * ",-1)),p(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>b.code=s),type:"text",required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[j,b.code]])]),e("div",null,[t[74]||(t[74]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Loại giảm giá * ",-1)),p(e("select",{"onUpdate:modelValue":t[12]||(t[12]=s=>b.discount_type=s),required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},t[73]||(t[73]=[e("option",{value:"percentage"},"Phần trăm",-1),e("option",{value:"fixed"},"Số tiền cố định",-1)]),512),[[O,b.discount_type]])]),e("div",null,[t[75]||(t[75]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Giá trị giảm * ",-1)),p(e("input",{"onUpdate:modelValue":t[13]||(t[13]=s=>b.discount_value=s),type:"number",required:"",min:"0",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[j,b.discount_value,void 0,{number:!0}]])]),e("div",null,[t[76]||(t[76]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Giá trị đơn hàng tối thiểu ",-1)),p(e("input",{"onUpdate:modelValue":t[14]||(t[14]=s=>b.min_order_value=s),type:"number",min:"0",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[j,b.min_order_value,void 0,{number:!0}]])]),e("div",null,[t[77]||(t[77]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Giảm giá tối đa ",-1)),p(e("input",{"onUpdate:modelValue":t[15]||(t[15]=s=>b.max_discount_amount=s),type:"number",min:"0",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[j,b.max_discount_amount,void 0,{number:!0}]])]),e("div",Ya,[e("div",null,[t[78]||(t[78]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Ngày bắt đầu * ",-1)),p(e("input",{"onUpdate:modelValue":t[16]||(t[16]=s=>b.start_date=s),type:"date",required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[j,b.start_date]])]),e("div",null,[t[79]||(t[79]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Ngày kết thúc * ",-1)),p(e("input",{"onUpdate:modelValue":t[17]||(t[17]=s=>b.end_date=s),type:"date",required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[j,b.end_date]])])]),e("div",Xa,[e("div",Ja,[p(e("input",{type:"checkbox","onUpdate:modelValue":t[18]||(t[18]=s=>b.is_unlimited=s),id:"is_unlimited",class:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500"},null,512),[[ne,b.is_unlimited]]),t[80]||(t[80]=e("label",{for:"is_unlimited",class:"ml-2 text-sm text-gray-700 dark:text-gray-300"}," Không giới hạn số lần sử dụng ",-1))])]),e("div",null,[t[81]||(t[81]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Số lần s dụng cho mỗi người dùng * ",-1)),p(e("input",{"onUpdate:modelValue":t[19]||(t[19]=s=>b.uses_per_user=s),type:"number",required:"",min:"1",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[j,b.uses_per_user,void 0,{number:!0}]])]),e("div",Za,[d(y,{type:"button",label:"Quay lại",color:"white",onClick:t[20]||(t[20]=s=>L.value=!1)}),d(y,{type:"submit",label:"Tạo và gán",color:"success"})])],32)])):(o(),n("div",Ha,[e("form",{onSubmit:Y(Be,["prevent"]),class:"space-y-4"},[e("div",null,[t[70]||(t[70]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Chọn Voucher có sẵn ",-1)),p(e("select",{"onUpdate:modelValue":t[8]||(t[8]=s=>K.voucher_id=s),class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},[t[69]||(t[69]=e("option",{value:""},"-- Chọn voucher --",-1)),(o(!0),n(C,null,$(te.value,s=>(o(),n("option",{key:s.id,value:s.id},r(s.code)+" - "+r(s.discount_type==="percentage"?`${s.discount_value}%`:B(s.discount_value)),9,Ia))),128))],512),[[O,K.voucher_id]])]),e("div",null,[t[71]||(t[71]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Số lần sử dụng ",-1)),p(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>K.total_uses=s),type:"number",min:"1",required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[j,K.total_uses,void 0,{number:!0}]])]),e("div",za,[d(y,{type:"button",label:"Tạo voucher mới",color:"success",onClick:t[10]||(t[10]=s=>L.value=!0)}),e("div",Ra,[d(y,{type:"button",label:"Hủy",color:"white",onClick:R}),d(y,{type:"submit",label:"Xác nhận",color:"info",disabled:!K.voucher_id},null,8,["disabled"])])])],32)]))]),_:1})])])]),_:1})]),_:1},8,["show"]),G.value==="service_combos"?(o(),n("div",Wa,[e("div",Pa,[t[90]||(t[90]=e("div",{class:"p-4 border-b dark:border-slate-700"},[e("h3",{class:"text-lg font-medium dark:text-white"},"Liệu trình đang thực hiện")],-1)),(k=Q.value)!=null&&k.length?(o(),n("div",er,[(o(!0),n(C,null,$(Q.value,s=>{var c;return o(),n("div",{key:s.id},[e("div",tr,[e("div",null,[e("div",sr,[e("h4",ar,r(s.service_name),1),e("span",{class:E({"px-2 py-0.5 text-xs font-medium rounded-full":!0,[`bg-${s.package_type.color}-100 text-${s.package_type.color}-800`]:!0,[`dark:bg-${s.package_type.color}-900 dark:text-${s.package_type.color}-200`]:!0})},r(s.package_type.name),3)]),e("p",rr," Hết hạn: "+r(s.formatted_expiry_date||"Không giới hạn"),1)]),s.remaining_sessions>0?(o(),de(y,{key:0,color:"info",label:"Thêm buổi dịch vụ",icon:u(we),onClick:g=>tt(s)},null,8,["icon","onClick"])):V("",!0)]),e("div",lr,[e("div",{class:E(["bg-blue-600 h-2.5 rounded-full",{"bg-green-600":s.progress_percentage>=100}]),style:ut({width:`${s.progress_percentage}%`})},null,6)]),e("div",or,[e("div",null,[t[82]||(t[82]=e("p",{class:"text-gray-600 dark:text-gray-400"},"Tổng số buổi",-1)),e("p",dr,r(s.total_sessions),1)]),e("div",null,[t[83]||(t[83]=e("p",{class:"text-gray-600 dark:text-gray-400"},"Đã sử dụng",-1)),e("p",nr,r(s.used_sessions),1)]),e("div",null,[t[84]||(t[84]=e("p",{class:"text-gray-600 dark:text-gray-400"},"Còn lại",-1)),e("p",ir,r(s.remaining_sessions),1)])]),s.next_session_date?(o(),n("div",ur,[e("div",cr,[d(T,{path:u(Ce),class:"w-5 h-5 text-blue-600 dark:text-blue-400"},null,8,["path"]),e("div",null,[t[85]||(t[85]=e("p",{class:"text-sm font-medium text-blue-900 dark:text-blue-200"}," Buổi dịch vụ tiếp theo ",-1)),e("p",mr,r(s.next_session_date),1)])])])):V("",!0),s.next_appointment_details?(o(),n("div",gr,[e("div",pr,[d(T,{path:u(Ce),class:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5"},null,8,["path"]),e("div",hr,[t[86]||(t[86]=e("p",{class:"text-sm font-medium text-blue-900 dark:text-blue-200"}," Lịch hẹn sắp tới ",-1)),e("div",xr,[e("p",br,r(s.next_appointment_details.date),1),e("div",fr,[d(T,{path:u(yt),class:"w-4 h-4 mr-1"},null,8,["path"]),D(" "+r(s.next_appointment_details.time.start)+" - "+r(s.next_appointment_details.time.end),1)]),s.next_appointment_details.staff?(o(),n("div",yr,[d(T,{path:u(ce),class:"w-4 h-4 mr-1"},null,8,["path"]),D(" Thực hiện bởi: "+r(s.next_appointment_details.staff.full_name),1)])):V("",!0)])])])])):V("",!0),(c=s.treatment_sessions)!=null&&c.length?(o(),n("div",vr,[e("div",_r,[t[89]||(t[89]=e("h5",{class:"font-medium text-gray-900 dark:text-white mb-3"}," Lịch sử dịch vụ ",-1)),e("div",kr,[(o(!0),n(C,null,$(s.treatment_sessions,g=>{var A;return o(),n("div",{key:g.id,class:"p-3 bg-gray-50 dark:bg-slate-800 rounded-lg"},[e("div",wr,[e("div",null,[e("div",Cr," Buổi #"+r(s.total_sessions-s.treatment_sessions.indexOf(g)),1),e("div",Vr,[e("div",Tr,[d(T,{path:u(vt),class:"w-4 h-4"},null,8,["path"]),e("span",null,r(fe(g.start_time)),1)]),e("div",Sr,[d(T,{path:u(ce),class:"w-4 h-4"},null,8,["path"]),e("span",null,"Thực hiện: "+r(((A=g.staff)==null?void 0:A.full_name)||"N/A"),1)])])]),g.result?(o(),n("div",$r,[t[87]||(t[87]=e("span",{class:"font-medium"},"Kết quả:",-1)),D(" "+r(g.result),1)])):V("",!0)]),g.notes?(o(),n("div",jr,[t[88]||(t[88]=e("span",{class:"font-medium"},"Ghi chú:",-1)),D(" "+r(g.notes),1)])):V("",!0)])}),128))])])])):V("",!0)])}),128))])):(o(),n("div",Ur," Chưa có liệu trình nào đang thực hiện "))])])):V("",!0),d(u(J),{appear:"",show:re.value,as:"template"},{default:f(()=>[d(u(Z),{as:"div",onClose:le,class:"relative z-50"},{default:f(()=>[t[98]||(t[98]=e("div",{class:"fixed inset-0 bg-black/30"},null,-1)),e("div",Dr,[e("div",Mr,[d(u(W),{class:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white dark:bg-slate-900 p-6 shadow-xl transition-all"},{default:f(()=>[d(u(P),{as:"h3",class:"text-lg font-medium leading-6 text-gray-900 dark:text-white mb-4"},{default:f(()=>t[91]||(t[91]=[D(" Thêm buổi dịch vụ mới ")])),_:1}),e("form",{onSubmit:Y(st,["prevent"]),class:"space-y-4"},[e("div",null,[t[93]||(t[93]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Nhân viên thực hiện * ",-1)),p(e("select",{"onUpdate:modelValue":t[21]||(t[21]=s=>U.staff_user_id=s),required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},[t[92]||(t[92]=e("option",{value:""},"-- Chọn nhân viên --",-1)),(o(!0),n(C,null,$(be.value,s=>(o(),n("option",{key:s.id,value:s.id},r(s.full_name),9,Ar))),128))],512),[[O,U.staff_user_id]])]),e("div",null,[t[94]||(t[94]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Thời gian bắt đầu * ",-1)),p(e("input",{"onUpdate:modelValue":t[22]||(t[22]=s=>U.start_time=s),type:"datetime-local",required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[j,U.start_time]])]),e("div",null,[t[95]||(t[95]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Thời gian kết thúc * ",-1)),p(e("input",{"onUpdate:modelValue":t[23]||(t[23]=s=>U.end_time=s),type:"datetime-local",required:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[j,U.end_time]])]),e("div",null,[t[96]||(t[96]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Kết quả ",-1)),p(e("textarea",{"onUpdate:modelValue":t[24]||(t[24]=s=>U.result=s),rows:"2",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[j,U.result]])]),e("div",null,[t[97]||(t[97]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Ghi chú ",-1)),p(e("textarea",{"onUpdate:modelValue":t[25]||(t[25]=s=>U.notes=s),rows:"3",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-slate-800 dark:text-white focus:border-blue-500 focus:ring-blue-500"},null,512),[[j,U.notes]])]),e("div",Nr,[d(y,{type:"button",label:"Hủy",color:"white",onClick:le}),d(y,{type:"submit",label:"Thêm",color:"info"})])],32)]),_:1})])])]),_:1})]),_:1},8,["show"])]}),_:1},8,["breadcrumbs"])]),_:1}))}},jl=St(Or,[["__scopeId","data-v-f2703799"]]);export{jl as default};
